<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="REFIT BUSINESS SYSTEM">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2d1517">
    
    <title>REFIT - Complete Mobile Business System with Maiya AI</title>
    
    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* Base Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        /* 8 Beautiful Pastel Themes */
        [data-theme="red"] {
            --bg-primary: #2d1517;
            --bg-secondary: #3d1f22;
            --bg-card: #4a262a;
            --bg-card-hover: #5a2f33;
            --text-primary: #fef7f7;
            --text-secondary: #fed7d7;
            --text-muted: #fca5a5;
            --accent-primary: #f87171;
            --accent-secondary: #fca5a5;
            --accent-warm: #fb923c;
            --border-color: #5a2f33;
            --shadow-light: rgba(248, 113, 113, 0.1);
            --shadow-medium: rgba(248, 113, 113, 0.2);
            --shadow-strong: rgba(248, 113, 113, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #dc2626;
            --info: #3b82f6;
            --theme-name: "Coral Sunset";
            --theme-icon: "üåÖ";
        }

        [data-theme="orange"] {
            --bg-primary: #2d1b0f;
            --bg-secondary: #3d261a;
            --bg-card: #4a3025;
            --bg-card-hover: #5a3a30;
            --text-primary: #fff7ed;
            --text-secondary: #fed7aa;
            --text-muted: #fdba74;
            --accent-primary: #fb923c;
            --accent-secondary: #fdba74;
            --accent-warm: #fbbf24;
            --border-color: #5a3a30;
            --shadow-light: rgba(251, 146, 60, 0.1);
            --shadow-medium: rgba(251, 146, 60, 0.2);
            --shadow-strong: rgba(251, 146, 60, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Peach Glow";
            --theme-icon: "üçë";
        }

        [data-theme="pink"] {
            --bg-primary: #2d1524;
            --bg-secondary: #3d1f2e;
            --bg-card: #4a2638;
            --bg-card-hover: #5a2f42;
            --text-primary: #fdf2f8;
            --text-secondary: #fce7f3;
            --text-muted: #f9a8d4;
            --accent-primary: #f472b6;
            --accent-secondary: #f9a8d4;
            --accent-warm: #fbbf24;
            --border-color: #5a2f42;
            --shadow-light: rgba(244, 114, 182, 0.1);
            --shadow-medium: rgba(244, 114, 182, 0.2);
            --shadow-strong: rgba(244, 114, 182, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Rose Blush";
            --theme-icon: "üå∏";
        }

        [data-theme="yellow"] {
            --bg-primary: #2d2510;
            --bg-secondary: #3d331a;
            --bg-card: #4a4025;
            --bg-card-hover: #5a4d30;
            --text-primary: #fefce8;
            --text-secondary: #fef3c7;
            --text-muted: #fcd34d;
            --accent-primary: #fbbf24;
            --accent-secondary: #fcd34d;
            --accent-warm: #f59e0b;
            --border-color: #5a4d30;
            --shadow-light: rgba(251, 191, 36, 0.1);
            --shadow-medium: rgba(251, 191, 36, 0.2);
            --shadow-strong: rgba(251, 191, 36, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Butter Cream";
            --theme-icon: "üåª";
        }

        [data-theme="bluegreen"] {
            --bg-primary: #0f2925;
            --bg-secondary: #1a3530;
            --bg-card: #25423b;
            --bg-card-hover: #304f46;
            --text-primary: #f0fdfa;
            --text-secondary: #ccfbf1;
            --text-muted: #7dd3fc;
            --accent-primary: #2dd4bf;
            --accent-secondary: #7dd3fc;
            --accent-warm: #fbbf24;
            --border-color: #304f46;
            --shadow-light: rgba(45, 212, 191, 0.1);
            --shadow-medium: rgba(45, 212, 191, 0.2);
            --shadow-strong: rgba(45, 212, 191, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Mint Breeze";
            --theme-icon: "üåä";
        }

        [data-theme="purplegrey"] {
            --bg-primary: #241838;
            --bg-secondary: #2e2042;
            --bg-card: #38284c;
            --bg-card-hover: #423056;
            --text-primary: #faf7ff;
            --text-secondary: #f3e8ff;
            --text-muted: #c4b5fd;
            --accent-primary: #a855f7;
            --accent-secondary: #c4b5fd;
            --accent-warm: #fbbf24;
            --border-color: #423056;
            --shadow-light: rgba(168, 85, 247, 0.1);
            --shadow-medium: rgba(168, 85, 247, 0.2);
            --shadow-strong: rgba(168, 85, 247, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Lavender Mist";
            --theme-icon: "üíú";
        }

        [data-theme="browngrey"] {
            --bg-primary: #1c1917;
            --bg-secondary: #292524;
            --bg-card: #3f3f46;
            --bg-card-hover: #52525b;
            --text-primary: #fafaf9;
            --text-secondary: #e7e5e4;
            --text-muted: #d6d3d1;
            --accent-primary: #a3a3a3;
            --accent-secondary: #d6d3d1;
            --accent-warm: #f59e0b;
            --border-color: #52525b;
            --shadow-light: rgba(163, 163, 163, 0.1);
            --shadow-medium: rgba(163, 163, 163, 0.2);
            --shadow-strong: rgba(163, 163, 163, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Warm Taupe";
            --theme-icon: "ü§é";
        }

        [data-theme="greenbrown"] {
            --bg-primary: #1a2e05;
            --bg-secondary: #253a0a;
            --bg-card: #30460f;
            --bg-card-hover: #3b5314;
            --text-primary: #f7f8f3;
            --text-secondary: #e8f5e8;
            --text-muted: #bef264;
            --accent-primary: #84cc16;
            --accent-secondary: #bef264;
            --accent-warm: #f59e0b;
            --border-color: #3b5314;
            --shadow-light: rgba(132, 204, 22, 0.1);
            --shadow-medium: rgba(132, 204, 22, 0.2);
            --shadow-strong: rgba(132, 204, 22, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Sage Olive";
            --theme-icon: "üåø";
        }

        /* Base Styles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            font-size: 16px;
            line-height: 1.6;
            transition: all 0.5s ease;
        }
        
        /* Mobile Layout Container */
        .mobile-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--bg-primary);
            transition: all 0.5s ease;
        }
        
        /* Status Bar */
        .status-bar {
            height: 44px;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: 0 2px 10px var(--shadow-medium);
            border-bottom: 1px solid var(--border-color);
            transition: all 0.5s ease;
        }
        
        .theme-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .theme-toggle {
            background: var(--accent-primary);
            border: none;
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .theme-toggle:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
        }
        
        .theme-picker-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .theme-picker-btn:hover {
            transform: scale(1.05);
        }
        
        /* Header */
        .header {
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 44px;
            left: 0;
            right: 0;
            z-index: 90;
            box-shadow: 0 4px 20px var(--shadow-medium);
            transition: all 0.5s ease;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .app-logo {
            width: 54px;
            height: 54px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 25px var(--shadow-medium);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .app-logo:hover {
            transform: scale(1.05);
        }
        
        .app-title h1 {
            font-size: 18px;
            font-weight: 700;
            line-height: 1.1;
            letter-spacing: -0.5px;
            margin-bottom: 2px;
            color: var(--text-primary);
            transition: all 0.5s ease;
        }
        
        .app-title p {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: all 0.5s ease;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            box-shadow: 0 4px 15px var(--shadow-medium);
        }
        
        .header-btn:hover {
            transform: translateY(-2px);
        }

        /* Maiya AI Button - Special styling */
        .maiya-btn {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            position: relative;
            overflow: hidden;
        }

        .maiya-btn.listening {
            animation: pulse 1.5s infinite;
        }

        .maiya-btn.processing {
            animation: processing 1s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(139, 92, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); }
        }

        @keyframes processing {
            0% { background: linear-gradient(135deg, #8b5cf6, #a78bfa); }
            50% { background: linear-gradient(135deg, #a78bfa, #c4b5fd); }
            100% { background: linear-gradient(135deg, #8b5cf6, #a78bfa); }
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 130px 20px 140px;
            -webkit-overflow-scrolling: touch;
            position: relative;
            height: calc(100vh - 44px);
            scroll-behavior: smooth;
            transition: all 0.5s ease;
        }
        
        .main-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 3px;
        }
        
        /* Cards */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
            transition: all 0.5s ease;
        }
        
        .card:hover {
            box-shadow: 0 12px 40px var(--shadow-medium);
            transform: translateY(-2px);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--shadow-light);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Validation Styles */
        .form-input.error, .form-textarea.error, .form-select.error {
            border-color: var(--error);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .form-input.success, .form-textarea.success, .form-select.success {
            border-color: var(--success);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .error-message {
            color: var(--error);
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 300;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(10px);
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            transition: all 0.5s ease;
        }
        
        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            border-radius: 24px 24px 0 0;
        }
        
        .modal-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-close-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: var(--bg-card);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }
        
        .modal-close-btn:hover {
            background: var(--error);
            color: white;
            transform: scale(1.1);
        }
        
        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Maiya AI Chat Interface */
        .maiya-chat {
            position: fixed;
            bottom: 160px;
            right: 20px;
            width: 350px;
            max-width: calc(100vw - 40px);
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            display: none;
            flex-direction: column;
            max-height: 500px;
            z-index: 200;
        }

        .maiya-chat.show {
            display: flex;
        }

        .maiya-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            border-radius: 20px 20px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .maiya-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-right: 12px;
        }

        .maiya-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .maiya-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        .maiya-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            min-height: 200px;
            max-height: 300px;
        }

        .maiya-message {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .maiya-message.user {
            background: var(--accent-primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .maiya-message.ai {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }

        .maiya-input-area {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .maiya-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            resize: none;
            min-height: 40px;
            max-height: 100px;
            font-family: inherit;
        }

        .maiya-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .maiya-voice-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--success);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 8px;
        }

        .maiya-voice-btn.listening {
            animation: pulse 1s infinite;
            background: var(--error);
        }

        /* Document Generator Modal */
        .doc-gen-modal .modal-content {
            max-width: 800px;
        }

        .doc-template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .doc-template {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .doc-template:hover {
            border-color: var(--accent-primary);
            transform: translateY(-4px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }

        .doc-template.selected {
            border-color: var(--accent-primary);
            background: var(--shadow-light);
        }

        .doc-template-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .doc-template-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .doc-template-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Presentation Generator */
        .presentation-slide {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            border: 1px solid var(--border-color);
        }

        .slide-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .slide-number {
            background: var(--accent-primary);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
        }

        .slide-content {
            background: var(--bg-card);
            padding: 16px;
            border-radius: 8px;
            min-height: 100px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px 24px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 52px;
            text-decoration: none;
            box-shadow: 0 4px 12px var(--shadow-light);
            position: relative;
            overflow: hidden;
            user-select: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        
        .btn:active {
            transform: scale(0.96);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); }
        .btn-success { background: linear-gradient(135deg, var(--success), #34d399); }
        .btn-secondary { background: linear-gradient(135deg, var(--text-secondary), #9ca3af); }
        .btn-warning { background: linear-gradient(135deg, var(--warning), #fbbf24); }
        .btn-danger { background: linear-gradient(135deg, var(--error), #f87171); }
        .btn-info { background: linear-gradient(135deg, var(--info), #60a5fa); }
        
        /* Edit Button Styles */
        .edit-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            min-height: auto;
        }

        .edit-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        .edit-btn.small {
            padding: 4px 8px;
            font-size: 11px;
        }

        .edit-btn.large {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* Action Button Groups */
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .action-buttons.center {
            justify-content: center;
        }

        .action-buttons.end {
            justify-content: flex-end;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px 0;
        }
        
        .quick-btn {
            padding: 16px 12px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 80px;
            box-shadow: 0 4px 12px var(--shadow-light);
            position: relative;
            overflow: hidden;
        }
        
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        
        .quick-btn.primary { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); }
        .quick-btn.success { background: linear-gradient(135deg, var(--success), #34d399); }
        .quick-btn.info { background: linear-gradient(135deg, var(--info), #60a5fa); }
        .quick-btn.warning { background: linear-gradient(135deg, var(--warning), #fbbf24); }
        .quick-btn.danger { background: linear-gradient(135deg, var(--error), #f87171); }
        
        .quick-btn .icon {
            font-size: 24px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .quick-btn .label {
            font-size: 12px;
            text-align: center;
            line-height: 1.2;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 18px;
            padding: 20px 16px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 16px var(--shadow-light);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            line-height: 1;
            color: var(--accent-primary);
            position: relative;
            z-index: 2;
        }

        /* Data List */
        .data-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .data-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 16px;
            transition: all 0.3s ease;
            position: relative;
        }

        .data-item:hover {
            box-shadow: 0 4px 16px var(--shadow-light);
            transform: translateY(-1px);
        }

        .data-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .data-item-title {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 16px;
            flex: 1;
        }

        .data-item-amount {
            font-weight: 800;
            color: var(--accent-primary);
            font-size: 18px;
            margin-left: 12px;
        }

        .data-item-details {
            color: var(--text-muted);
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .data-item-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .data-item-date {
            font-size: 12px;
            color: var(--text-muted);
        }

        .data-item-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-draft { background: #f3f4f6; color: #374151; }
        .status-sent { background: #dbeafe; color: #1d4ed8; }
        .status-paid { background: #d1fae5; color: #059669; }
        .status-overdue { background: #fee2e2; color: #dc2626; }
        .status-active { background: #d1fae5; color: #059669; }

        /* Enhanced Action Buttons */
        .data-item-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-color);
            padding: 12px 20px 32px;
            z-index: 100;
            box-shadow: 0 -4px 20px var(--shadow-medium);
            transition: all 0.5s ease;
        }
        
        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            border-radius: 16px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 60px;
        }
        
        .nav-item.active {
            color: var(--accent-primary);
            background: var(--shadow-light);
            box-shadow: 0 2px 8px var(--shadow-light);
            transform: scale(1.05);
        }
        
        .nav-item:hover {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .nav-item .icon {
            font-size: 24px;
            transition: all 0.3s ease;
        }
        
        .nav-item.active .icon {
            transform: scale(1.2);
        }
        
        .home-indicator {
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 2px;
            width: 140px;
            margin: 12px auto 0;
            opacity: 0.8;
        }
        
        /* Success Message */
        .success-message {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 16px 24px;
            border-radius: 16px;
            font-weight: 600;
            box-shadow: 0 8px 35px var(--shadow-strong);
            z-index: 250;
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            transition: all 0.3s ease;
            max-width: 90%;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .success-message.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Loading States */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Confirmation Dialog */
        .confirm-dialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 400;
            backdrop-filter: blur(10px);
        }

        .confirm-dialog.show {
            display: flex;
        }

        .confirm-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
        }

        .confirm-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .confirm-message {
            color: var(--text-muted);
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .confirm-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Maiya AI View */
        .maiya-view {
            padding-top: 20px;
        }

        .maiya-capabilities {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .capability-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .capability-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }

        .capability-icon {
            font-size: 48px;
            margin-bottom: 16px;
            text-align: center;
        }

        .capability-title {
            font-weight: 700;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .capability-description {
            color: var(--text-muted);
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .view {
            padding-top: 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--text-primary);
            transition: all 0.5s ease;
        }

        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: 700;
            margin-right: 16px;
        }

        .company-logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            font-weight: 700;
            margin: 0 auto 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .company-logo:hover {
            transform: scale(1.05);
        }

        .profile-section {
            display: flex;
            align-items: center;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .profile-info h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .profile-info p {
            color: var(--text-muted);
            font-size: 14px;
        }

        .info-grid {
            display: grid;
            gap: 16px;
            margin: 20px 0;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .info-content h4 {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .info-content p {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* Responsive Design */
        @media screen and (max-width: 768px) {
            .maiya-chat {
                width: calc(100vw - 20px);
                right: 10px;
                bottom: 140px;
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .header-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .modal-content {
                margin: 20px;
                max-height: calc(100vh - 40px);
            }

            .action-buttons {
                justify-content: center;
            }

            .data-item-actions {
                justify-content: center;
            }
        }

        @media screen and (max-width: 480px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .data-item-actions {
                flex-direction: column;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .maiya-capabilities {
                grid-template-columns: 1fr;
            }
        }
        
        /* Safe Area Adjustments */
        @supports (padding: max(0px)) {
            .status-bar {
                padding-top: env(safe-area-inset-top);
                height: calc(44px + env(safe-area-inset-top));
            }
            
            .bottom-nav {
                padding-bottom: calc(32px + env(safe-area-inset-bottom));
            }
        }

        /* Focus Styles for Accessibility */
        .keyboard-navigation *:focus {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
        }

        /* Print Styles */
        @media print {
            .status-bar,
            .header,
            .bottom-nav,
            .modal,
            .maiya-chat {
                display: none !important;
            }

            .main-content {
                padding: 20px !important;
                position: static !important;
                height: auto !important;
                overflow: visible !important;
            }

            .card {
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body data-theme="red" data-mode="light">
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="time" id="status-time">9:41</div>
            <div class="theme-selector">
                <button class="theme-picker-btn" onclick="openThemePicker()" id="theme-picker-btn">
                    <span id="current-theme-icon">üåÖ</span> Themes
                </button>
                <button class="theme-toggle" onclick="toggleMode()" id="mode-toggle">üåë Darker</button>
                <span>üì∂</span>
                <span>üì±</span>
                <span>üîã</span>
            </div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <div class="logo-container">
                <div class="app-logo" id="app-logo">üåÖ</div>
                <div class="app-title">
                    <h1 id="company-name">REFIT BUSINESS SYSTEM</h1>
                    <p id="company-subtitle">Complete Solution with Maiya AI</p>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn maiya-btn" onclick="toggleMaiyaChat()" title="Maiya AI Assistant" id="maiya-toggle">
                    ü§ñ
                </button>
                <button class="header-btn" onclick="openThemePicker()" title="Change Theme">üé®</button>
                <button class="header-btn" onclick="showProfile()" title="Profile">üë§</button>
                <button class="header-btn" onclick="exportData()" title="Export">üì§</button>
                <button class="header-btn" onclick="showHelp()" title="Help">‚ùì</button>
            </div>
        </div>

        <!-- Maiya AI Chat Interface -->
        <div id="maiya-chat" class="maiya-chat">
            <div class="maiya-header">
                <div style="display: flex; align-items: center;">
                    <div class="maiya-avatar">ü§ñ</div>
                    <div>
                        <div class="maiya-status">
                            <span>Maiya AI Assistant</span>
                            <div class="maiya-status-dot"></div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.8;" id="maiya-status-text">Ready to help</div>
                    </div>
                </div>
                <button onclick="closeMaiyaChat()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer;">‚úï</button>
            </div>
            <div class="maiya-messages" id="maiya-messages">
                <div class="maiya-message ai">
                    Hi! I'm Maiya, your AI business assistant. I can help you:
                    <br>‚Ä¢ Analyze your business data
                    <br>‚Ä¢ Create documents & proposals
                    <br>‚Ä¢ Generate presentations
                    <br>‚Ä¢ Answer general questions
                    <br><br>How can I assist you today?
                </div>
            </div>
            <div class="maiya-input-area">
                <textarea 
                    class="maiya-input" 
                    id="maiya-input" 
                    placeholder="Type your message or click üé§ to speak..."
                    rows="1"
                    onkeypress="handleMaiyaKeyPress(event)"
                ></textarea>
                <button class="maiya-send-btn" onclick="sendMaiyaMessage()" title="Send Message">
                    üì§
                </button>
                <button class="maiya-voice-btn" onclick="toggleVoiceInput()" title="Voice Input" id="voice-btn">
                    üé§
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view">
                <!-- User Profile Section -->
                <div class="card">
                    <div class="profile-section">
                        <div class="avatar" id="user-avatar">JD</div>
                        <div class="profile-info" style="flex: 1;">
                            <h3 id="user-display-name">John Doe</h3>
                            <p id="user-display-title">Business Owner</p>
                        </div>
                        <button class="edit-btn" onclick="editProfile()">
                            ‚úèÔ∏è Edit Profile
                        </button>
                    </div>
                </div>

                <!-- Welcome Card with Maiya -->
                <div class="card" style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; text-align: center;">
                    <h3 style="margin-bottom: 16px; font-size: 20px;">ü§ñ Meet Maiya - Your AI Business Assistant</h3>
                    <p style="margin-bottom: 16px; opacity: 0.9;">Maiya combines powerful business management with intelligent AI assistance for document creation, data analysis, and general business support.</p>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px;">
                        <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 12px;">
                            <div style="font-size: 24px; margin-bottom: 4px;">üìã</div>
                            <div style="font-size: 12px; font-weight: 600;">Smart Quotes</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 12px;">
                            <div style="font-size: 24px; margin-bottom: 4px;">üë•</div>
                            <div style="font-size: 12px; font-weight: 600;">CRM System</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 12px;">
                            <div style="font-size: 24px; margin-bottom: 4px;">ü§ñ</div>
                            <div style="font-size: 12px; font-weight: 600;">Maiya AI</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 12px; border-radius: 12px;">
                            <div style="font-size: 24px; margin-bottom: 4px;">üìä</div>
                            <div style="font-size: 12px; font-weight: 600;">Analytics</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn" onclick="toggleMaiyaChat()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3);">
                            ü§ñ Chat with Maiya
                        </button>
                        <button class="btn" onclick="createQuote()" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3);">
                            üöÄ Create Quote
                        </button>
                    </div>
                </div>

                <!-- Company Info -->
                <div class="card">
                    <div style="text-align: center;">
                        <div class="company-logo" id="company-logo" onclick="openCompanyManager()">üåÖ</div>
                        <h3 id="company-display-name" style="font-weight: 700; margin-bottom: 8px; color: var(--text-primary); cursor: pointer;" onclick="openCompanyManager()">Your Company Name</h3>
                        <p id="company-display-tagline" style="color: var(--text-muted); margin-bottom: 16px;">Professional Services</p>
                    </div>
                    <div class="action-buttons center">
                        <button class="edit-btn" onclick="editCompany()">
                            ‚úèÔ∏è Edit Company
                        </button>
                        <button class="edit-btn" onclick="openCompanyManager()">
                            üè¢ Company Hub
                        </button>
                        <button class="edit-btn" onclick="askMaiyaAboutCompany()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                            ü§ñ Ask Maiya
                        </button>
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card" onclick="showView('quotes')">
                        <div class="stat-label">Total Quotes</div>
                        <div class="stat-value" id="total-quotes-count">0</div>
                        <button class="edit-btn small" onclick="event.stopPropagation(); createQuote()" style="position: absolute; top: 8px; right: 8px;">
                            ‚ûï
                        </button>
                    </div>
                    <div class="stat-card" onclick="showView('customers')">
                        <div class="stat-label">Total Customers</div>
                        <div class="stat-value" id="total-customers-count">0</div>
                        <button class="edit-btn small" onclick="event.stopPropagation(); addCustomer()" style="position: absolute; top: 8px; right: 8px;">
                            ‚ûï
                        </button>
                    </div>
                    <div class="stat-card" onclick="viewReports()">
                        <div class="stat-label">Monthly Revenue</div>
                        <div class="stat-value" id="monthly-revenue">RM 0</div>
                        <button class="edit-btn small" onclick="event.stopPropagation(); askMaiyaForAnalysis()" style="position: absolute; top: 8px; right: 8px; background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                            ü§ñ
                        </button>
                    </div>
                    <div class="stat-card" onclick="viewReports()">
                        <div class="stat-label">Total Revenue</div>
                        <div class="stat-value" id="total-revenue">RM 0</div>
                        <button class="edit-btn small" onclick="event.stopPropagation(); exportData()" style="position: absolute; top: 8px; right: 8px;">
                            üì§
                        </button>
                    </div>
                </div>

                <!-- Quick Actions with Maiya -->
                <div class="card">
                    <h3 style="font-weight: 700; margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">üöÄ Quick Actions</h3>
                    <div class="quick-actions">
                        <button class="quick-btn primary" onclick="createQuote()">
                            <span class="icon">üìã</span>
                            <span class="label">New Quote</span>
                        </button>
                        <button class="quick-btn success" onclick="addCustomer()">
                            <span class="icon">üë•</span>
                            <span class="label">Add Customer</span>
                        </button>
                        <button class="quick-btn" onclick="toggleMaiyaChat()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                            <span class="icon">ü§ñ</span>
                            <span class="label">Chat Maiya</span>
                        </button>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-btn info" onclick="openDocumentGenerator()">
                            <span class="icon">üìÑ</span>
                            <span class="label">Documents</span>
                        </button>
                        <button class="quick-btn warning" onclick="openPresentationGenerator()">
                            <span class="icon">üìä</span>
                            <span class="label">Presentations</span>
                        </button>
                        <button class="quick-btn danger" onclick="viewReports()">
                            <span class="icon">üìà</span>
                            <span class="label">Reports</span>
                        </button>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üìà Recent Activity</h3>
                        <div style="display: flex; gap: 8px;">
                            <button class="edit-btn small" onclick="refreshRecentActivity()">
                                üîÑ Refresh
                            </button>
                            <button class="edit-btn small" onclick="askMaiyaForInsights()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                                ü§ñ Insights
                            </button>
                        </div>
                    </div>
                    <div id="recent-activity" class="data-list">
                        <!-- Recent items will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Maiya AI View -->
            <div id="maiya-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">ü§ñ Maiya AI Assistant</h2>
                    <div style="display: flex; gap: 8px;">
                        <button class="edit-btn" onclick="clearMaiyaHistory()">üóëÔ∏è Clear Chat</button>
                        <button class="edit-btn" onclick="exportMaiyaChat()">üì§ Export Chat</button>
                    </div>
                </div>

                <!-- Maiya Capabilities -->
                <div class="card">
                    <h3 style="font-weight: 700; margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">‚ú® What Maiya Can Do</h3>
                    <div class="maiya-capabilities">
                        <div class="capability-card" onclick="startBusinessAnalysis()">
                            <div class="capability-icon">üìä</div>
                            <div class="capability-title">Business Analysis</div>
                            <div class="capability-description">Analyze your quotes, customers, revenue trends, and provide actionable insights for business growth.</div>
                        </div>
                        
                        <div class="capability-card" onclick="openDocumentGenerator()">
                            <div class="capability-icon">üìÑ</div>
                            <div class="capability-title">Document Creation</div>
                            <div class="capability-description">Generate professional proposals, contracts, invoices, reports, and business letters with AI assistance.</div>
                        </div>
                        
                        <div class="capability-card" onclick="openPresentationGenerator()">
                            <div class="capability-icon">üéØ</div>
                            <div class="capability-title">Presentations</div>
                            <div class="capability-description">Create compelling business presentations with content, scripts, and speaker notes ready in minutes.</div>
                        </div>
                        
                        <div class="capability-card" onclick="startMarketingHelp()">
                            <div class="capability-icon">üìà</div>
                            <div class="capability-title">Marketing Support</div>
                            <div class="capability-description">Develop marketing strategies, write copy, create social media content, and plan campaigns.</div>
                        </div>
                        
                        <div class="capability-card" onclick="startFinancialHelp()">
                            <div class="capability-icon">üí∞</div>
                            <div class="capability-title">Financial Planning</div>
                            <div class="capability-description">Budget planning, financial analysis, pricing strategies, and investment recommendations.</div>
                        </div>
                        
                        <div class="capability-card" onclick="startGeneralHelp()">
                            <div class="capability-icon">üß†</div>
                            <div class="capability-title">General Business</div>
                            <div class="capability-description">Answer questions, provide advice, solve problems, and assist with any business-related task.</div>
                        </div>
                    </div>
                </div>

                <!-- Quick Start Templates -->
                <div class="card">
                    <h3 style="font-weight: 700; margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">üöÄ Quick Start Templates</h3>
                    <div class="quick-actions">
                        <button class="quick-btn primary" onclick="generateBusinessPlan()">
                            <span class="icon">üìã</span>
                            <span class="label">Business Plan</span>
                        </button>
                        <button class="quick-btn success" onclick="generateMarketingStrategy()">
                            <span class="icon">üìà</span>
                            <span class="label">Marketing Plan</span>
                        </button>
                        <button class="quick-btn info" onclick="generateSalesProposal()">
                            <span class="icon">üíº</span>
                            <span class="label">Sales Proposal</span>
                        </button>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-btn warning" onclick="generatePitchDeck()">
                            <span class="icon">üéØ</span>
                            <span class="label">Pitch Deck</span>
                        </button>
                        <button class="quick-btn danger" onclick="generateFinancialReport()">
                            <span class="icon">üìä</span>
                            <span class="label">Financial Report</span>
                        </button>
                        <button class="quick-btn" onclick="generateCustomDocument()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                            <span class="icon">‚ú®</span>
                            <span class="label">Custom Doc</span>
                        </button>
                    </div>
                </div>

                <!-- Maiya Chat History -->
                <div class="card">
                    <h3 style="font-weight: 700; margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">üí¨ Recent Conversations</h3>
                    <div id="maiya-chat-history" class="data-list">
                        <!-- Chat history will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Quotes View -->
            <div id="quotes-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">üìã Quotes</h2>
                    <div style="display: flex; gap: 8px;">
                        <button class="edit-btn" onclick="exportQuotes()">üì§ Export</button>
                        <button class="edit-btn" onclick="askMaiyaAboutQuotes()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">ü§ñ Analyze</button>
                        <button class="btn btn-primary" onclick="createQuote()">‚ûï New Quote</button>
                    </div>
                </div>
                <div id="quotes-list" class="data-list">
                    <!-- Quotes will be populated here -->
                </div>
            </div>

            <!-- Customers View -->
            <div id="customers-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">üë• Customers</h2>
                    <div style="display: flex; gap: 8px;">
                        <button class="edit-btn" onclick="exportCustomers()">üì§ Export</button>
                        <button class="edit-btn" onclick="askMaiyaAboutCustomers()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">ü§ñ Insights</button>
                        <button class="btn btn-primary" onclick="addCustomer()">‚ûï Add Customer</button>
                    </div>
                </div>
                <div id="customers-list" class="data-list">
                    <!-- Customers will be populated here -->
                </div>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">‚öôÔ∏è Settings</h2>
                    <button class="edit-btn" onclick="resetAllSettings()">üîÑ Reset</button>
                </div>

                <!-- Maiya AI Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">ü§ñ Maiya AI Settings</h3>
                        <button class="edit-btn small" onclick="resetMaiyaSettings()">üîÑ Reset AI</button>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-icon">üó£Ô∏è</div>
                            <div class="info-content">
                                <h4>Voice Input</h4>
                                <p id="voice-status">Enabled (Browser Support)</p>
                            </div>
                            <button class="edit-btn small" onclick="toggleVoiceSettings()">Toggle</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üí¨</div>
                            <div class="info-content">
                                <h4>Chat History</h4>
                                <p id="chat-history-count">0 conversations saved</p>
                            </div>
                            <button class="edit-btn small" onclick="clearMaiyaHistory()">Clear</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üìÑ</div>
                            <div class="info-content">
                                <h4>Document Templates</h4>
                                <p>15+ business templates available</p>
                            </div>
                            <button class="edit-btn small" onclick="openDocumentGenerator()">Browse</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üéØ</div>
                            <div class="info-content">
                                <h4>AI Assistance Level</h4>
                                <p>Advanced Business Mode</p>
                            </div>
                            <button class="edit-btn small" onclick="adjustAILevel()">Adjust</button>
                        </div>
                    </div>
                </div>

                <!-- Data Management -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üíæ Data Management</h3>
                        <button class="edit-btn small" onclick="checkDataIntegrity()">‚úÖ Check Data</button>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                        <button class="quick-btn primary" onclick="createManualBackup()">
                            <span class="icon">üíæ</span>
                            <span class="label">Create Backup</span>
                        </button>
                        <button class="quick-btn success" onclick="exportAllData()">
                            <span class="icon">üì§</span>
                            <span class="label">Export Data</span>
                        </button>
                        <button class="quick-btn info" onclick="importDataFile()">
                            <span class="icon">üì•</span>
                            <span class="label">Import Data</span>
                        </button>
                        <button class="quick-btn warning" onclick="showStorageInfo()" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
                            <span class="icon">üìä</span>
                            <span class="label">Storage Info</span>
                        </button>
                    </div>
                    
                    <!-- Storage Status -->
                    <div style="background: var(--bg-secondary); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: var(--text-primary);">Storage Status</span>
                            <div style="display: flex; gap: 8px;">
                                <span id="storage-usage" style="color: var(--text-muted); font-size: 14px;">Loading...</span>
                                <button class="edit-btn small" onclick="clearCache()">üóëÔ∏è Clear Cache</button>
                            </div>
                        </div>
                        <div style="width: 100%; height: 6px; background: var(--border-color); border-radius: 3px; overflow: hidden;">
                            <div id="storage-progress" style="height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); width: 0%; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                </div>

                <!-- Theme Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üé® Theme Settings</h3>
                        <button class="edit-btn small" onclick="randomTheme()">üé≤ Random</button>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                        <button class="quick-btn" onclick="switchToTheme('red')" style="background: linear-gradient(135deg, #f87171, #fca5a5);">
                            <span class="icon">üåÖ</span>
                            <span class="label">Coral Sunset</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('orange')" style="background: linear-gradient(135deg, #fb923c, #fdba74);">
                            <span class="icon">üçë</span>
                            <span class="label">Peach Glow</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('pink')" style="background: linear-gradient(135deg, #f472b6, #f9a8d4);">
                            <span class="icon">üå∏</span>
                            <span class="label">Rose Blush</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('yellow')" style="background: linear-gradient(135deg, #fbbf24, #fcd34d);">
                            <span class="icon">üåª</span>
                            <span class="label">Butter Cream</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('bluegreen')" style="background: linear-gradient(135deg, #2dd4bf, #7dd3fc);">
                            <span class="icon">üåä</span>
                            <span class="label">Mint Breeze</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('purplegrey')" style="background: linear-gradient(135deg, #a855f7, #c4b5fd);">
                            <span class="icon">üíú</span>
                            <span class="label">Lavender Mist</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('browngrey')" style="background: linear-gradient(135deg, #a3a3a3, #d6d3d1);">
                            <span class="icon">ü§é</span>
                            <span class="label">Warm Taupe</span>
                        </button>
                        <button class="quick-btn" onclick="switchToTheme('greenbrown')" style="background: linear-gradient(135deg, #84cc16, #bef264);">
                            <span class="icon">üåø</span>
                            <span class="label">Sage Olive</span>
                        </button>
                    </div>
                </div>

                <!-- App Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üì± App Settings</h3>
                        <button class="edit-btn small" onclick="exportSettings()">üì§ Export Settings</button>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-icon">üé®</div>
                            <div class="info-content">
                                <h4>Current Theme</h4>
                                <p id="current-theme-name">Coral Sunset</p>
                            </div>
                            <button class="edit-btn small" onclick="openThemePicker()">Edit</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üåë</div>
                            <div class="info-content">
                                <h4>Theme Mode</h4>
                                <p id="current-mode-setting">Standard Mode Active</p>
                            </div>
                            <button class="edit-btn small" onclick="toggleMode()">Toggle</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üì±</div>
                            <div class="info-content">
                                <h4>Platform</h4>
                                <p id="platform-info">Mobile Web App</p>
                            </div>
                            <button class="edit-btn small" onclick="installApp()">Install</button>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">üîß</div>
                            <div class="info-content">
                                <h4>App Version</h4>
                                <p id="app-version">REFIT v3.0.0 with Maiya AI</p>
                            </div>
                            <button class="edit-btn small" onclick="checkForUpdates()">Update</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-items">
                <div class="nav-item active" onclick="showView('dashboard')">
                    <span class="icon">üè†</span>
                    <span>Home</span>
                </div>
                <div class="nav-item" onclick="showView('quotes')">
                    <span class="icon">üìã</span>
                    <span>Quotes</span>
                </div>
                <div class="nav-item" onclick="showView('customers')">
                    <span class="icon">üë•</span>
                    <span>Customers</span>
                </div>
                <div class="nav-item" onclick="showView('maiya')">
                    <span class="icon">ü§ñ</span>
                    <span>Maiya</span>
                </div>
                <div class="nav-item" onclick="showView('settings')">
                    <span class="icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </div>
            </div>
            <div class="home-indicator"></div>
        </div>
    </div>

    <!-- Document Generator Modal -->
    <div id="doc-gen-modal" class="modal doc-gen-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìÑ Maiya Document Generator</h3>
                <button class="modal-close-btn" onclick="closeModal('doc-gen-modal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <p style="color: var(--text-muted); font-size: 16px;">Choose a document template or describe what you need</p>
                </div>
                
                <div class="doc-template-grid">
                    <div class="doc-template" onclick="selectDocTemplate('business-plan')">
                        <div class="doc-template-icon">üìã</div>
                        <div class="doc-template-name">Business Plan</div>
                        <div class="doc-template-desc">Comprehensive business strategy document</div>
                    </div>
                    
                    <div class="doc-template" onclick="selectDocTemplate('proposal')">
                        <div class="doc-template-icon">üíº</div>
                        <div class="doc-template-name">Project Proposal</div>
                        <div class="doc-template-desc">Professional project proposals</div>
                    </div>
                    
                    <div class="doc-template" onclick="selectDocTemplate('contract')">
                        <div class="doc-template-icon">üìú</div>
                        <div class="doc-template-name">Contract</div>
                        <div class="doc-template-desc">Service agreements and contracts</div>
                    </div>
                    
                    <div class="doc-template" onclick="selectDocTemplate('report')">
                        <div class="doc-template-icon">üìä</div>
                        <div class="doc-template-name">Business Report</div>
                        <div class="doc-template-desc">Financial and performance reports</div>
                    </div>
                    
                    <div class="doc-template" onclick="selectDocTemplate('letter')">
                        <div class="doc-template-icon">‚úâÔ∏è</div>
                        <div class="doc-template-name">Business Letter</div>
                        <div class="doc-template-desc">Professional correspondence</div>
                    </div>
                    
                    <div class="doc-template" onclick="selectDocTemplate('policy')">
                        <div class="doc-template-icon">üìã</div>
                        <div class="doc-template-name">Policy Document</div>
                        <div class="doc-template-desc">Company policies and procedures</div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <label class="form-label">Custom Requirements (Optional)</label>
                    <textarea class="form-textarea" id="doc-custom-requirements" placeholder="Describe any specific requirements for your document..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('doc-gen-modal')">Cancel</button>
                <button class="btn btn-success" onclick="generateDocument()" id="generate-doc-btn">üöÄ Generate with Maiya</button>
            </div>
        </div>
    </div>

    <!-- Presentation Generator Modal -->
    <div id="presentation-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>üéØ Maiya Presentation Generator</h3>
                <button class="modal-close-btn" onclick="closeModal('presentation-modal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <p style="color: var(--text-muted); font-size: 16px;">Create a complete presentation with content and speaker notes</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Presentation Topic *</label>
                    <input type="text" class="form-input" id="presentation-topic" placeholder="e.g., Company Growth Strategy 2024">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Audience</label>
                        <select class="form-select" id="presentation-audience">
                            <option value="executives">Executives/Investors</option>
                            <option value="clients">Clients/Customers</option>
                            <option value="employees">Employees/Team</option>
                            <option value="general">General Business</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Duration (minutes)</label>
                        <select class="form-select" id="presentation-duration">
                            <option value="5">5 minutes</option>
                            <option value="10">10 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="20">20 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Key Points to Cover</label>
                    <textarea class="form-textarea" id="presentation-points" placeholder="List the main points you want to cover in your presentation..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Presentation Style</label>
                    <select class="form-select" id="presentation-style">
                        <option value="professional">Professional & Formal</option>
                        <option value="casual">Casual & Conversational</option>
                        <option value="persuasive">Persuasive & Sales-focused</option>
                        <option value="educational">Educational & Informative</option>
                    </select>
                </div>
                
                <div id="presentation-preview" style="display: none;">
                    <h4 style="color: var(--text-primary); margin: 20px 0 16px;">üìã Presentation Preview</h4>
                    <div id="presentation-slides"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('presentation-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="generatePresentation()">üéØ Generate Presentation</button>
                <button class="btn btn-success" onclick="exportPresentation()" style="display: none;" id="export-presentation-btn">üì§ Export Slides</button>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="success-message" class="success-message">
        <span id="success-text">Action completed successfully!</span>
    </div>

    <!-- Include all existing modals and components from the original file -->
    <!-- [All other modals would go here - User Profile Modal, Company Details Modal, etc.] -->

    <script>
        // ===== MAIYA AI SYSTEM =====
        class MaiyaAI {
            constructor() {
                this.isListening = false;
                this.isProcessing = false;
                this.recognition = null;
                this.chatHistory = [];
                this.currentDocumentType = null;
                this.voiceEnabled = this.checkVoiceSupport();
                this.initializeVoiceRecognition();
            }

            checkVoiceSupport() {
                return 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;
            }

            initializeVoiceRecognition() {
                if (this.voiceEnabled) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = false;
                    this.recognition.interimResults = false;
                    this.recognition.lang = 'en-US';

                    this.recognition.onstart = () => {
                        this.isListening = true;
                        this.updateVoiceUI();
                        this.updateStatus('Listening...');
                    };

                    this.recognition.onend = () => {
                        this.isListening = false;
                        this.updateVoiceUI();
                        this.updateStatus('Ready to help');
                    };

                    this.recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        document.getElementById('maiya-input').value = transcript;
                        this.sendMessage(transcript);
                    };

                    this.recognition.onerror = (event) => {
                        this.isListening = false;
                        this.updateVoiceUI();
                        showSuccessMessage('‚ùå Voice recognition error. Please try again.');
                    };
                }
            }

            updateVoiceUI() {
                const voiceBtn = document.getElementById('voice-btn');
                const maiyaBtn = document.getElementById('maiya-toggle');
                
                if (this.isListening) {
                    voiceBtn.classList.add('listening');
                    maiyaBtn.classList.add('listening');
                } else {
                    voiceBtn.classList.remove('listening');
                    maiyaBtn.classList.remove('listening');
                }

                if (this.isProcessing) {
                    maiyaBtn.classList.add('processing');
                } else {
                    maiyaBtn.classList.remove('processing');
                }
            }

            updateStatus(status) {
                const statusText = document.getElementById('maiya-status-text');
                if (statusText) {
                    statusText.textContent = status;
                }
            }

            startVoiceInput() {
                if (this.voiceEnabled && this.recognition && !this.isListening) {
                    this.recognition.start();
                } else {
                    showSuccessMessage('üé§ Voice input not available in your browser');
                }
            }

            stopVoiceInput() {
                if (this.recognition && this.isListening) {
                    this.recognition.stop();
                }
            }

            sendMessage(message) {
                if (!message.trim()) return;

                // Add user message to chat
                this.addMessageToChat(message, 'user');

                // Clear input
                document.getElementById('maiya-input').value = '';

                // Process message
                this.processMessage(message);
            }

            addMessageToChat(message, sender) {
                const messagesContainer = document.getElementById('maiya-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `maiya-message ${sender}`;
                messageDiv.textContent = message;
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;

                // Save to history
                this.chatHistory.push({
                    message: message,
                    sender: sender,
                    timestamp: new Date()
                });

                this.saveChatHistory();
            }

            async processMessage(message) {
                this.isProcessing = true;
                this.updateVoiceUI();
                this.updateStatus('Thinking...');

                // Simulate AI processing delay
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));

                const response = this.generateResponse(message);
                this.addMessageToChat(response, 'ai');

                this.isProcessing = false;
                this.updateVoiceUI();
                this.updateStatus('Ready to help');
            }

            generateResponse(message) {
                const lowerMessage = message.toLowerCase();

                // Business analysis responses
                if (lowerMessage.includes('analysis') || lowerMessage.includes('analyze') || lowerMessage.includes('insight')) {
                    return this.generateBusinessAnalysis();
                }

                // Document creation responses
                if (lowerMessage.includes('document') || lowerMessage.includes('proposal') || lowerMessage.includes('contract')) {
                    return "I can help you create professional documents! Let me open the document generator for you. What type of document do you need - business plan, proposal, contract, or something else?";
                }

                // Presentation responses
                if (lowerMessage.includes('presentation') || lowerMessage.includes('slide') || lowerMessage.includes('pitch')) {
                    return "I'll help you create an amazing presentation! I can generate slides with content, talking points, and speaker notes. What's your presentation topic and who's your audience?";
                }

                // Financial responses
                if (lowerMessage.includes('revenue') || lowerMessage.includes('financial') || lowerMessage.includes('money') || lowerMessage.includes('profit')) {
                    return this.generateFinancialInsights();
                }

                // Customer insights
                if (lowerMessage.includes('customer') || lowerMessage.includes('client')) {
                    return this.generateCustomerInsights();
                }

                // Quote insights
                if (lowerMessage.includes('quote') || lowerMessage.includes('quotation')) {
                    return this.generateQuoteInsights();
                }

                // Marketing help
                if (lowerMessage.includes('marketing') || lowerMessage.includes('promotion') || lowerMessage.includes('advertis')) {
                    return "I can help with your marketing strategy! I can create:\n‚Ä¢ Social media content\n‚Ä¢ Email campaigns\n‚Ä¢ Marketing plans\n‚Ä¢ Brand messaging\n‚Ä¢ Competitive analysis\n\nWhat specific marketing challenge are you facing?";
                }

                // General business advice
                if (lowerMessage.includes('help') || lowerMessage.includes('advice') || lowerMessage.includes('suggest')) {
                    return "I'm here to help with all aspects of your business! I can assist with:\n\nüìä Business analysis & reporting\nüìÑ Document creation (proposals, contracts, plans)\nüéØ Presentation development\nüìà Marketing strategies\nüí∞ Financial planning\nüë• Customer management\nüìã Process optimization\n\nWhat would you like to work on today?";
                }

                // Greetings
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return `Hello! I'm Maiya, your AI business assistant. I'm ready to help you grow your business with:\n\nüéØ Intelligent analysis of your ${appState.quotes.length} quotes and ${appState.customers.length} customers\nüìÑ Professional document creation\nüéØ Presentation development\nüìä Business insights\n\nHow can I assist you today?`;
                }

                // Default response with business focus
                return "I understand you're looking for business assistance. I can help with:\n\nüìä Analyzing your business data\nüìÑ Creating professional documents\nüéØ Building presentations\nüìà Marketing strategies\nüí∞ Financial planning\n\nCould you be more specific about what you need help with?";
            }

            generateBusinessAnalysis() {
                const totalRevenue = appState.stats.totalRevenue;
                const monthlyRevenue = appState.stats.monthlyRevenue;
                const totalQuotes = appState.stats.totalQuotes;
                const totalCustomers = appState.stats.totalCustomers;

                const avgQuoteValue = totalQuotes > 0 ? (totalRevenue / totalQuotes) : 0;
                const revenuePerCustomer = totalCustomers > 0 ? (totalRevenue / totalCustomers) : 0;

                return `üìä Business Analysis Summary:

**Financial Performance:**
‚Ä¢ Total Revenue: RM ${totalRevenue.toFixed(2)}
‚Ä¢ Monthly Revenue: RM ${monthlyRevenue.toFixed(2)}
‚Ä¢ Average Quote Value: RM ${avgQuoteValue.toFixed(2)}
‚Ä¢ Revenue per Customer: RM ${revenuePerCustomer.toFixed(2)}

**Key Insights:**
${totalQuotes > 0 ? `‚Ä¢ You have ${totalQuotes} quotes with an average value of RM ${avgQuoteValue.toFixed(2)}` : '‚Ä¢ Create your first quote to start tracking performance'}
${totalCustomers > 0 ? `‚Ä¢ ${totalCustomers} customers generating RM ${revenuePerCustomer.toFixed(2)} average revenue` : '‚Ä¢ Add customers to expand your business base'}

**Recommendations:**
‚Ä¢ ${avgQuoteValue < 5000 ? 'Consider increasing quote values through premium services' : 'Great quote values! Focus on volume growth'}
‚Ä¢ ${totalCustomers < 10 ? 'Expand customer base for revenue growth' : 'Excellent customer base! Focus on retention'}
‚Ä¢ ${monthlyRevenue < totalRevenue * 0.3 ? 'Increase monthly sales activities' : 'Strong monthly performance!'}

Would you like me to create a detailed report or presentation on any of these insights?`;
            }

            generateFinancialInsights() {
                const totalRevenue = appState.stats.totalRevenue;
                const monthlyRevenue = appState.stats.monthlyRevenue;

                return `üí∞ Financial Overview:

**Current Position:**
‚Ä¢ Total Revenue: RM ${totalRevenue.toFixed(2)}
‚Ä¢ This Month: RM ${monthlyRevenue.toFixed(2)}
‚Ä¢ Growth Rate: ${totalRevenue > 0 ? ((monthlyRevenue / (totalRevenue - monthlyRevenue)) * 100).toFixed(1) : '0'}%

**Financial Health:**
${monthlyRevenue > totalRevenue * 0.2 ? '‚úÖ Strong monthly performance' : '‚ö†Ô∏è Consider boosting monthly sales'}
${totalRevenue > 50000 ? '‚úÖ Healthy revenue base' : 'üìà Focus on growth strategies'}

**Suggestions:**
‚Ä¢ Set monthly revenue targets
‚Ä¢ Track profit margins on quotes
‚Ä¢ Plan for seasonal variations
‚Ä¢ Consider diversifying revenue streams

Would you like me to create a detailed financial report or business plan?`;
            }

            generateCustomerInsights() {
                const customers = appState.customers;
                const totalCustomers = customers.length;

                if (totalCustomers === 0) {
                    return "You don't have any customers yet. Let me help you get started:\n\n‚Ä¢ Add your first customer to begin tracking\n‚Ä¢ I can help create customer acquisition strategies\n‚Ä¢ Generate proposals to attract new clients\n\nWould you like me to create a customer acquisition plan?";
                }

                const activeCustomers = customers.filter(c => c.status === 'active').length;
                const industries = [...new Set(customers.map(c => c.industry))];

                return `üë• Customer Analysis:

**Customer Base:**
‚Ä¢ Total Customers: ${totalCustomers}
‚Ä¢ Active Customers: ${activeCustomers}
‚Ä¢ Industries Served: ${industries.length}
‚Ä¢ Top Industries: ${industries.slice(0, 3).join(', ')}

**Customer Distribution:**
${industries.map(industry => `‚Ä¢ ${industry}: ${customers.filter(c => c.industry === industry).length} customers`).join('\n')}

**Recommendations:**
‚Ä¢ ${activeCustomers < totalCustomers ? 'Re-engage inactive customers' : 'Great customer retention!'}
‚Ä¢ ${industries.length < 3 ? 'Consider expanding to new industries' : 'Good industry diversification'}
‚Ä¢ Focus on referrals from top customers

Would you like me to create a customer relationship strategy or marketing plan?`;
            }

            generateQuoteInsights() {
                const quotes = appState.quotes;
                const totalQuotes = quotes.length;

                if (totalQuotes === 0) {
                    return "You haven't created any quotes yet. Let me help you get started:\n\n‚Ä¢ Create your first professional quote\n‚Ä¢ I can help with pricing strategies\n‚Ä¢ Generate proposal templates\n\nWould you like me to guide you through creating your first quote?";
                }

                const sentQuotes = quotes.filter(q => q.status === 'sent').length;
                const draftQuotes = quotes.filter(q => q.status === 'draft').length;
                const avgQuoteValue = quotes.reduce((sum, q) => sum + q.total, 0) / totalQuotes;

                return `üìã Quote Performance:

**Quote Statistics:**
‚Ä¢ Total Quotes: ${totalQuotes}
‚Ä¢ Sent Quotes: ${sentQuotes}
‚Ä¢ Draft Quotes: ${draftQuotes}
‚Ä¢ Average Value: RM ${avgQuoteValue.toFixed(2)}

**Performance Metrics:**
‚Ä¢ Send Rate: ${((sentQuotes / totalQuotes) * 100).toFixed(1)}%
‚Ä¢ Quote Efficiency: ${draftQuotes === 0 ? 'Excellent!' : 'Consider completing drafts'}

**Recommendations:**
‚Ä¢ ${draftQuotes > 0 ? 'Complete and send pending draft quotes' : 'Great quote completion rate!'}
‚Ä¢ ${avgQuoteValue < 5000 ? 'Consider premium service offerings' : 'Strong quote values!'}
‚Ä¢ Follow up on sent quotes for better conversion

Would you like me to create a sales strategy or quote templates?`;
            }

            saveChatHistory() {
                try {
                    localStorage.setItem('maiya-chat-history', JSON.stringify(this.chatHistory));
                    document.getElementById('chat-history-count').textContent = `${this.chatHistory.length} conversations saved`;
                } catch (error) {
                    console.warn('Failed to save chat history:', error);
                }
            }

            loadChatHistory() {
                try {
                    const saved = localStorage.getItem('maiya-chat-history');
                    if (saved) {
                        this.chatHistory = JSON.parse(saved);
                        document.getElementById('chat-history-count').textContent = `${this.chatHistory.length} conversations saved`;
                    }
                } catch (error) {
                    console.warn('Failed to load chat history:', error);
                    this.chatHistory = [];
                }
            }

            clearHistory() {
                this.chatHistory = [];
                document.getElementById('maiya-messages').innerHTML = `
                    <div class="maiya-message ai">
                        Hi! I'm Maiya, your AI business assistant. I can help you:
                        <br>‚Ä¢ Analyze your business data
                        <br>‚Ä¢ Create documents & proposals
                        <br>‚Ä¢ Generate presentations
                        <br>‚Ä¢ Answer general questions
                        <br><br>How can I assist you today?
                    </div>
                `;
                localStorage.removeItem('maiya-chat-history');
                showSuccessMessage('üóëÔ∏è Chat history cleared!');
            }

            exportChatHistory() {
                if (this.chatHistory.length === 0) {
                    showSuccessMessage('‚ùå No chat history to export!');
                    return;
                }

                const chatData = {
                    export_date: new Date().toISOString(),
                    total_messages: this.chatHistory.length,
                    conversations: this.chatHistory
                };

                const dataStr = JSON.stringify(chatData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `maiya-chat-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showSuccessMessage('üì§ Chat history exported successfully!');
            }
        }

        // ===== DOCUMENT GENERATOR =====
        class DocumentGenerator {
            constructor() {
                this.selectedTemplate = null;
                this.templates = {
                    'business-plan': {
                        name: 'Business Plan',
                        sections: ['Executive Summary', 'Company Description', 'Market Analysis', 'Organization & Management', 'Services/Products', 'Marketing & Sales', 'Financial Projections'],
                        content: this.generateBusinessPlan
                    },
                    'proposal': {
                        name: 'Project Proposal',
                        sections: ['Introduction', 'Project Overview', 'Scope of Work', 'Timeline', 'Budget', 'Terms & Conditions'],
                        content: this.generateProjectProposal
                    },
                    'contract': {
                        name: 'Service Contract',
                        sections: ['Contract Overview', 'Services Provided', 'Terms & Conditions', 'Payment Terms', 'Termination Clause'],
                        content: this.generateServiceContract
                    },
                    'report': {
                        name: 'Business Report',
                        sections: ['Executive Summary', 'Current Status', 'Analysis', 'Recommendations', 'Conclusion'],
                        content: this.generateBusinessReport
                    },
                    'letter': {
                        name: 'Business Letter',
                        sections: ['Header', 'Salutation', 'Body', 'Closing', 'Signature'],
                        content: this.generateBusinessLetter
                    },
                    'policy': {
                        name: 'Policy Document',
                        sections: ['Policy Overview', 'Scope', 'Procedures', 'Responsibilities', 'Compliance'],
                        content: this.generatePolicyDocument
                    }
                };
            }

            selectTemplate(templateId) {
                this.selectedTemplate = templateId;
                document.querySelectorAll('.doc-template').forEach(template => {
                    template.classList.remove('selected');
                });
                document.querySelector(`[onclick="selectDocTemplate('${templateId}')"]`).classList.add('selected');

                // Update button text
                const btn = document.getElementById('generate-doc-btn');
                btn.innerHTML = `üöÄ Generate ${this.templates[templateId].name}`;
            }

            generateDocument() {
                if (!this.selectedTemplate) {
                    showSuccessMessage('‚ùå Please select a document template first!');
                    return;
                }

                const template = this.templates[this.selectedTemplate];
                const customRequirements = document.getElementById('doc-custom-requirements').value;

                showSuccessMessage('üöÄ Maiya is generating your document...');
                
                // Simulate AI processing
                setTimeout(() => {
                    const content = template.content.call(this, customRequirements);
                    this.displayGeneratedDocument(template.name, content);
                    closeModal('doc-gen-modal');
                }, 2000);
            }

            generateBusinessPlan(customRequirements) {
                const company = appState.companyInfo;
                const revenue = appState.stats.totalRevenue;
                const customers = appState.stats.totalCustomers;

                return `# ${company.name} Business Plan

## Executive Summary
${company.name} is a ${company.industry} company specializing in ${company.tagline}. With ${customers} customers and RM ${revenue.toFixed(2)} in revenue, we are positioned for significant growth in the Malaysian market.

## Company Description
**Company Name:** ${company.name}
**Industry:** ${company.industry}
**Founded:** ${company.yearsInBusiness} years ago
**Location:** ${company.address}
**Mission:** To provide exceptional ${company.tagline} services to our clients.

## Market Analysis
The ${company.industry} industry in Malaysia shows strong growth potential. Our target market includes businesses requiring professional services, with a focus on quality and innovation.

**Current Performance:**
- Active Customers: ${customers}
- Monthly Revenue: RM ${appState.stats.monthlyRevenue.toFixed(2)}
- Success Rate: ${company.successRate}%

## Services/Products
We provide comprehensive ${company.tagline} including:
- Custom solutions for business needs
- Professional consulting services
- Ongoing support and maintenance

## Marketing & Sales Strategy
**Target Market:** ${company.industry} businesses in Malaysia
**Marketing Channels:** Digital marketing, referrals, networking
**Sales Process:** Quote-based system with personalized service

## Financial Projections
**Current Revenue:** RM ${revenue.toFixed(2)}
**Projected Growth:** 25% annually
**Target Customer Base:** ${customers * 2} customers within 12 months

${customRequirements ? `\n## Custom Requirements\n${customRequirements}` : ''}

---
*Generated by Maiya AI Assistant for ${company.name}*
*Date: ${new Date().toLocaleDateString()}*`;
            }

            generateProjectProposal(customRequirements) {
                const company = appState.companyInfo;
                const user = appState.userProfile;

                return `# Project Proposal

**From:** ${company.name}
**Contact:** ${user.firstName} ${user.lastName}
**Email:** ${company.email}
**Phone:** ${company.phone}
**Date:** ${new Date().toLocaleDateString()}

## Introduction
Thank you for considering ${company.name} for your project needs. We are excited to present this comprehensive proposal that outlines our approach to delivering exceptional results.

## Project Overview
This proposal outlines a complete solution designed to meet your specific business requirements. Our team of experienced professionals will work closely with you to ensure project success.

## Scope of Work
**Phase 1: Discovery & Planning**
- Initial consultation and requirements gathering
- Detailed project planning and timeline development
- Resource allocation and team assignment

**Phase 2: Implementation**
- Project execution according to agreed specifications
- Regular progress updates and milestone reviews
- Quality assurance and testing

**Phase 3: Delivery & Support**
- Final delivery and client training
- Documentation and knowledge transfer
- Ongoing support and maintenance

## Timeline
**Project Duration:** 6-8 weeks
**Key Milestones:**
- Week 1: Project kickoff and planning
- Week 3: Phase 1 completion
- Week 6: Implementation complete
- Week 8: Final delivery and handover

## Investment
**Project Fee:** RM [Amount to be determined]
**Payment Terms:** 50% deposit, 50% upon completion
**Additional Services:** Available upon request

## Why Choose ${company.name}?
- ${company.yearsInBusiness} years of industry experience
- ${company.successRate}% client satisfaction rate
- Proven track record with ${appState.stats.totalCustomers} satisfied customers
- Comprehensive support and maintenance

${customRequirements ? `\n## Custom Requirements\n${customRequirements}` : ''}

We look forward to the opportunity to work with you and deliver exceptional results.

**${user.firstName} ${user.lastName}**
*${user.title}*
*${company.name}*`;
            }

            generateServiceContract(customRequirements) {
                const company = appState.companyInfo;
                const user = appState.userProfile;

                return `# Service Agreement Contract

**Service Provider:** ${company.name}
**Registration:** ${company.registration}
**Address:** ${company.address}
**Contact:** ${user.firstName} ${user.lastName}
**Email:** ${company.email}
**Phone:** ${company.phone}

**Date:** ${new Date().toLocaleDateString()}

## 1. Contract Overview
This Service Agreement ("Agreement") is entered into between ${company.name} ("Service Provider") and the Client ("Client") for the provision of professional services.

## 2. Services Provided
The Service Provider agrees to provide the following services:
- Professional consulting and advisory services
- Project management and implementation
- Technical support and maintenance
- Documentation and training as required

## 3. Terms & Conditions
**Duration:** This agreement shall remain in effect for [DURATION] unless terminated earlier.
**Scope:** Services will be provided as outlined in the attached project proposal.
**Quality:** All services will be delivered to industry standards and best practices.

## 4. Payment Terms
**Fees:** As outlined in the attached proposal
**Payment Schedule:** [PAYMENT TERMS]
**Late Payment:** Interest may be charged on overdue amounts
**Expenses:** Client responsible for pre-approved expenses

## 5. Intellectual Property
- Service Provider retains ownership of proprietary methods and tools
- Client receives license to use delivered solutions
- Confidentiality maintained for all client information

## 6. Liability & Warranties
- Service Provider warrants professional service delivery
- Liability limited to the value of services provided
- Both parties maintain appropriate insurance coverage

## 7. Termination
Either party may terminate this agreement with [NOTICE PERIOD] written notice.

${customRequirements ? `\n## 8. Additional Terms\n${customRequirements}` : ''}

**Service Provider:**
${company.name}
${user.firstName} ${user.lastName}, ${user.title}

**Client:**
_________________________
Name & Title

Date: _______________     Date: _______________`;
            }

            generateBusinessReport(customRequirements) {
                const company = appState.companyInfo;
                const stats = appState.stats;

                return `# Business Performance Report
## ${company.name}

**Report Period:** ${new Date().toLocaleDateString()}
**Prepared by:** Maiya AI Assistant

## Executive Summary
This report provides a comprehensive overview of ${company.name}'s current business performance, highlighting key metrics, achievements, and opportunities for growth.

## Current Business Status
**Company Overview:**
- Industry: ${company.industry}
- Years in Operation: ${company.yearsInBusiness}
- Business Size: ${company.size}
- Success Rate: ${company.successRate}%

## Key Performance Metrics
**Financial Performance:**
- Total Revenue: RM ${stats.totalRevenue.toFixed(2)}
- Monthly Revenue: RM ${stats.monthlyRevenue.toFixed(2)}
- Average Quote Value: RM ${stats.totalQuotes > 0 ? (stats.totalRevenue / stats.totalQuotes).toFixed(2) : '0.00'}

**Customer Metrics:**
- Total Customers: ${stats.totalCustomers}
- Active Customers: ${appState.customers.filter(c => c.status === 'active').length}
- Revenue per Customer: RM ${stats.totalCustomers > 0 ? (stats.totalRevenue / stats.totalCustomers).toFixed(2) : '0.00'}

**Sales Performance:**
- Total Quotes Created: ${stats.totalQuotes}
- Quotes Sent: ${appState.quotes.filter(q => q.status === 'sent').length}
- Quote Conversion: ${stats.totalQuotes > 0 ? ((appState.quotes.filter(q => q.status === 'sent').length / stats.totalQuotes) * 100).toFixed(1) : '0'}%

## Analysis & Insights
**Strengths:**
- ${company.successRate}% success rate demonstrates quality service delivery
- ${stats.totalCustomers > 0 ? 'Established customer base' : 'Opportunity to build customer base'}
- ${stats.totalRevenue > 50000 ? 'Strong revenue foundation' : 'Growing revenue potential'}

**Opportunities:**
- ${stats.totalQuotes < 10 ? 'Increase quote generation for revenue growth' : 'Maintain strong quote pipeline'}
- ${stats.totalCustomers < 20 ? 'Expand customer acquisition efforts' : 'Focus on customer retention and upselling'}
- ${stats.monthlyRevenue < stats.totalRevenue * 0.3 ? 'Boost monthly sales activities' : 'Maintain consistent monthly performance'}

## Recommendations
1. **Sales Growth:** ${stats.totalQuotes < 10 ? 'Implement systematic quote generation process' : 'Optimize quote conversion rates'}
2. **Customer Development:** ${stats.totalCustomers < 15 ? 'Focus on customer acquisition strategies' : 'Develop customer loyalty programs'}
3. **Revenue Optimization:** ${stats.monthlyRevenue < 20000 ? 'Increase monthly revenue targets' : 'Maintain revenue momentum'}

${customRequirements ? `\n## Additional Analysis\n${customRequirements}` : ''}

## Conclusion
${company.name} shows ${stats.totalRevenue > 0 ? 'positive business momentum' : 'strong potential for growth'} with opportunities for strategic expansion in the ${company.industry} sector.

---
*This report was generated by Maiya AI Assistant*
*Report Date: ${new Date().toLocaleDateString()}*`;
            }

            generateBusinessLetter(customRequirements) {
                const company = appState.companyInfo;
                const user = appState.userProfile;

                return `${company.name}
${company.address}
${company.phone}
${company.email}

${new Date().toLocaleDateString()}

[Recipient Name]
[Recipient Title]
[Company Name]
[Address]

Dear [Recipient Name / Sir/Madam],

## Professional Business Communication

I hope this letter finds you well. I am writing to you from ${company.name}, where we specialize in ${company.tagline} and have been serving the ${company.industry} industry for ${company.yearsInBusiness} years.

At ${company.name}, we pride ourselves on delivering exceptional service with a ${company.successRate}% success rate. Our team of dedicated professionals has successfully served ${appState.stats.totalCustomers} clients, helping them achieve their business objectives through our comprehensive solutions.

**Our Services Include:**
- Professional consulting and advisory services
- Custom solution development
- Project management and implementation
- Ongoing support and maintenance

We would welcome the opportunity to discuss how ${company.name} can contribute to your business success. Our approach is tailored to each client's unique needs, ensuring that you receive the most effective solutions for your specific requirements.

${customRequirements ? `${customRequirements}\n\n` : ''}

Please feel free to contact us at ${company.phone} or ${company.email} to schedule a consultation. We look forward to the possibility of working together and contributing to your continued success.

Thank you for your time and consideration.

Sincerely,

${user.firstName} ${user.lastName}
${user.title}
${company.name}

---
*This letter was generated by Maiya AI Assistant*`;
            }

            generatePolicyDocument(customRequirements) {
                const company = appState.companyInfo;

                return `# Company Policy Document
## ${company.name}

**Document Type:** Corporate Policy
**Effective Date:** ${new Date().toLocaleDateString()}
**Review Date:** ${new Date(Date.now() + 365*24*60*60*1000).toLocaleDateString()}
**Approved by:** Management Team

## 1. Policy Overview
This document outlines the official policies and procedures for ${company.name}, ensuring consistent operations and professional standards across all business activities.

## 2. Scope
This policy applies to all employees, contractors, and business partners of ${company.name} engaged in ${company.industry} activities.

## 3. Professional Standards
**Quality Commitment:**
- Maintain ${company.successRate}% success rate in all projects
- Deliver services according to industry best practices
- Ensure client satisfaction and professional excellence

**Business Conduct:**
- Maintain confidentiality of all client information
- Adhere to professional ethics and industry standards
- Represent ${company.name} with integrity and professionalism

## 4. Operational Procedures
**Client Management:**
- Follow systematic approach to customer onboarding
- Maintain detailed records of all client interactions
- Ensure timely response to client inquiries and requests

**Project Delivery:**
- Adhere to agreed timelines and specifications
- Conduct regular progress reviews and updates
- Implement quality assurance measures throughout projects

## 5. Communication Standards
**Internal Communication:**
- Regular team meetings and progress updates
- Clear documentation of all decisions and changes
- Professional communication channels and protocols

**External Communication:**
- Professional representation in all client interactions
- Consistent brand messaging and company values
- Timely and accurate information sharing

## 6. Compliance & Responsibilities
**Management Responsibilities:**
- Ensure policy compliance and implementation
- Provide necessary training and resources
- Regular review and update of policies

**Employee Responsibilities:**
- Understand and follow all company policies
- Report any issues or concerns promptly
- Maintain professional standards at all times

${customRequirements ? `\n## 7. Additional Requirements\n${customRequirements}` : ''}

## 8. Policy Review
This policy will be reviewed annually and updated as necessary to reflect business changes and industry developments.

---
**Document Control:**
- Company: ${company.name}
- Industry: ${company.industry}
- Registration: ${company.registration}
- Generated by: Maiya AI Assistant
- Date: ${new Date().toLocaleDateString()}`;
            }

            displayGeneratedDocument(title, content) {
                // Create and show the generated document
                showSuccessMessage(`üìÑ ${title} generated successfully!`);
                
                // You could open a new modal or window here to display the document
                // For now, we'll create a simple alert with the option to download
                const downloadDoc = confirm(`${title} has been generated!\n\nWould you like to download it as a text file?`);
                
                if (downloadDoc) {
                    this.downloadDocument(title, content);
                }
            }

            downloadDocument(title, content) {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${title.replace(/\s+/g, '-').toLowerCase()}-${new Date().toISOString().split('T')[0]}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                
                showSuccessMessage(`üì• ${title} downloaded successfully!`);
            }
        }

        // ===== PRESENTATION GENERATOR =====
        class PresentationGenerator {
            constructor() {
                this.currentPresentation = null;
            }

            generatePresentation() {
                const topic = document.getElementById('presentation-topic').value;
                const audience = document.getElementById('presentation-audience').value;
                const duration = parseInt(document.getElementById('presentation-duration').value);
                const points = document.getElementById('presentation-points').value;
                const style = document.getElementById('presentation-style').value;

                if (!topic.trim()) {
                    showSuccessMessage('‚ùå Please enter a presentation topic!');
                    return;
                }

                showSuccessMessage('üéØ Maiya is creating your presentation...');

                // Simulate AI processing
                setTimeout(() => {
                    const presentation = this.createPresentationContent(topic, audience, duration, points, style);
                    this.displayPresentation(presentation);
                    document.getElementById('export-presentation-btn').style.display = 'inline-flex';
                }, 2000);
            }

            createPresentationContent(topic, audience, duration, points, style) {
                const company = appState.companyInfo;
                const slideCount = Math.max(3, Math.min(10, Math.floor(duration / 3)));
                
                const presentation = {
                    title: topic,
                    audience: audience,
                    duration: duration,
                    style: style,
                    slides: []
                };

                // Title slide
                presentation.slides.push({
                    number: 1,
                    title: topic,
                    content: `**${topic}**\n\nPresented by: ${company.name}\nDate: ${new Date().toLocaleDateString()}\nDuration: ${duration} minutes`,
                    speakerNotes: `Welcome everyone to this presentation on ${topic}. Thank you for your time today. This presentation will take approximately ${duration} minutes and is tailored for ${audience}.`
                });

                // Content slides based on topic and points
                const contentSlides = this.generateContentSlides(topic, points, slideCount - 2, style, audience);
                presentation.slides.push(...contentSlides);

                // Conclusion slide
                presentation.slides.push({
                    number: slideCount,
                    title: "Thank You & Questions",
                    content: `**Key Takeaways:**\n- ${contentSlides.map(slide => slide.title).join('\n- ')}\n\n**Contact Information:**\n${company.name}\n${company.email}\n${company.phone}\n\n**Questions & Discussion**`,
                    speakerNotes: `Thank you for your attention during this presentation. Let me summarize the key points we've covered today. I'd be happy to answer any questions you might have. Please feel free to contact us at ${company.email} for further discussion.`
                });

                return presentation;
            }

            generateContentSlides(topic, points, slideCount, style, audience) {
                const slides = [];
                const company = appState.companyInfo;
                const stats = appState.stats;

                // Generate slides based on topic
                if (topic.toLowerCase().includes('business') || topic.toLowerCase().includes('strategy')) {
                    slides.push({
                        number: 2,
                        title: "Current Business Overview",
                        content: `**${company.name} at a Glance**\n\n‚Ä¢ Industry: ${company.industry}\n‚Ä¢ Years in Operation: ${company.yearsInBusiness}\n‚Ä¢ Success Rate: ${company.successRate}%\n‚Ä¢ Active Customers: ${stats.totalCustomers}\n‚Ä¢ Total Revenue: RM ${stats.totalRevenue.toFixed(2)}`,
                        speakerNotes: "Let me start by giving you an overview of our current business position. We've been operating successfully in the " + company.industry + " industry and have built a strong foundation with our clients."
                    });

                    slides.push({
                        number: 3,
                        title: "Market Opportunity",
                        content: `**Growth Potential**\n\n‚Ä¢ Market Size: Expanding ${company.industry} sector\n‚Ä¢ Target Audience: ${audience}\n‚Ä¢ Competitive Advantage: ${company.tagline}\n‚Ä¢ Revenue Growth: ${stats.monthlyRevenue > 0 ? 'Positive monthly trends' : 'Significant potential'}\n‚Ä¢ Success Metrics: ${company.successRate}% client satisfaction`,
                        speakerNotes: "The market opportunity in our sector is substantial. Our competitive advantage lies in our specialized approach and proven track record of client success."
                    });
                } else if (topic.toLowerCase().includes('financial') || topic.toLowerCase().includes('revenue')) {
                    slides.push({
                        number: 2,
                        title: "Financial Performance",
                        content: `**Revenue Analysis**\n\n‚Ä¢ Total Revenue: RM ${stats.totalRevenue.toFixed(2)}\n‚Ä¢ Monthly Revenue: RM ${stats.monthlyRevenue.toFixed(2)}\n‚Ä¢ Average Quote Value: RM ${stats.totalQuotes > 0 ? (stats.totalRevenue / stats.totalQuotes).toFixed(2) : '0'}\n‚Ä¢ Customer Value: RM ${stats.totalCustomers > 0 ? (stats.totalRevenue / stats.totalCustomers).toFixed(2) : '0'}\n‚Ä¢ Growth Rate: ${stats.monthlyRevenue > 0 ? 'Positive trajectory' : 'Ready for growth'}`,
                        speakerNotes: "Our financial performance demonstrates solid fundamentals with clear opportunities for expansion. Let me walk you through the key metrics."
                    });
                } else if (topic.toLowerCase().includes('customer') || topic.toLowerCase().includes('client')) {
                    slides.push({
                        number: 2,
                        title: "Customer Portfolio",
                        content: `**Client Base Analysis**\n\n‚Ä¢ Total Customers: ${stats.totalCustomers}\n‚Ä¢ Industry Spread: ${[...new Set(appState.customers.map(c => c.industry))].join(', ')}\n‚Ä¢ Success Rate: ${company.successRate}%\n‚Ä¢ Retention: High customer satisfaction\n‚Ä¢ Growth Potential: Expanding market reach`,
                        speakerNotes: "Our customer portfolio reflects diversity and strong relationships across multiple industries. This foundation provides excellent growth opportunities."
                    });
                }

                // Add custom points if provided
                if (points && points.trim()) {
                    const customPoints = points.split('\n').filter(p => p.trim());
                    customPoints.forEach((point, index) => {
                        if (slides.length < slideCount) {
                            slides.push({
                                number: slides.length + 2,
                                title: point.substring(0, 50) + (point.length > 50 ? '...' : ''),
                                content: `**${point}**\n\n‚Ä¢ Key benefits and advantages\n‚Ä¢ Implementation strategy\n‚Ä¢ Expected outcomes\n‚Ä¢ Next steps and timeline`,
                                speakerNotes: `Now let's discuss ${point}. This is a crucial aspect of our ${topic.toLowerCase()} that will significantly impact our success.`
                            });
                        }
                    });
                }

                // Fill remaining slides with general content
                while (slides.length < slideCount) {
                    const slideNum = slides.length + 2;
                    slides.push({
                        number: slideNum,
                        title: `Strategic Initiative ${slideNum - 1}`,
                        content: `**Implementation Plan**\n\n‚Ä¢ Objective: Support ${topic}\n‚Ä¢ Timeline: Phased approach\n‚Ä¢ Resources: Dedicated team\n‚Ä¢ Metrics: Measurable outcomes\n‚Ä¢ Success Factors: ${company.tagline}`,
                        speakerNotes: `This strategic initiative directly supports our ${topic} objectives and aligns with our company's core competencies.`
                    });
                }

                return slides.slice(0, slideCount);
            }

            displayPresentation(presentation) {
                this.currentPresentation = presentation;
                const previewDiv = document.getElementById('presentation-preview');
                const slidesDiv = document.getElementById('presentation-slides');

                slidesDiv.innerHTML = presentation.slides.map(slide => `
                    <div class="presentation-slide">
                        <div class="slide-header">
                            <div class="slide-number">Slide ${slide.number}</div>
                            <h4 style="color: var(--text-primary); margin: 0;">${slide.title}</h4>
                        </div>
                        <div class="slide-content">
                            <div style="white-space: pre-line; color: var(--text-primary); margin-bottom: 16px;">
                                ${slide.content}
                            </div>
                            <div style="background: var(--bg-secondary); padding: 12px; border-radius: 8px;">
                                <strong style="color: var(--accent-primary);">üé§ Speaker Notes:</strong>
                                <div style="color: var(--text-muted); font-style: italic; margin-top: 8px;">
                                    ${slide.speakerNotes}
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');

                previewDiv.style.display = 'block';
                showSuccessMessage(`üéØ Presentation "${presentation.title}" created with ${presentation.slides.length} slides!`);
            }

            exportPresentation() {
                if (!this.currentPresentation) {
                    showSuccessMessage('‚ùå No presentation to export!');
                    return;
                }

                const content = this.formatPresentationForExport(this.currentPresentation);
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.currentPresentation.title.replace(/\s+/g, '-').toLowerCase()}-presentation.txt`;
                a.click();
                URL.revokeObjectURL(url);
                
                showSuccessMessage('üì§ Presentation exported successfully!');
            }

            formatPresentationForExport(presentation) {
                return `# ${presentation.title}
**Audience:** ${presentation.audience}
**Duration:** ${presentation.duration} minutes
**Style:** ${presentation.style}
**Generated by:** Maiya AI Assistant
**Date:** ${new Date().toLocaleDateString()}

---

${presentation.slides.map(slide => `
## Slide ${slide.number}: ${slide.title}

### Content:
${slide.content}

### Speaker Notes:
${slide.speakerNotes}

---`).join('\n')}

## Presentation Complete

Thank you for using Maiya AI Assistant for your presentation needs!`;
            }
        }

        // ===== APPLICATION STATE (Enhanced with Maiya) =====
        let appState = {
            currentTheme: 'red',
            currentMode: 'light',
            currentView: 'dashboard',
            
            // Edit states
            editingQuote: null,
            editingCustomer: null,
            
            // Confirmation dialog state
            confirmCallback: null,
            
            // Maiya AI state
            maiyaChatOpen: false,
            
            // Business Data
            userProfile: {
                firstName: 'John',
                lastName: 'Doe',
                title: 'Business Owner',
                email: 'john@company.com',
                phone: '+60 12-345 6789',
                address: '123 Business Street, Kuala Lumpur 50000'
            },
            
            companyInfo: {
                name: 'Your Company Name',
                tagline: 'Professional Services',
                logo: 'üåÖ',
                registration: '12345678-K',
                taxId: '000123456789',
                email: 'info@company.com',
                phone: '+60 3-1234 5678',
                website: 'https://www.company.com',
                address: '123 Business Avenue\nKuala Lumpur 50000\nMalaysia',
                industry: 'technology',
                size: '1-10',
                description: 'A leading technology company providing innovative solutions.',
                yearsInBusiness: 3,
                successRate: 95
            },
            
            customers: [
                {
                    id: 1,
                    company: 'ABC Corporation',
                    contact: 'Jane Smith',
                    email: 'jane@abc.com',
                    phone: '+60 12-987 6543',
                    address: '456 Client Street, Shah Alam 40000',
                    industry: 'retail',
                    type: 'business',
                    notes: 'Great long-term client',
                    createdAt: new Date('2024-01-15'),
                    status: 'active'
                },
                {
                    id: 2,
                    company: 'XYZ Solutions',
                    contact: 'Bob Johnson',
                    email: 'bob@xyz.com',
                    phone: '+60 11-234 5678',
                    address: '789 Business Plaza, Petaling Jaya 47800',
                    industry: 'technology',
                    type: 'business',
                    notes: 'Tech startup, fast growing',
                    createdAt: new Date('2024-02-20'),
                    status: 'active'
                }
            ],
            
            quotes: [
                {
                    id: 1,
                    number: 'QT-2024-001',
                    customerId: 1,
                    date: '2024-06-20',
                    validUntil: '2024-07-20',
                    description: 'Website Development Project',
                    items: [
                        { description: 'Homepage Design', quantity: 1, price: 2500 },
                        { description: 'Backend Development', quantity: 1, price: 3500 }
                    ],
                    taxRate: 6,
                    status: 'sent',
                    subtotal: 6000,
                    tax: 360,
                    total: 6360,
                    createdAt: new Date('2024-06-20')
                },
                {
                    id: 2,
                    number: 'QT-2024-002',
                    customerId: 2,
                    date: '2024-06-22',
                    validUntil: '2024-07-22',
                    description: 'Mobile App Development',
                    items: [
                        { description: 'iOS App Development', quantity: 1, price: 8000 },
                        { description: 'Android App Development', quantity: 1, price: 7500 }
                    ],
                    taxRate: 6,
                    status: 'draft',
                    subtotal: 15500,
                    tax: 930,
                    total: 16430,
                    createdAt: new Date('2024-06-22')
                }
            ],
            
            // Statistics
            stats: {
                totalQuotes: 2,
                totalCustomers: 2,
                monthlyRevenue: 16430,
                totalRevenue: 22790
            }
        };

        // ===== INITIALIZE MAIYA AI =====
        let maiyaAI, documentGenerator, presentationGenerator;

        // ===== MAIYA AI FUNCTIONS =====
        function toggleMaiyaChat() {
            const chat = document.getElementById('maiya-chat');
            appState.maiyaChatOpen = !appState.maiyaChatOpen;
            
            if (appState.maiyaChatOpen) {
                chat.classList.add('show');
                document.getElementById('maiya-input').focus();
            } else {
                chat.classList.remove('show');
            }
        }

        function closeMaiyaChat() {
            document.getElementById('maiya-chat').classList.remove('show');
            appState.maiyaChatOpen = false;
        }

        function handleMaiyaKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMaiyaMessage();
            }
        }

        function sendMaiyaMessage() {
            const input = document.getElementById('maiya-input');
            const message = input.value.trim();
            if (message) {
                maiyaAI.sendMessage(message);
            }
        }

        function toggleVoiceInput() {
            if (maiyaAI.isListening) {
                maiyaAI.stopVoiceInput();
            } else {
                maiyaAI.startVoiceInput();
            }
        }

        function clearMaiyaHistory() {
            maiyaAI.clearHistory();
        }

        function exportMaiyaChat() {
            maiyaAI.exportChatHistory();
        }

        // ===== MAIYA AI INTEGRATION FUNCTIONS =====
        function askMaiyaAboutCompany() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Tell me about my company's current status and provide insights for improvement");
            }, 500);
        }

        function askMaiyaForAnalysis() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Analyze my business performance and revenue trends. What insights can you provide?");
            }, 500);
        }

        function askMaiyaForInsights() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Analyze my recent business activity and provide actionable insights");
            }, 500);
        }

        function askMaiyaAboutQuotes() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Analyze my quotes performance and suggest improvements for better conversion");
            }, 500);
        }

        function askMaiyaAboutCustomers() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Provide insights about my customer base and suggest strategies for growth");
            }, 500);
        }

        // ===== DOCUMENT GENERATOR FUNCTIONS =====
        function openDocumentGenerator() {
            openModal('doc-gen-modal');
        }

        function selectDocTemplate(templateId) {
            documentGenerator.selectTemplate(templateId);
        }

        function generateDocument() {
            documentGenerator.generateDocument();
        }

        // ===== PRESENTATION GENERATOR FUNCTIONS =====
        function openPresentationGenerator() {
            openModal('presentation-modal');
        }

        function generatePresentation() {
            presentationGenerator.generatePresentation();
        }

        function exportPresentation() {
            presentationGenerator.exportPresentation();
        }

        // ===== MAIYA VIEW FUNCTIONS =====
        function startBusinessAnalysis() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Provide a comprehensive business analysis with actionable recommendations");
            }, 500);
        }

        function startMarketingHelp() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Help me create a marketing strategy for my business. What should I focus on?");
            }, 500);
        }

        function startFinancialHelp() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Provide financial planning advice and budget recommendations for my business");
            }, 500);
        }

        function startGeneralHelp() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("I need general business advice. What areas should I focus on for growth?");
            }, 500);
        }

        function generateBusinessPlan() {
            documentGenerator.selectTemplate('business-plan');
            generateDocument();
        }

        function generateMarketingStrategy() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("Create a comprehensive marketing strategy document for my business including digital marketing, content strategy, and customer acquisition plans");
            }, 500);
        }

        function generateSalesProposal() {
            documentGenerator.selectTemplate('proposal');
            generateDocument();
        }

        function generatePitchDeck() {
            document.getElementById('presentation-topic').value = 'Business Pitch Deck';
            document.getElementById('presentation-audience').value = 'executives';
            document.getElementById('presentation-duration').value = '15';
            document.getElementById('presentation-points').value = 'Company Overview\nMarket Opportunity\nBusiness Model\nFinancial Projections\nInvestment Ask';
            openPresentationGenerator();
        }

        function generateFinancialReport() {
            documentGenerator.selectTemplate('report');
            generateDocument();
        }

        function generateCustomDocument() {
            toggleMaiyaChat();
            setTimeout(() => {
                maiyaAI.sendMessage("I need help creating a custom business document. What type of document would you like to create?");
            }, 500);
        }

        // ===== MAIYA SETTINGS FUNCTIONS =====
        function resetMaiyaSettings() {
            clearMaiyaHistory();
            showSuccessMessage('ü§ñ Maiya AI settings reset to defaults!');
        }

        function toggleVoiceSettings() {
            if (maiyaAI.voiceEnabled) {
                showSuccessMessage('üó£Ô∏è Voice input is enabled in your browser');
            } else {
                showSuccessMessage('‚ùå Voice input not supported in your browser');
            }
        }

        function adjustAILevel() {
            showSuccessMessage('üéØ AI assistance level: Advanced Business Mode active');
        }

        // ===== THEME MANAGEMENT (Enhanced) =====
        const themes = {
            red: { name: 'Coral Sunset', icon: 'üåÖ' },
            orange: { name: 'Peach Glow', icon: 'üçë' },
            pink: { name: 'Rose Blush', icon: 'üå∏' },
            yellow: { name: 'Butter Cream', icon: 'üåª' },
            bluegreen: { name: 'Mint Breeze', icon: 'üåä' },
            purplegrey: { name: 'Lavender Mist', icon: 'üíú' },
            browngrey: { name: 'Warm Taupe', icon: 'ü§é' },
            greenbrown: { name: 'Sage Olive', icon: 'üåø' }
        };

        function switchToTheme(theme) {
            appState.currentTheme = theme;
            document.body.setAttribute('data-theme', theme);
            
            // Update theme display elements
            document.getElementById('current-theme-icon').textContent = themes[theme].icon;
            document.getElementById('app-logo').textContent = themes[theme].icon;
            document.getElementById('company-logo').textContent = themes[theme].icon;
            document.getElementById('current-theme-name').textContent = themes[theme].name;
            
            // Update company logo in state
            appState.companyInfo.logo = themes[theme].icon;
            
            showSuccessMessage(`‚ú® Theme changed to ${themes[theme].name}!`);
            updateDisplay();
            saveToLocalStorage();
        }

        function randomTheme() {
            const themeKeys = Object.keys(themes);
            const randomTheme = themeKeys[Math.floor(Math.random() * themeKeys.length)];
            switchToTheme(randomTheme);
        }

        function toggleMode() {
            const newMode = appState.currentMode === 'light' ? 'dark' : 'light';
            appState.currentMode = newMode;
            document.body.setAttribute('data-mode', newMode);
            
            // Update mode toggle buttons
            const modeText = newMode === 'light' ? 'Darker' : 'Lighter';
            const modeIcon = newMode === 'light' ? 'üåë' : 'üåû';
            
            document.getElementById('mode-toggle').innerHTML = `${modeIcon} ${modeText}`;
            
            showSuccessMessage(`üåô Switched to ${newMode === 'light' ? 'Standard' : 'Dark'} mode!`);
            saveToLocalStorage();
        }

        function openThemePicker() {
            // Implementation would be added here
            showSuccessMessage('üé® Theme picker functionality would be implemented here');
        }

        function closeThemePicker() {
            // Implementation would be added here
        }

        // ===== VIEW MANAGEMENT (Enhanced) =====
        function showView(viewName) {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.add('hidden');
            });
            
            // Show selected view
            document.getElementById(`${viewName}-view`).classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the correct nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                const itemText = item.textContent.toLowerCase();
                if (itemText.includes(viewName.toLowerCase()) || 
                    (viewName === 'dashboard' && itemText.includes('home'))) {
                    item.classList.add('active');
                }
            });
            
            appState.currentView = viewName;
            
            // Load view-specific data
            if (viewName === 'quotes') {
                loadQuotesList();
            } else if (viewName === 'customers') {
                loadCustomersList();
            } else if (viewName === 'dashboard') {
                loadDashboard();
            } else if (viewName === 'maiya') {
                loadMaiyaView();
            } else if (viewName === 'settings') {
                updateStorageInfo();
            }
            
            saveToLocalStorage();
        }

        function loadMaiyaView() {
            // Load Maiya-specific content
            updateChatHistoryDisplay();
        }

        function updateChatHistoryDisplay() {
            const historyDiv = document.getElementById('maiya-chat-history');
            if (maiyaAI.chatHistory.length === 0) {
                historyDiv.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí¨</div>
                        <h3>No conversations yet</h3>
                        <p>Start chatting with Maiya to see your conversation history here!</p>
                        <button class="btn btn-primary" onclick="toggleMaiyaChat()" style="margin-top: 16px;">
                            ü§ñ Start Conversation
                        </button>
                    </div>
                `;
                return;
            }

            // Group conversations by date
            const conversations = {};
            maiyaAI.chatHistory.forEach(msg => {
                const date = msg.timestamp.toDateString();
                if (!conversations[date]) {
                    conversations[date] = [];
                }
                conversations[date].push(msg);
            });

            historyDiv.innerHTML = Object.entries(conversations).map(([date, messages]) => `
                <div class="data-item">
                    <div class="data-item-header">
                        <div class="data-item-title">üí¨ Conversation - ${date}</div>
                        <div class="data-item-amount">${messages.length} messages</div>
                    </div>
                    <div class="data-item-details">
                        Last message: ${messages[messages.length - 1].message.substring(0, 100)}${messages[messages.length - 1].message.length > 100 ? '...' : ''}
                    </div>
                    <div class="data-item-meta">
                        <div class="data-item-date">${messages[messages.length - 1].timestamp.toLocaleTimeString()}</div>
                        <div class="data-item-status status-active">ACTIVE</div>
                    </div>
                    <div class="data-item-actions">
                        <button class="edit-btn" onclick="resumeConversation('${date}')">
                            üí¨ Resume
                        </button>
                        <button class="edit-btn" onclick="deleteConversation('${date}')" style="background: var(--error);">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function resumeConversation(date) {
            toggleMaiyaChat();
            showSuccessMessage(`üí¨ Resuming conversation from ${date}`);
        }

        function deleteConversation(date) {
            // Filter out messages from that date
            maiyaAI.chatHistory = maiyaAI.chatHistory.filter(msg => msg.timestamp.toDateString() !== date);
            maiyaAI.saveChatHistory();
            updateChatHistoryDisplay();
            showSuccessMessage('üóëÔ∏è Conversation deleted');
        }

        // ===== MODAL MANAGEMENT =====
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // ===== SUCCESS MESSAGE =====
        function showSuccessMessage(message) {
            const successMsg = document.getElementById('success-message');
            const successText = document.getElementById('success-text');
            successText.textContent = message;
            successMsg.classList.add('show');
            
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 3000);
        }

        // ===== PLACEHOLDER FUNCTIONS (Would be implemented from original) =====
        function editProfile() { showSuccessMessage('üë§ Profile editing would be implemented'); }
        function showProfile() { editProfile(); }
        function editCompany() { showSuccessMessage('üè¢ Company editing would be implemented'); }
        function openCompanyManager() { showSuccessMessage('üè¢ Company manager would be implemented'); }
        function createQuote() { showSuccessMessage('üìã Quote creation would be implemented'); }
        function addCustomer() { showSuccessMessage('üë• Customer addition would be implemented'); }
        function exportData() { showSuccessMessage('üì§ Data export would be implemented'); }
        function showHelp() { showSuccessMessage('‚ùì Help system would be implemented'); }
        function loadQuotesList() { showSuccessMessage('üìã Loading quotes...'); }
        function loadCustomersList() { showSuccessMessage('üë• Loading customers...'); }
        function loadDashboard() { updateStats(); }
        function updateStorageInfo() { showSuccessMessage('üíæ Storage info updated'); }
        function saveToLocalStorage() { 
            try {
                localStorage.setItem('refit-maiya-data', JSON.stringify({
                    appState: appState,
                    maiyaHistory: maiyaAI ? maiyaAI.chatHistory : []
                }));
            } catch (error) {
                console.warn('Failed to save to localStorage:', error);
            }
        }
        function updateDisplay() { updateStats(); }
        function viewReports() { showSuccessMessage('üìä Reports would be implemented'); }

        // ===== STATS MANAGEMENT =====
        function updateStats() {
            appState.stats.totalQuotes = appState.quotes.length;
            appState.stats.totalCustomers = appState.customers.length;
            appState.stats.totalRevenue = appState.quotes.reduce((sum, quote) => sum + quote.total, 0);
            appState.stats.monthlyRevenue = appState.quotes
                .filter(quote => {
                    const quoteDate = new Date(quote.createdAt);
                    const now = new Date();
                    return quoteDate.getMonth() === now.getMonth() && 
                           quoteDate.getFullYear() === now.getFullYear();
                })
                .reduce((sum, quote) => sum + quote.total, 0);
            
            document.getElementById('total-quotes-count').textContent = appState.stats.totalQuotes;
            document.getElementById('total-customers-count').textContent = appState.stats.totalCustomers;
            document.getElementById('monthly-revenue').textContent = `RM ${appState.stats.monthlyRevenue.toFixed(2)}`;
            document.getElementById('total-revenue').textContent = `RM ${appState.stats.totalRevenue.toFixed(2)}`;
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ü§ñ REFIT Business System v3.0.0 with Maiya AI Starting...');
            
            // Initialize AI systems
            maiyaAI = new MaiyaAI();
            documentGenerator = new DocumentGenerator();
            presentationGenerator = new PresentationGenerator();
            
            // Load saved data
            try {
                const saved = localStorage.getItem('refit-maiya-data');
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.appState) {
                        appState = { ...appState, ...data.appState };
                    }
                    if (data.maiyaHistory) {
                        maiyaAI.chatHistory = data.maiyaHistory;
                    }
                }
            } catch (error) {
                console.warn('Failed to load saved data:', error);
            }
            
            // Load chat history
            maiyaAI.loadChatHistory();
            
            // Initialize the app
            updateDisplay();
            loadDashboard();
            
            // Update time
            function updateTime() {
                const now = new Date();
                const time = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                });
                document.getElementById('status-time').textContent = time;
            }
            updateTime();
            setInterval(updateTime, 60000);
            
            // Auto-save every 30 seconds
            setInterval(saveToLocalStorage, 30000);
            
            // Show welcome message
            setTimeout(() => {
                showSuccessMessage('ü§ñ Welcome to REFIT with Maiya AI! Your intelligent business assistant is ready!');
                
                // Show Maiya intro after 3 seconds
                setTimeout(() => {
                    showSuccessMessage('üí° Tip: Click the ü§ñ button to chat with Maiya for business help!');
                }, 3000);
            }, 1000);
            
            console.log('‚úÖ REFIT with Maiya AI loaded successfully!');
            console.log('ü§ñ Maiya AI capabilities:');
            console.log('   üìä Business analysis and insights');
            console.log('   üìÑ Document generation (proposals, contracts, reports)');
            console.log('   üéØ Presentation creation with speaker notes');
            console.log('   üó£Ô∏è Voice input support');
            console.log('   üí¨ Conversational business assistance');
        });

        // Make functions globally accessible
        window.toggleMaiyaChat = toggleMaiyaChat;
        window.closeMaiyaChat = closeMaiyaChat;
        window.sendMaiyaMessage = sendMaiyaMessage;
        window.toggleVoiceInput = toggleVoiceInput;
        window.handleMaiyaKeyPress = handleMaiyaKeyPress;
        window.clearMaiyaHistory = clearMaiyaHistory;
        window.exportMaiyaChat = exportMaiyaChat;
        window.askMaiyaAboutCompany = askMaiyaAboutCompany;
        window.askMaiyaForAnalysis = askMaiyaForAnalysis;
        window.askMaiyaForInsights = askMaiyaForInsights;
        window.askMaiyaAboutQuotes = askMaiyaAboutQuotes;
        window.askMaiyaAboutCustomers = askMaiyaAboutCustomers;
        window.openDocumentGenerator = openDocumentGenerator;
        window.selectDocTemplate = selectDocTemplate;
        window.generateDocument = generateDocument;
        window.openPresentationGenerator = openPresentationGenerator;
        window.generatePresentation = generatePresentation;
        window.exportPresentation = exportPresentation;
        window.startBusinessAnalysis = startBusinessAnalysis;
        window.startMarketingHelp = startMarketingHelp;
        window.startFinancialHelp = startFinancialHelp;
        window.startGeneralHelp = startGeneralHelp;
        window.generateBusinessPlan = generateBusinessPlan;
        window.generateMarketingStrategy = generateMarketingStrategy;
        window.generateSalesProposal = generateSalesProposal;
        window.generatePitchDeck = generatePitchDeck;
        window.generateFinancialReport = generateFinancialReport;
        window.generateCustomDocument = generateCustomDocument;
        window.showView = showView;
        window.switchToTheme = switchToTheme;
        window.randomTheme = randomTheme;
        window.toggleMode = toggleMode;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.showSuccessMessage = showSuccessMessage;
        window.editProfile = editProfile;
        window.showProfile = showProfile;
        window.editCompany = editCompany;
        window.openCompanyManager = openCompanyManager;
        window.createQuote = createQuote;
        window.addCustomer = addCustomer;
        window.exportData = exportData;
        window.showHelp = showHelp;
        window.viewReports = viewReports;
        window.resumeConversation = resumeConversation;
        window.deleteConversation = deleteConversation;

    </script>
</body>
</html>
