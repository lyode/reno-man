<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="REFIT MAINTENANCE SERVICES">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#fb923c">
    <meta name="msapplication-navbutton-color" content="#fb923c">
    
    <title>REFIT MAINTENANCE SERVICES - AI Voice Assistant</title>
    
    <!-- Enhanced PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        input, select, textarea, button {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        :root {
            /* Light Theme - Warm & Eye-Friendly with Beautiful Pastel Orange */
            --bg-primary: #fef7ed;
            --bg-secondary: #fed7aa;
            --bg-card: #ffffff;
            --bg-card-hover: #fef7ed;
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --accent-primary: #fb923c;
            --accent-secondary: #fed7aa;
            --accent-warm: #f59e0b;
            --accent-soft: #fde68a;
            --border-color: #fde68a;
            --shadow-light: rgba(251, 146, 60, 0.1);
            --shadow-medium: rgba(251, 146, 60, 0.2);
            --shadow-strong: rgba(251, 146, 60, 0.3);
            --overlay: rgba(45, 55, 72, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            /* AI Assistant Colors */
            --ai-primary: #ff6b9d;
            --ai-secondary: #c44569;
            --ai-soft: #ffa8cc;
            --ai-background: rgba(255, 107, 157, 0.1);
            
            /* Enhanced Category Colors with Orange Harmony */
            --cat-electrical: #6366f1;
            --cat-plumbing: #06b6d4;
            --cat-hvac: #8b5cf6;
            --cat-cleaning: #10b981;
            --cat-parts: #f59e0b;
            --cat-labor: #ef4444;
            --cat-equipment: #6b7280;
            --cat-common: #a855f7;
            --cat-preliminary: #fb923c;
            --cat-wall: #f97316;
            --cat-floor: #a78bfa;
            --cat-ceiling: #60a5fa;
            --cat-roofing: #4f46e5;
            --cat-wetwork: #0891b2;
            --cat-me-work: #f87171;
            --cat-exhaust: #52525b;
            --cat-lights-fan: #eab308;
            --cat-ac: #14b8a6;
            --cat-paint: #ea580c;
            --cat-curtain: #c084fc;
            --cat-builtin: #818cf8;
            --cat-loose: #4ade80;
            --cat-sanitary: #3b82f6;
            --cat-appliances: #fb7185;
        }
        
        [data-theme="dark"] {
            /* Dark Theme - Reduced Blue Light with Pastel Orange */
            --bg-primary: #2c1810;
            --bg-secondary: #451f0f;
            --bg-card: #5c2e1a;
            --bg-card-hover: #6b3521;
            --text-primary: #fdf7ed;
            --text-secondary: #e4c7a8;
            --text-muted: #c4a072;
            --accent-primary: #fb923c;
            --accent-secondary: #fed7aa;
            --accent-warm: #f59e0b;
            --accent-soft: #fde68a;
            --border-color: #7c3f1e;
            --shadow-light: rgba(251, 146, 60, 0.1);
            --shadow-medium: rgba(251, 146, 60, 0.2);
            --shadow-strong: rgba(251, 146, 60, 0.3);
            --overlay: rgba(0, 0, 0, 0.9);
            --success: #10b981;
            --warning: #fbbf24;
            --error: #f87171;
            --info: #60a5fa;
            
            /* AI Assistant Dark Mode */
            --ai-primary: #ff6b9d;
            --ai-secondary: #c44569;
            --ai-soft: #ffa8cc;
            --ai-background: rgba(255, 107, 157, 0.15);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            font-size: 16px;
            line-height: 1.6;
            transition: all 0.3s ease;
        }
        
        /* Mobile Layout Container */
        .mobile-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--bg-primary);
        }
        
        /* Status Bar */
        .status-bar {
            height: 44px;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: 0 2px 10px var(--shadow-medium);
            border-bottom: 1px solid var(--border-color);
        }
        
        .status-bar .time {
            color: var(--text-primary);
        }
        
        .status-bar .indicators {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
        }
        
        .theme-toggle {
            background: var(--accent-primary);
            border: none;
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .theme-toggle:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        /* Header */
        .header {
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 44px;
            left: 0;
            right: 0;
            z-index: 90;
            box-shadow: 0 4px 20px var(--shadow-medium);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .app-logo {
            width: 54px;
            height: 54px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 25px var(--shadow-medium);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .app-logo:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px var(--shadow-strong);
        }
        
        .app-logo:active {
            transform: scale(0.95);
        }
        
        .logo-svg {
            width: 32px;
            height: 32px;
            filter: drop-shadow(0 2px 4px var(--shadow-light));
        }
        
        .app-title h1 {
            font-size: 18px;
            font-weight: 700;
            line-height: 1.1;
            letter-spacing: -0.5px;
            margin-bottom: 2px;
            color: var(--text-primary);
        }
        
        .app-title p {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            line-height: 1.2;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 18px;
            box-shadow: 0 4px 15px var(--shadow-medium);
            position: relative;
        }
        
        .header-btn:active {
            transform: scale(0.9);
        }
        
        .header-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        /* Enhanced Branding Insert Button */
        .branding-insert-btn {
            background: linear-gradient(135deg, #ff8c42, #ff6b35) !important;
            position: relative;
            overflow: hidden;
        }
        
        .branding-insert-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .branding-insert-btn:hover::before {
            left: 100%;
        }
        
        /* AI Assistant Button */
        .ai-assistant-btn {
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary)) !important;
            position: relative;
            overflow: hidden;
        }
        
        .ai-assistant-btn.active {
            background: linear-gradient(135deg, var(--ai-secondary), var(--ai-primary)) !important;
            animation: aiPulse 2s infinite;
        }
        
        @keyframes aiPulse {
            0%, 100% { box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3); }
            50% { box-shadow: 0 4px 25px rgba(255, 107, 157, 0.6); }
        }
        
        .ai-assistant-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .ai-assistant-btn:hover::before {
            left: 100%;
        }
        
        /* AI Assistant Interface */
        .ai-assistant-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100vh;
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-left: 1px solid var(--border-color);
            box-shadow: -8px 0 40px var(--shadow-strong);
            transition: right 0.3s ease;
            z-index: 150;
            display: flex;
            flex-direction: column;
        }
        
        .ai-assistant-panel.active {
            right: 0;
        }
        
        .ai-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .ai-character {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .ai-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            animation: avatarFloat 3s ease-in-out infinite;
        }
        
        @keyframes avatarFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .ai-info h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .ai-info p {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .ai-close {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .ai-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .ai-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .ai-chat {
            flex: 1;
            margin-bottom: 20px;
        }
        
        .ai-message {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 90%;
            animation: messageSlide 0.3s ease;
        }
        
        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .ai-message.assistant {
            background: var(--ai-background);
            color: var(--text-primary);
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }
        
        .ai-message.user {
            background: var(--accent-primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .ai-input-container {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .ai-input {
            flex: 1;
            padding: 12px 16px;
            border-radius: 20px;
            border: 2px solid var(--border-color);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .ai-input:focus {
            outline: none;
            border-color: var(--ai-primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.15);
        }
        
        .ai-send {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .ai-send:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
        }
        
        .ai-voice-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .ai-voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        .ai-voice-btn.listening {
            background: linear-gradient(135deg, var(--error), #f87171);
            animation: voicePulse 1s infinite;
        }
        
        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* AI Character Selection */
        .ai-character-selection {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
            backdrop-filter: blur(10px);
        }
        
        .ai-character-selection.show {
            display: flex;
        }
        
        .character-modal {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 32px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalPop 0.3s ease;
        }
        
        @keyframes modalPop {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .character-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .character-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px var(--shadow-medium);
            border-color: var(--ai-primary);
        }
        
        .character-card.selected {
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            color: white;
            transform: scale(1.05);
        }
        
        .character-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .character-card.selected .character-avatar {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .character-name {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .character-trait {
            font-size: 11px;
            opacity: 0.8;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 130px 20px 140px;
            -webkit-overflow-scrolling: touch;
            position: relative;
            height: calc(100vh - 44px);
            scroll-behavior: smooth;
            transition: margin-right 0.3s ease;
        }
        
        .main-content.ai-active {
            margin-right: 350px;
        }
        
        .main-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 3px;
        }
        
        /* Category System */
        .category-badge {
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: white;
            display: inline-block;
            margin-right: 6px;
        }
        
        /* Enhanced Category Classes */
        .category-electrical { background: var(--cat-electrical); }
        .category-plumbing { background: var(--cat-plumbing); }
        .category-hvac { background: var(--cat-hvac); }
        .category-cleaning { background: var(--cat-cleaning); }
        .category-parts { background: var(--cat-parts); }
        .category-labor { background: var(--cat-labor); }
        .category-equipment { background: var(--cat-equipment); }
        .category-common { background: var(--cat-common); }
        .category-preliminary { background: var(--cat-preliminary); }
        .category-wall { background: var(--cat-wall); }
        .category-floor { background: var(--cat-floor); }
        .category-ceiling { background: var(--cat-ceiling); }
        .category-roofing { background: var(--cat-roofing); }
        .category-wetwork { background: var(--cat-wetwork); }
        .category-me-work { background: var(--cat-me-work); }
        .category-exhaust { background: var(--cat-exhaust); }
        .category-lights-fan { background: var(--cat-lights-fan); }
        .category-ac { background: var(--cat-ac); }
        .category-paint { background: var(--cat-paint); }
        .category-curtain { background: var(--cat-curtain); }
        .category-builtin { background: var(--cat-builtin); }
        .category-loose { background: var(--cat-loose); }
        .category-sanitary { background: var(--cat-sanitary); }
        .category-appliances { background: var(--cat-appliances); }
        
        /* Cards */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
            transition: all 0.2s ease;
        }
        
        .card:hover {
            box-shadow: 0 12px 40px var(--shadow-medium);
            transform: translateY(-2px);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 18px;
            padding: 20px 16px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 16px var(--shadow-light);
            transition: all 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            line-height: 1;
            color: var(--accent-primary);
            text-shadow: 0 2px 4px var(--shadow-light);
        }
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px 24px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 52px;
            text-decoration: none;
            box-shadow: 0 4px 12px var(--shadow-light);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        
        .btn:active {
            transform: scale(0.96);
        }
        
        .btn-primary { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            box-shadow: 0 4px 15px var(--shadow-medium);
        }
        .btn-success { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            box-shadow: 0 4px 15px var(--shadow-medium);
        }
        .btn-danger { 
            background: linear-gradient(135deg, var(--error), #f87171); 
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
        }
        .btn-warning { 
            background: linear-gradient(135deg, var(--warning), #fed7aa); 
            box-shadow: 0 4px 15px rgba(251, 146, 60, 0.3);
        }
        .btn-info { 
            background: linear-gradient(135deg, var(--info), #fed7aa); 
            box-shadow: 0 4px 15px rgba(251, 146, 60, 0.3);
        }
        .btn-soft { 
            background: linear-gradient(135deg, var(--accent-soft), #fecaca); 
            box-shadow: 0 4px 15px rgba(253, 230, 138, 0.3);
        }
        .btn-warm { 
            background: linear-gradient(135deg, var(--accent-warm), #fed7aa); 
            box-shadow: 0 4px 15px rgba(251, 146, 60, 0.3);
        }
        .btn-secondary { 
            background: linear-gradient(135deg, var(--text-secondary), #9ca3af); 
            box-shadow: 0 4px 15px rgba(75, 85, 99, 0.3);
        }
        
        /* Action Buttons */
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        .action-btn {
            padding: 24px 20px;
            border-radius: 20px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            transition: all 0.2s ease;
            cursor: pointer;
            min-height: 120px;
            box-shadow: 0 6px 20px var(--shadow-light);
        }
        
        .action-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px var(--shadow-medium);
        }
        
        .action-btn:active {
            transform: scale(0.96);
        }
        
        .action-btn.primary { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        .action-btn.success { 
            background: linear-gradient(135deg, var(--success), #34d399); 
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        .action-btn.warm { 
            background: linear-gradient(135deg, var(--accent-warm), #fed7aa); 
            box-shadow: 0 8px 25px rgba(251, 158, 11, 0.3);
        }
        .action-btn.soft { 
            background: linear-gradient(135deg, var(--accent-soft), #e9d5ff); 
            box-shadow: 0 8px 25px rgba(253, 230, 138, 0.3);
        }
        .action-btn.info { 
            background: linear-gradient(135deg, var(--info), #60a5fa); 
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
        .action-btn.secondary { 
            background: linear-gradient(135deg, var(--text-secondary), #9ca3af); 
            box-shadow: 0 8px 25px rgba(75, 85, 99, 0.3);
        }
        .action-btn.branding {
            background: linear-gradient(135deg, #ff8c42, #ff6b35);
            box-shadow: 0 8px 25px rgba(255, 140, 66, 0.4);
        }
        .action-btn.ai-assistant {
            background: linear-gradient(135deg, var(--ai-primary), var(--ai-secondary));
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
        }
        
        .action-btn .icon {
            font-size: 32px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        /* Form Elements */
        .input {
            width: 100%;
            padding: 18px 20px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            transition: all 0.2s ease;
        }
        
        .input::placeholder {
            color: var(--text-muted);
        }
        
        .input:focus {
            outline: none;
            background: var(--bg-card);
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.15);
        }
        
        /* Search Input */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            color: var(--text-muted);
            pointer-events: none;
        }
        
        .search-container input {
            padding-left: 56px;
        }
        
        /* Item Cards */
        .item-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
            transition: all 0.2s ease;
            position: relative;
        }
        
        .item-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px var(--shadow-medium);
            background: var(--bg-card-hover);
        }
        
        .item-card:active {
            transform: scale(0.98);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .item-info h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            line-height: 1.2;
            color: var(--text-primary);
        }
        
        /* Icon Buttons */
        .icon-btn {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .icon-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        .icon-btn:active {
            transform: scale(0.9);
        }
        
        .icon-btn.edit-btn { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            color: white; 
            box-shadow: 0 4px 15px var(--shadow-medium);
        }
        .icon-btn.delete-btn { 
            background: linear-gradient(135deg, var(--error), #f87171); 
            color: white; 
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        .icon-btn.pdf-btn { 
            background: linear-gradient(135deg, var(--info), #60a5fa); 
            color: white; 
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .icon-btn.quote-btn { 
            background: linear-gradient(135deg, var(--accent-warm), #fcd34d); 
            color: white; 
            box-shadow: 0 4px 15px rgba(251, 158, 11, 0.3);
        }
        .icon-btn.share-btn { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            color: white; 
            box-shadow: 0 4px 15px var(--shadow-medium);
        }
        .icon-btn.back-btn { 
            background: linear-gradient(135deg, var(--text-secondary), #9ca3af); 
            color: white; 
            box-shadow: 0 4px 15px rgba(75, 85, 99, 0.3);
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }
        
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-color);
            padding: 12px 20px 32px;
            z-index: 100;
            box-shadow: 0 -4px 20px var(--shadow-medium);
            transition: right 0.3s ease;
        }
        
        .bottom-nav.ai-active {
            right: 350px;
        }
        
        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            border-radius: 16px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            min-width: 60px;
        }
        
        .nav-item.active {
            color: var(--accent-primary);
            background: rgba(251, 146, 60, 0.15);
            box-shadow: 0 2px 8px var(--shadow-light);
            transform: scale(1.05);
        }
        
        .nav-item:hover {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .nav-item:active {
            transform: scale(0.95);
        }
        
        .nav-item .icon {
            font-size: 24px;
        }
        
        .home-indicator {
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 2px;
            width: 140px;
            margin: 12px auto 0;
            opacity: 0.8;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: flex-end;
            z-index: 200;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .modal.show {
            display: flex;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .modal-content {
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-radius: 24px 24px 0 0;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            color: var(--text-primary);
            animation: slideUp 0.3s ease;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
            border: 1px solid var(--border-color);
            box-shadow: 0 -8px 40px var(--shadow-strong);
        }
        
        .modal-header {
            position: sticky;
            top: 0;
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border-color);
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 18px;
        }
        
        .close-btn:hover {
            background: var(--error);
            color: white;
            transform: scale(1.1);
        }
        
        .close-btn:active {
            transform: scale(0.9);
        }
        
        .modal-body {
            padding: 24px;
        }
        
        /* Form Elements in Modals */
        .form-input {
            width: 100%;
            padding: 18px 20px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            transition: all 0.2s ease;
        }
        
        .form-input::placeholder {
            color: var(--text-muted);
        }
        
        .form-input:focus {
            outline: none;
            background: var(--bg-card);
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.15);
        }
        
        .form-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 24px;
        }
        
        .form-btn {
            padding: 18px 24px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 56px;
            box-shadow: 0 4px 15px var(--shadow-light);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        }
        
        .form-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        
        .form-btn:active {
            transform: scale(0.97);
        }
        
        .form-btn.btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        }
        
        .form-btn.btn-success {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        }
        
        .form-btn.btn-danger {
            background: linear-gradient(135deg, var(--error), #f87171);
        }
        
        .form-btn.btn-info {
            background: linear-gradient(135deg, var(--info), #60a5fa);
        }
        
        .form-btn.btn-warning {
            background: linear-gradient(135deg, var(--warning), #fcd34d);
        }
        
        .form-btn.btn-secondary {
            background: linear-gradient(135deg, var(--text-secondary), #9ca3af);
        }
        
        /* Success Message */
        .success-message {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 16px 24px;
            border-radius: 16px;
            font-weight: 600;
            box-shadow: 0 8px 35px var(--shadow-strong);
            z-index: 250;
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            transition: all 0.3s ease;
            max-width: 90%;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .success-message.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        /* Category Selection */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }
        
        .category-item {
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .category-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        
        .category-item.selected {
            border-color: var(--accent-primary);
            background: var(--accent-primary);
            color: white;
            transform: scale(1.05);
        }
        
        .category-item .icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .category-item .name {
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            line-height: 1.2;
        }
        
        /* Preset Item Selection */
        .preset-item {
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .preset-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px var(--shadow-light);
        }
        
        .preset-item.selected {
            border-color: var(--accent-primary);
            background: var(--accent-primary);
            color: white;
        }
        
        .preset-item .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .preset-item .name {
            font-weight: 700;
            font-size: 16px;
        }
        
        .preset-item .price {
            font-weight: 700;
            font-size: 16px;
            color: var(--accent-primary);
        }
        
        .preset-item.selected .price {
            color: white;
        }
        
        .preset-item .description {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }
        
        .preset-item.selected .description {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .preset-item .unit {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .preset-item.selected .unit {
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Enhanced Branding Styles */
        .branding-section {
            background: linear-gradient(135deg, #ff8c42, #ff6b35);
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            color: white;
            box-shadow: 0 8px 32px rgba(255, 140, 66, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .branding-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 20px;
        }
        
        .branding-item {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }
        
        .branding-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .branding-item .icon {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
        }
        
        .branding-item .name {
            font-size: 14px;
            font-weight: 600;
            color: white;
        }
        
        .color-picker-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin: 16px 0;
        }
        
        .color-option {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .color-option:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .color-option.selected {
            border-color: white;
            transform: scale(1.15);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
        }
        
        .color-option::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        .color-option.selected::after {
            opacity: 1;
        }
        
        .file-upload {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-upload-label {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: var(--bg-secondary);
            border: 2px dashed var(--border-color);
            border-radius: 16px;
            color: var(--text-primary);
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .file-upload:hover .file-upload-label {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        .brand-preview {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            text-align: center;
            border: 2px solid var(--border-color);
        }
        
        .brand-preview .logo-preview {
            width: 80px;
            height: 80px;
            margin: 0 auto 16px;
            border-radius: 16px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .brand-preview .company-preview {
            font-weight: 700;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .brand-preview .tagline-preview {
            font-size: 14px;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        /* Quote Detail Page */
        .quote-detail-header {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
        }
        
        .quote-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .quote-meta {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }
        
        .quote-total {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 6px 20px var(--shadow-medium);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .quote-total .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 4px;
        }
        
        .quote-total .amount {
            font-size: 32px;
            font-weight: 800;
        }
        
        .quote-items {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
        }
        
        .items-header {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .quote-item {
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 12px;
            border-left: 4px solid var(--accent-primary);
        }
        
        .quote-item:last-child {
            margin-bottom: 0;
        }
        
        .quote-item .item-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .quote-item .item-details {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
        
        .quote-item .item-pricing {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        
        .quote-item .quantity {
            color: var(--text-secondary);
        }
        
        .quote-item .price {
            font-weight: 700;
            color: var(--accent-primary);
        }
        
        /* PDF Actions */
        .pdf-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 24px;
        }
        
        .pdf-actions.three-col {
            grid-template-columns: repeat(3, 1fr);
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .view {
            padding-top: 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--text-primary);
        }
        
        .add-btn {
            width: 56px;
            height: 56px;
            border-radius: 28px;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 24px;
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        
        .add-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px var(--shadow-strong);
        }
        
        .add-btn:active {
            transform: scale(0.9);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.6;
        }
        
        /* Mobile Optimizations */
        @media screen and (max-width: 768px) {
            .ai-assistant-panel {
                width: 100vw;
                right: -100vw;
            }
            
            .ai-assistant-panel.active {
                right: 0;
            }
            
            .main-content.ai-active {
                margin-right: 0;
            }
            
            .bottom-nav.ai-active {
                right: 0;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .branding-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .character-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .form-actions {
                grid-template-columns: 1fr;
            }
            
            .item-actions {
                position: static;
                margin-top: 12px;
                justify-content: flex-end;
            }
            
            .item-card {
                padding-right: 20px;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .header-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .category-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .pdf-actions {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .pdf-actions.three-col {
                grid-template-columns: 1fr;
            }
            
            .color-picker-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Safe area adjustments */
        @supports (padding: max(0px)) {
            .status-bar {
                padding-top: env(safe-area-inset-top);
                height: calc(44px + env(safe-area-inset-top));
            }
            
            .bottom-nav {
                padding-bottom: calc(32px + env(safe-area-inset-bottom));
            }
        }
        
        /* Print styles for PDF */
        @media print {
            .status-bar,
            .header,
            .bottom-nav,
            .modal,
            .item-actions,
            .ai-assistant-panel {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
                position: static !important;
                height: auto !important;
            }
            
            .main-content {
                padding: 20px !important;
                overflow: visible !important;
                height: auto !important;
                margin-right: 0 !important;
            }
        }
    </style>
</head>
<body class="comfort-mode" data-theme="light">
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="time" id="status-time">9:41</div>
            <div class="indicators">
                <button class="theme-toggle" onclick="toggleTheme()" id="theme-toggle">🌙 Dark</button>
                <span>📶</span>
                <span>📱</span>
                <span>🔋</span>
            </div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="logo-container">
                    <div class="app-logo">
                        <svg class="logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 65L35 50L30 45L45 30C50 25 60 25 65 30C70 35 70 45 65 50L50 65L45 60L30 75C25 80 15 80 10 75C5 70 5 60 10 55L20 65Z" fill="currentColor" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                            <path d="M70 20L80 30L75 35L85 45C87 47 87 51 85 53L75 63L70 58L60 68C58 70 54 70 52 68L42 58L47 53L37 43C35 41 35 37 37 35L47 25L52 30L62 20C64 18 68 18 70 20Z" fill="currentColor" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                            <circle cx="50" cy="50" r="8" fill="rgba(255,255,255,0.8)" stroke="currentColor" stroke-width="2"/>
                            <circle cx="50" cy="50" r="3" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="app-title">
                        <h1 id="company-name">REFIT MAINTENANCE SERVICES</h1>
                        <p id="company-registration">Registration No: 201803348973<br>(002894203-V)</p>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn ai-assistant-btn" onclick="toggleAIAssistant()" title="🤖 AI Assistant" id="ai-toggle-btn">🤖</button>
                <button class="header-btn branding-insert-btn" onclick="openBrandingInsert()" title="🎨 Branding Insert">🎨</button>
                <button class="header-btn" onclick="openCompanyInfo()" title="Company Info">👤</button>
                <button class="header-btn" onclick="exportData()" title="Export">📤</button>
            </div>
        </div>

        <!-- AI Assistant Panel -->
        <div class="ai-assistant-panel" id="ai-assistant-panel">
            <div class="ai-header">
                <div class="ai-character">
                    <div class="ai-avatar" id="ai-avatar">👧</div>
                    <div class="ai-info">
                        <h3 id="ai-name">Ela</h3>
                        <p id="ai-trait">Sweet & Intelligent</p>
                    </div>
                </div>
                <button class="ai-close" onclick="toggleAIAssistant()">✕</button>
            </div>
            <div class="ai-content">
                <div class="ai-chat" id="ai-chat">
                    <div class="ai-message assistant">
                        <div>Hi! I'm <span id="ai-greeting-name">Ela</span>, your AI assistant! 😊 I'm here to help you with quotes, maintenance questions, and make your work easier. How can I assist you today?</div>
                    </div>
                </div>
                <div class="ai-input-container">
                    <input type="text" class="ai-input" id="ai-input" placeholder="Ask me anything about maintenance or quotes...">
                    <button class="ai-voice-btn" onclick="toggleVoiceInput()" id="voice-btn" title="Voice Input">🎤</button>
                    <button class="ai-send" onclick="sendAIMessage()" id="send-btn">➤</button>
                </div>
            </div>
        </div>

        <!-- AI Character Selection Modal -->
        <div class="ai-character-selection" id="character-selection">
            <div class="character-modal">
                <h3 style="text-align: center; margin-bottom: 8px; font-size: 24px; color: var(--text-primary);">🤖 Choose Your AI Assistant</h3>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 24px;">Select a cute AI girl to help you with maintenance work</p>
                
                <div class="character-grid" id="character-grid">
                    <!-- Characters will be generated here -->
                </div>
                
                <div style="display: flex; gap: 16px; margin-top: 24px;">
                    <button class="btn btn-primary" onclick="selectAICharacter()" style="flex: 1;">✅ Select Assistant</button>
                    <button class="btn btn-secondary" onclick="closeCharacterSelection()" style="flex: 1;">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view">
                <!-- Enhanced Branding Section -->
                <div class="branding-section">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                        <span style="font-size: 32px;">🎨</span>
                        <div>
                            <h3 style="font-size: 20px; font-weight: 800; margin-bottom: 4px;">Professional Branding</h3>
                            <p style="font-size: 14px; opacity: 0.9;">Complete branding customization for your quotes</p>
                        </div>
                    </div>
                    
                    <div class="branding-grid">
                        <div class="branding-item" onclick="openBrandingInsert()">
                            <span class="icon">🎨</span>
                            <div class="name">Full Branding Suite</div>
                        </div>
                        <div class="branding-item" onclick="openLogoUpload()">
                            <span class="icon">📷</span>
                            <div class="name">Logo Upload</div>
                        </div>
                        <div class="branding-item" onclick="openColorTheme()">
                            <span class="icon">🎭</span>
                            <div class="name">Color Themes</div>
                        </div>
                        <div class="branding-item" onclick="openCompanyBranding()">
                            <span class="icon">🏢</span>
                            <div class="name">Company Info</div>
                        </div>
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Quotes</div>
                        <div class="stat-value" id="total-quotes-count">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Quote Items</div>
                        <div class="stat-value" id="total-items-count">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Today's Revenue</div>
                        <div class="stat-value" id="today-revenue">RM 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Revenue</div>
                        <div class="stat-value" id="total-revenue">RM 0</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <h3 style="font-weight: 700; margin-bottom: 16px; font-size: 18px; color: var(--text-primary);">Quick Actions</h3>
                    <div class="actions-grid">
                        <button class="action-btn primary" onclick="openCreateQuote()">
                            <span class="icon">➕</span>
                            <span style="font-weight: 700;">Create New Quote</span>
                        </button>
                        <button class="action-btn success" onclick="showView('quotes')">
                            <span class="icon">💰</span>
                            <span style="font-weight: 700;">View All Quotes</span>
                        </button>
                        <button class="action-btn branding" onclick="openBrandingInsert()">
                            <span class="icon">🎨</span>
                            <span style="font-weight: 700;">Branding Suite</span>
                        </button>
                        <button class="action-btn ai-assistant" onclick="toggleAIAssistant()">
                            <span class="icon">🤖</span>
                            <span style="font-weight: 700;">AI Assistant</span>
                        </button>
                    </div>
                </div>

                <!-- Recent Quotes -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">Recent Job Quotes</h3>
                        <button style="background: none; border: none; color: var(--text-muted); font-size: 14px; cursor: pointer; font-weight: 600;" onclick="showView('quotes')">View All</button>
                    </div>
                    <div id="recent-quotes"></div>
                </div>
            </div>

            <!-- Quotes View -->
            <div id="quotes-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">Job Quotes</h2>
                    <button class="add-btn" onclick="openCreateQuote()">
                        <span>➕</span>
                    </button>
                </div>

                <div class="search-container">
                    <span class="search-icon">🔍</span>
                    <input type="text" class="input" placeholder="Search quotes..." id="quote-search">
                </div>

                <div id="quotes-list"></div>
            </div>

            <!-- Quote Detail View -->
            <div id="quote-detail-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">Quote Details</h2>
                    <button class="icon-btn back-btn" onclick="showView('quotes')">
                        ← Back
                    </button>
                </div>

                <div id="quote-detail-content"></div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav" id="bottom-nav">
            <div class="nav-items">
                <div class="nav-item active" onclick="showView('dashboard')">
                    <span class="icon">🏠</span>
                    <span>Home</span>
                </div>
                <div class="nav-item" onclick="showView('quotes')">
                    <span class="icon">💰</span>
                    <span>Quotes</span>
                </div>
                <div class="nav-item" onclick="openCreateQuote()">
                    <span class="icon">➕</span>
                    <span>Create</span>
                </div>
                <div class="nav-item" onclick="toggleAIAssistant()">
                    <span class="icon">🤖</span>
                    <span>AI</span>
                </div>
            </div>
            <div class="home-indicator"></div>
        </div>
    </div>

    <!-- Step 1: Job Title Modal -->
    <div id="job-title-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>📝 Step 1: Enter Job Title</h3>
                <button class="close-btn" onclick="closeCreateQuote()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">💼</div>
                    <p style="color: var(--text-muted); font-size: 16px;">What type of maintenance work is this quote for?</p>
                </div>
                
                <input type="text" 
                       class="form-input" 
                       placeholder="e.g., Office Renovation, AC Installation, Plumbing Repair..." 
                       id="job-title-input" 
                       style="font-size: 18px; padding: 20px 24px; text-align: center; font-weight: 600; margin-bottom: 24px;">
                
                <button type="button" 
                        class="btn btn-primary" 
                        onclick="proceedToCategory()" 
                        id="proceed-to-category-btn"
                        style="font-size: 18px; padding: 20px 32px; width: 100%;">
                    Next: Select Category ➡️
                </button>
            </div>
        </div>
    </div>

    <!-- Step 2: Category Selection Modal -->
    <div id="category-selection-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🏷️ Step 2: Select Categories & Items</h3>
                <button class="close-btn" onclick="backToJobTitle()">←</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">🎯</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Choose categories and add items:</p>
                    <p style="font-weight: 700; color: var(--text-primary); margin-top: 8px;" id="selected-job-title"></p>
                </div>

                <!-- Current Quote Summary -->
                <div id="current-quote-summary" style="display: none; background: var(--bg-secondary); border-radius: 16px; padding: 20px; margin-bottom: 20px; border: 2px solid var(--accent-primary);">
                    <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>🛒</span> Current Quote (<span id="total-items-count">0</span> items)
                    </h4>
                    <div id="quote-items-preview" style="margin-bottom: 12px;"></div>
                    <div style="background: var(--accent-primary); border-radius: 12px; padding: 16px; text-align: center;">
                        <div style="font-size: 14px; font-weight: 600; color: rgba(255, 255, 255, 0.9);">Total Amount</div>
                        <div style="font-size: 24px; font-weight: 800; color: white;" id="running-total">RM 0.00</div>
                    </div>
                </div>

                <div class="category-grid" id="category-grid"></div>

                <div class="form-actions" style="margin-top: 24px;">
                    <button type="button" class="form-btn btn-primary" onclick="finalizeQuote()" id="finalize-quote-btn" disabled style="opacity: 0.5;">
                        ✅ Create Quote
                    </button>
                    <button type="button" class="form-btn btn-secondary" onclick="closeCreateQuote()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 3: Item Selection Modal -->
    <div id="item-selection-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>📋 Step 3: Select Items</h3>
                <button class="close-btn" onclick="backToCategories()">←</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">✅</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Select work items for:</p>
                    <p style="font-weight: 700; color: var(--text-primary); margin-top: 4px;" id="category-job-title"></p>
                    <p style="color: var(--accent-primary); font-weight: 600; margin-top: 4px;" id="selected-category-display"></p>
                </div>

                <!-- Add Custom Item Button -->
                <div style="margin-bottom: 16px;">
                    <button type="button" class="btn btn-warm" onclick="openCustomItemForm()" style="width: 100%; font-size: 16px; padding: 16px;">
                        ➕ Create Custom Item
                    </button>
                </div>

                <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                    <div id="preset-items-list"></div>
                </div>

                <!-- Selected Items Summary -->
                <div id="selected-items-summary" style="display: none;">
                    <div style="background: var(--bg-secondary); border-radius: 16px; padding: 20px; margin: 20px 0; border: 2px solid var(--accent-primary);">
                        <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px;">Selected Items (<span id="selected-count">0</span>)</h4>
                        <div id="selected-items-list" style="margin-bottom: 16px;"></div>
                        <div style="background: var(--accent-primary); border-radius: 12px; padding: 16px; text-align: center;">
                            <div style="font-size: 14px; font-weight: 600; color: rgba(255, 255, 255, 0.9);">Category Total</div>
                            <div style="font-size: 28px; font-weight: 800; color: white;" id="category-total-amount">RM 0.00</div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="form-btn btn-success" onclick="backToCategories()">
                        ← Add More Categories
                    </button>
                    <button type="button" class="form-btn btn-primary" onclick="finishItemSelection()" id="finish-items-btn">
                        Done with Category
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Branding Insert Modal -->
    <div id="branding-insert-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🎨 Complete Branding Suite</h3>
                <button class="close-btn" onclick="closeBrandingInsert()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">🎨</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Professional branding customization for your quotes</p>
                </div>

                <!-- Branding Preview -->
                <div class="brand-preview" id="brand-preview">
                    <div class="logo-preview" id="logo-preview">
                        <!-- Logo preview will be shown here -->
                    </div>
                    <div class="company-preview" id="company-preview">REFIT MAINTENANCE SERVICES</div>
                    <div class="tagline-preview" id="tagline-preview">Professional Assistant • Ready to help</div>
                </div>

                <!-- Logo Upload Section -->
                <div style="margin-bottom: 24px;">
                    <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>📷</span> Company Logo
                    </h4>
                    <div class="file-upload" style="width: 100%;">
                        <input type="file" id="branding-logo-input" accept="image/*" onchange="handleBrandingLogoUpload(event)">
                        <label for="branding-logo-input" class="file-upload-label" style="width: 100%; justify-content: center;">
                            <span>📁</span>
                            <span>Upload Company Logo</span>
                        </label>
                    </div>
                    <p style="font-size: 12px; color: var(--text-muted); margin-top: 8px;">Recommended: Square format, Max 2MB</p>
                </div>

                <!-- Color Theme Selection -->
                <div style="margin-bottom: 24px;">
                    <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>🎭</span> Brand Colors
                    </h4>
                    <div class="color-picker-container" id="color-picker">
                        <!-- Color options will be generated here -->
                    </div>
                </div>

                <!-- Company Tagline -->
                <div style="margin-bottom: 24px;">
                    <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>✨</span> Company Tagline
                    </h4>
                    <input type="text" class="form-input" placeholder="e.g., Professional Assistant • Ready to help" id="company-tagline-input">
                </div>

                <!-- Quick Insert Buttons -->
                <div style="margin-bottom: 24px;">
                    <h4 style="font-weight: 700; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span>⚡</span> Quick Insert
                    </h4>
                    <div class="branding-grid">
                        <div class="branding-item" onclick="insertBrandingToQuote()">
                            <span class="icon">📄</span>
                            <div class="name">Insert to Current Quote</div>
                        </div>
                        <div class="branding-item" onclick="saveBrandingTemplate()">
                            <span class="icon">💾</span>
                            <div class="name">Save as Template</div>
                        </div>
                        <div class="branding-item" onclick="previewBrandedQuote()">
                            <span class="icon">👁️</span>
                            <div class="name">Preview Quote</div>
                        </div>
                        <div class="branding-item" onclick="exportBrandingPackage()">
                            <span class="icon">📦</span>
                            <div class="name">Export Package</div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="form-btn btn-primary" onclick="applyBranding()">
                        ✅ Apply Branding
                    </button>
                    <button type="button" class="form-btn btn-secondary" onclick="closeBrandingInsert()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Simple Company Info Modal -->
    <div id="company-info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🏢 Company Information</h3>
                <button class="close-btn" onclick="closeCompanyInfo()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">🏢</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Update your company details for quotes</p>
                </div>

                <input type="text" class="form-input" placeholder="Company Name" id="company-name-input">
                <input type="text" class="form-input" placeholder="Registration Number" id="company-reg-input">
                <input type="text" class="form-input" placeholder="Phone Number" id="company-phone-input">
                <input type="text" class="form-input" placeholder="Email Address" id="company-email-input">
                <textarea class="form-input" placeholder="Company Address" id="company-address-input" rows="3" style="resize: none;"></textarea>

                <div class="form-actions">
                    <button type="button" class="form-btn btn-primary" onclick="saveCompanyInfo()">
                        ✅ Save Details
                    </button>
                    <button type="button" class="form-btn btn-secondary" onclick="closeCompanyInfo()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Item Creation Modal -->
    <div id="custom-item-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>➕ Create Custom Item</h3>
                <button class="close-btn" onclick="closeCustomItemForm()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">🛠️</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Add a custom item to this quote</p>
                </div>

                <form id="custom-item-form">
                    <input type="text" 
                           class="form-input" 
                           placeholder="Item name (e.g., Custom Electrical Work)" 
                           id="custom-item-name" 
                           required
                           style="margin-bottom: 16px;">
                    
                    <textarea class="form-input" 
                              placeholder="Item description (optional)" 
                              id="custom-item-description" 
                              rows="2" 
                              style="resize: none; margin-bottom: 16px;"></textarea>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <input type="number" 
                               class="form-input" 
                               placeholder="Price (RM)" 
                               id="custom-item-price" 
                               step="0.01" 
                               min="0"
                               required
                               style="margin-bottom: 0;">
                        
                        <select class="form-input" id="custom-item-unit" style="margin-bottom: 0;">
                            <option value="pcs">Pieces (pcs)</option>
                            <option value="hours">Hours</option>
                            <option value="sqft">Square Feet</option>
                            <option value="sqm">Square Meters</option>
                            <option value="meters">Meters</option>
                            <option value="kg">Kilograms</option>
                            <option value="liters">Liters</option>
                            <option value="set">Set</option>
                            <option value="lot">Lot</option>
                            <option value="service">Service</option>
                        </select>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="form-btn btn-primary">
                            ✅ Add to Quote
                        </button>
                        <button type="button" class="form-btn btn-secondary" onclick="closeCustomItemForm()">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- PDF Share Modal -->
    <div id="pdf-share-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>📄 Share Quote</h3>
                <button class="close-btn" onclick="closePdfShare()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">📤</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Generate and share your professional quote</p>
                </div>

                <div class="pdf-actions three-col">
                    <button type="button" class="form-btn btn-success" onclick="generateAndSharePDF()">
                        📱 Share PDF
                    </button>
                    <button type="button" class="form-btn btn-info" onclick="downloadPDF()">
                        💾 Download PDF
                    </button>
                    <button type="button" class="form-btn btn-secondary" onclick="closePdfShare()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Branding Preview Modal -->
    <div id="branding-preview-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>👁️ Branding Preview</h3>
                <button class="close-btn" onclick="closeBrandingPreview()">✕</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">📄</div>
                    <p style="color: var(--text-muted); font-size: 16px;">Preview how your branding will appear on quotes</p>
                </div>

                <div id="branding-preview-content">
                    <!-- Preview content will be generated here -->
                </div>

                <div class="form-actions">
                    <button type="button" class="form-btn btn-primary" onclick="generatePreviewPDF()">
                        📄 Generate PDF Preview
                    </button>
                    <button type="button" class="form-btn btn-secondary" onclick="closeBrandingPreview()">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="success-message" class="success-message">
        ✅ Action completed successfully!
    </div>

    <script>
        // ========================================
        // REFIT MAINTENANCE SERVICES - AI VOICE ASSISTANT SYSTEM
        // Registration No: 201803348973 (002894203-V)
        // Complete AI Assistant with Cute Girl Characters & Voice Features
        // ========================================
        
        // App State Variables
        var currentView = 'dashboard';
        var jobQuotes = [];
        var currentQuoteData = {
            title: '',
            categories: [],
            items: [],
            totalAmount: 0
        };
        var currentQuoteId = null;
        var currentTheme = 'light';
        var currentCategory = '';
        var customLogo = null;

        // AI Assistant State
        var aiAssistantActive = false;
        var currentAICharacter = null;
        var aiConversation = [];
        var isListening = false;
        var recognition = null;
        var speechSynthesis = window.speechSynthesis;

        // AI Character Database
        var aiCharacters = [
            {
                id: 'ela',
                name: 'Ela',
                avatar: '👧',
                trait: 'Sweet & Intelligent',
                personality: 'sweet, caring, intelligent',
                voice: { pitch: 1.2, rate: 0.9 },
                greeting: "Hi! I'm Ela, your sweet AI assistant! 😊 I'm here to help you with quotes and maintenance work. How can I make your day better?",
                specialties: ['quotes', 'calculations', 'organization']
            },
            {
                id: 'isla',
                name: 'Isla',
                avatar: '🌸',
                trait: 'Pretty & Clever',
                personality: 'pretty, clever, sophisticated',
                voice: { pitch: 1.1, rate: 1.0 },
                greeting: "Hello! I'm Isla, and I love helping with complex maintenance projects! ✨ My clever mind is perfect for solving your business challenges.",
                specialties: ['analysis', 'recommendations', 'planning']
            },
            {
                id: 'maiya',
                name: 'Maiya',
                avatar: '💖',
                trait: 'Lovely & Soft',
                personality: 'lovely, soft, gentle',
                voice: { pitch: 1.3, rate: 0.8 },
                greeting: "Hi there! I'm Maiya, your gentle assistant! 💕 I'll take care of all your maintenance needs with love and attention to detail.",
                specialties: ['customer care', 'communication', 'details']
            },
            {
                id: 'violet',
                name: 'Violet',
                avatar: '💜',
                trait: 'Concern & Smart',
                personality: 'concerned, smart, analytical',
                voice: { pitch: 1.0, rate: 1.1 },
                greeting: "Hello! I'm Violet, and I'm genuinely concerned about your business success! 💜 Let me analyze your maintenance needs and provide smart solutions.",
                specialties: ['troubleshooting', 'efficiency', 'solutions']
            },
            {
                id: 'luna',
                name: 'Luna',
                avatar: '🌙',
                trait: 'Cute & Wise',
                personality: 'cute, wise, thoughtful',
                voice: { pitch: 1.2, rate: 0.9 },
                greeting: "Hi! I'm Luna, your wise little helper! 🌙 I may be cute, but I have deep knowledge about maintenance and quotes!",
                specialties: ['education', 'explanations', 'guidance']
            },
            {
                id: 'rose',
                name: 'Rose',
                avatar: '🌹',
                trait: 'Beautiful & Kind',
                personality: 'beautiful, kind, compassionate',
                voice: { pitch: 1.1, rate: 0.9 },
                greeting: "Hello beautiful! I'm Rose, and I'm here to make your work life more beautiful! 🌹 Let's create amazing quotes together!",
                specialties: ['creativity', 'presentation', 'aesthetics']
            },
            {
                id: 'sky',
                name: 'Sky',
                avatar: '☁️',
                trait: 'Free & Creative',
                personality: 'free-spirited, creative, innovative',
                voice: { pitch: 1.0, rate: 1.0 },
                greeting: "Hey! I'm Sky, your creative assistant! ☁️ I love thinking outside the box and finding innovative solutions for your maintenance projects!",
                specialties: ['innovation', 'creativity', 'brainstorming']
            },
            {
                id: 'aria',
                name: 'Aria',
                avatar: '🎵',
                trait: 'Harmonious & Peaceful',
                personality: 'harmonious, peaceful, balanced',
                voice: { pitch: 1.1, rate: 0.8 },
                greeting: "Hello! I'm Aria, bringing harmony to your maintenance work! 🎵 Let's create perfectly balanced quotes with peaceful efficiency.",
                specialties: ['coordination', 'balance', 'harmony']
            }
        ];

        // Enhanced Branding System - PASTEL ORANGE THEME
        var brandingData = {
            logo: null,
            primaryColor: '#fb923c',
            secondaryColor: '#fed7aa',
            accentColor: '#f59e0b',
            tagline: 'Professional Assistant • Ready to help',
            template: 'default'
        };

        // Brand Color Themes - PASTEL ORANGE FOCUSED
        var colorThemes = [
            { name: 'Pastel Orange Pro', primary: '#fb923c', secondary: '#fed7aa', accent: '#f59e0b' },
            { name: 'Warm Orange', primary: '#ff8c42', secondary: '#ffc09f', accent: '#ffee93' },
            { name: 'Sunset Orange', primary: '#ff6b35', secondary: '#f7931e', accent: '#ffd23f' },
            { name: 'Coral Orange', primary: '#ff7f50', secondary: '#ffb07a', accent: '#ffd700' },
            { name: 'Peach Professional', primary: '#ffab76', secondary: '#ffd93d', accent: '#6c5ce7' },
            { name: 'Mandarin Modern', primary: '#ff9500', secondary: '#ffad33', accent: '#00b894' },
            { name: 'Apricot Elegance', primary: '#ffb347', secondary: '#ffd700', accent: '#e17055' },
            { name: 'Amber Business', primary: '#ffbf00', secondary: '#ffcc5c', accent: '#fd79a8' }
        ];

        // Enhanced Category Configuration
        var categories = {
            // Construction Categories
            preliminary: {
                name: 'Preliminary Work',
                icon: '🏗️',
                color: 'var(--cat-preliminary)',
                description: 'Site preparation and preliminary construction work'
            },
            wall: {
                name: 'Wall Work',
                icon: '🧱',
                color: 'var(--cat-wall)',
                description: 'Wall construction, renovation and finishing'
            },
            floor: {
                name: 'Floor Work',
                icon: '🏢',
                color: 'var(--cat-floor)',
                description: 'Flooring installation and finishing'
            },
            ceiling: {
                name: 'Ceiling Work',
                icon: '🏠',
                color: 'var(--cat-ceiling)',
                description: 'Ceiling installation and finishing'
            },
            roofing: {
                name: 'Roofing',
                icon: '🏘️',
                color: 'var(--cat-roofing)',
                description: 'Roof installation and maintenance'
            },
            wetwork: {
                name: 'Wet Work',
                icon: '💧',
                color: 'var(--cat-wetwork)',
                description: 'Bathroom, kitchen and wet area work'
            },
            // M&E Categories
            'me-work': {
                name: 'M&E Work',
                icon: '⚙️',
                color: 'var(--cat-me-work)',
                description: 'Mechanical and electrical systems'
            },
            exhaust: {
                name: 'Exhaust Systems',
                icon: '🌪️',
                color: 'var(--cat-exhaust)',
                description: 'Ventilation and exhaust systems'
            },
            'lights-fan': {
                name: 'Lights & Fan',
                icon: '💡',
                color: 'var(--cat-lights-fan)',
                description: 'Lighting and fan installations'
            },
            ac: {
                name: 'AC Systems',
                icon: '❄️',
                color: 'var(--cat-ac)',
                description: 'Air conditioning systems'
            },
            // Finishing Categories
            paint: {
                name: 'Paint Works',
                icon: '🎨',
                color: 'var(--cat-paint)',
                description: 'Painting and finishing work'
            },
            curtain: {
                name: 'Curtain & Blind',
                icon: '🪟',
                color: 'var(--cat-curtain)',
                description: 'Window treatments and coverings'
            },
            // Furniture Categories
            builtin: {
                name: 'Built-in Furniture',
                icon: '🔨',
                color: 'var(--cat-builtin)',
                description: 'Custom built-in furniture and storage'
            },
            loose: {
                name: 'Loose Furniture',
                icon: '🪑',
                color: 'var(--cat-loose)',
                description: 'Movable furniture and furnishings'
            },
            // Service Categories
            sanitary: {
                name: 'Sanitary & Water Pump',
                icon: '🚿',
                color: 'var(--cat-sanitary)',
                description: 'Sanitary installations and water pump systems'
            },
            appliances: {
                name: 'Electrical Appliances',
                icon: '📺',
                color: 'var(--cat-appliances)',
                description: 'Electrical appliances and equipment'
            },
            // Legacy Categories
            electrical: {
                name: 'Electrical',
                icon: '⚡',
                color: 'var(--cat-electrical)',
                description: 'Electrical systems, wiring, and components'
            },
            plumbing: {
                name: 'Plumbing',
                icon: '🔧',
                color: 'var(--cat-plumbing)',
                description: 'Water systems, pipes, and fixtures'
            },
            hvac: {
                name: 'HVAC',
                icon: '🌡️',
                color: 'var(--cat-hvac)',
                description: 'Heating, ventilation, and air conditioning'
            },
            cleaning: {
                name: 'Cleaning',
                icon: '🧽',
                color: 'var(--cat-cleaning)',
                description: 'Cleaning services and maintenance'
            },
            parts: {
                name: 'Parts & Materials',
                icon: '🔩',
                color: 'var(--cat-parts)',
                description: 'Replacement parts and materials'
            },
            labor: {
                name: 'Labor',
                icon: '👷',
                color: 'var(--cat-labor)',
                description: 'Labor charges and work hours'
            },
            equipment: {
                name: 'Equipment',
                icon: '🛠️',
                color: 'var(--cat-equipment)',
                description: 'Tools and equipment'
            },
            common: {
                name: 'Common Items',
                icon: '🏷️',
                color: 'var(--cat-common)',
                description: 'Frequently used items'
            }
        };

        // Preset Work Items by Category
        var presetWorkItems = {
            preliminary: [
                { id: 'prelim-1', name: 'Insurance Coverage (Min 1Mil Public Liability)', description: 'Public liability insurance minimum RM1,000,000 coverage', price: 500.00, unit: 'service' },
                { id: 'prelim-2', name: 'ID Drawing Submission to Management', description: 'Interior design drawing submission to building management', price: 300.00, unit: 'service' },
                { id: 'prelim-3', name: 'Architect Professional Endorsement', description: 'Professional architect appointment with endorsed drawings', price: 2500.00, unit: 'service' },
                { id: 'prelim-4', name: 'Local Authority Submission', description: 'Submission to local council authorities for approval', price: 800.00, unit: 'service' },
                { id: 'prelim-5', name: 'Signage License Application', description: 'Application for signage license and approval', price: 400.00, unit: 'service' }
            ],
            wall: [
                { id: 'wall-1', name: 'Drywall Installation', description: 'Standard drywall installation with finishing', price: 35.00, unit: 'sqm' },
                { id: 'wall-2', name: 'Partition Wall Construction', description: 'Metal stud partition wall with drywall', price: 65.00, unit: 'sqm' },
                { id: 'wall-3', name: 'Wall Patching & Repair', description: 'Minor wall damage repair and patching', price: 25.00, unit: 'sqm' },
                { id: 'wall-4', name: 'Wall Insulation', description: 'Thermal and sound insulation installation', price: 45.00, unit: 'sqm' }
            ],
            floor: [
                { id: 'floor-1', name: 'Vinyl Flooring Installation', description: 'Commercial grade vinyl flooring', price: 45.00, unit: 'sqm' },
                { id: 'floor-2', name: 'Carpet Installation', description: 'Commercial carpet with padding', price: 55.00, unit: 'sqm' },
                { id: 'floor-3', name: 'Ceramic Tile Installation', description: 'Floor tile installation with grouting', price: 68.00, unit: 'sqm' },
                { id: 'floor-4', name: 'Laminate Flooring', description: 'High-quality laminate flooring installation', price: 52.00, unit: 'sqm' }
            ],
            ceiling: [
                { id: 'ceiling-1', name: 'Suspended Ceiling Installation', description: 'Mineral fiber suspended ceiling system', price: 42.00, unit: 'sqm' },
                { id: 'ceiling-2', name: 'Drywall Ceiling', description: 'Drywall ceiling installation and finishing', price: 38.00, unit: 'sqm' },
                { id: 'ceiling-3', name: 'Acoustic Ceiling Tiles', description: 'Sound-absorbing ceiling tile installation', price: 48.00, unit: 'sqm' }
            ],
            roofing: [
                { id: 'roofing-1', name: 'Shingle Roof Repair', description: 'Asphalt shingle replacement and repair', price: 85.00, unit: 'sqm' },
                { id: 'roofing-2', name: 'Roof Membrane Installation', description: 'Waterproof membrane application', price: 125.00, unit: 'sqm' },
                { id: 'roofing-3', name: 'Gutter Installation', description: 'Aluminum gutter system installation', price: 55.00, unit: 'meters' }
            ],
            wetwork: [
                { id: 'wetwork-1', name: 'Waterproofing Application', description: 'Bathroom and wet area waterproofing', price: 75.00, unit: 'sqm' },
                { id: 'wetwork-2', name: 'Wall Tile Installation', description: 'Ceramic wall tiles with waterproof backing', price: 85.00, unit: 'sqm' },
                { id: 'wetwork-3', name: 'Shower Cubicle Installation', description: 'Glass shower enclosure with hardware', price: 850.00, unit: 'set' }
            ],
            'me-work': [
                { id: 'me-1', name: 'Electrical Panel Installation', description: 'Main electrical distribution panel', price: 450.00, unit: 'pcs' },
                { id: 'me-2', name: 'Conduit Installation', description: 'Electrical conduit and cable management', price: 15.00, unit: 'meters' },
                { id: 'me-3', name: 'Cable Tray System', description: 'Heavy-duty cable tray installation', price: 85.00, unit: 'meters' }
            ],
            exhaust: [
                { id: 'exhaust-1', name: 'Kitchen Exhaust Installation', description: 'Commercial kitchen exhaust system', price: 850.00, unit: 'set' },
                { id: 'exhaust-2', name: 'Bathroom Exhaust Fan', description: 'Silent bathroom exhaust fan with timer', price: 165.00, unit: 'pcs' },
                { id: 'exhaust-3', name: 'Industrial Exhaust System', description: 'Heavy-duty industrial ventilation', price: 1200.00, unit: 'set' }
            ],
            'lights-fan': [
                { id: 'lights-1', name: 'LED Panel Light', description: '40W LED panel light with driver', price: 85.00, unit: 'pcs' },
                { id: 'lights-2', name: 'LED Downlight', description: '12W recessed LED downlight', price: 45.00, unit: 'pcs' },
                { id: 'lights-3', name: 'Ceiling Fan', description: '52" ceiling fan with remote control', price: 220.00, unit: 'pcs' },
                { id: 'lights-4', name: 'Track Lighting', description: 'Adjustable track lighting system', price: 180.00, unit: 'set' }
            ],
            ac: [
                { id: 'ac-1', name: 'Split AC Installation', description: '1.5HP split unit air conditioner', price: 1200.00, unit: 'set' },
                { id: 'ac-2', name: 'AC Maintenance Service', description: 'Quarterly AC cleaning and maintenance', price: 120.00, unit: 'service' },
                { id: 'ac-3', name: 'Ducted AC System', description: 'Central ducted air conditioning', price: 3500.00, unit: 'set' }
            ],
            paint: [
                { id: 'paint-1', name: 'Interior Wall Painting', description: 'Two coats premium interior paint', price: 12.00, unit: 'sqm' },
                { id: 'paint-2', name: 'Exterior Wall Painting', description: 'Weather-resistant exterior paint', price: 18.00, unit: 'sqm' },
                { id: 'paint-3', name: 'Ceiling Painting', description: 'Specialized ceiling paint application', price: 14.00, unit: 'sqm' }
            ],
            curtain: [
                { id: 'curtain-1', name: 'Fabric Curtain Installation', description: 'Custom fabric curtains with hardware', price: 85.00, unit: 'sqm' },
                { id: 'curtain-2', name: 'Vertical Blind Installation', description: 'PVC vertical blinds for offices', price: 65.00, unit: 'sqm' },
                { id: 'curtain-3', name: 'Roller Blind System', description: 'Motorized roller blind installation', price: 120.00, unit: 'sqm' }
            ],
            builtin: [
                { id: 'builtin-1', name: 'Built-in Wardrobe', description: 'Custom melamine wardrobe with drawers', price: 450.00, unit: 'sqm' },
                { id: 'builtin-2', name: 'Kitchen Cabinet', description: 'Modular kitchen cabinet system', price: 650.00, unit: 'sqm' },
                { id: 'builtin-3', name: 'Office Storage Unit', description: 'Built-in office storage solution', price: 380.00, unit: 'sqm' }
            ],
            loose: [
                { id: 'loose-1', name: 'Office Chair', description: 'Ergonomic mesh office chair', price: 250.00, unit: 'pcs' },
                { id: 'loose-2', name: 'Office Desk', description: 'Modern office desk with drawers', price: 450.00, unit: 'pcs' },
                { id: 'loose-3', name: 'Meeting Table', description: 'Conference table for 8 people', price: 850.00, unit: 'pcs' }
            ],
            sanitary: [
                { id: 'sanitary-1', name: 'Toilet Suite Installation', description: 'Complete toilet suite with accessories', price: 350.00, unit: 'set' },
                { id: 'sanitary-2', name: 'Wash Basin Installation', description: 'Wall-hung basin with mixer tap', price: 280.00, unit: 'set' },
                { id: 'sanitary-3', name: 'Water Pump System', description: 'Automatic water pump installation', price: 680.00, unit: 'set' }
            ],
            appliances: [
                { id: 'appliances-1', name: 'Electric Water Heater', description: '30L instant electric water heater', price: 380.00, unit: 'pcs' },
                { id: 'appliances-2', name: 'Range Hood Installation', description: 'Kitchen range hood with ducting', price: 450.00, unit: 'pcs' },
                { id: 'appliances-3', name: 'Dishwasher Installation', description: 'Built-in dishwasher setup', price: 320.00, unit: 'pcs' }
            ],
            electrical: [
                { id: 'electrical-1', name: 'Power Outlet Installation', description: 'Standard 13A power outlet', price: 45.00, unit: 'pcs' },
                { id: 'electrical-2', name: 'Light Switch Installation', description: 'Standard wall switch installation', price: 35.00, unit: 'pcs' },
                { id: 'electrical-3', name: 'Electrical Safety Inspection', description: 'Complete electrical system safety check', price: 150.00, unit: 'service' }
            ],
            plumbing: [
                { id: 'plumbing-1', name: 'Pipe Repair Service', description: 'Water pipe leak repair', price: 65.00, unit: 'service' },
                { id: 'plumbing-2', name: 'Faucet Installation', description: 'Kitchen or bathroom faucet setup', price: 85.00, unit: 'pcs' },
                { id: 'plumbing-3', name: 'Drain Cleaning', description: 'Professional drain cleaning service', price: 95.00, unit: 'service' }
            ],
            hvac: [
                { id: 'hvac-1', name: 'HVAC Filter Replacement', description: 'Air filter replacement service', price: 35.00, unit: 'pcs' },
                { id: 'hvac-2', name: 'Duct Cleaning', description: 'Professional ductwork cleaning', price: 180.00, unit: 'service' },
                { id: 'hvac-3', name: 'Thermostat Installation', description: 'Digital thermostat setup', price: 125.00, unit: 'pcs' }
            ],
            cleaning: [
                { id: 'cleaning-1', name: 'Office Cleaning Service', description: 'Standard office cleaning', price: 25.00, unit: 'sqm' },
                { id: 'cleaning-2', name: 'Deep Cleaning Service', description: 'Comprehensive deep cleaning', price: 35.00, unit: 'sqm' },
                { id: 'cleaning-3', name: 'Window Cleaning', description: 'Professional window cleaning', price: 8.00, unit: 'sqm' }
            ],
            parts: [
                { id: 'parts-1', name: 'Electrical Wire', description: 'Standard electrical wiring cable', price: 8.50, unit: 'meters' },
                { id: 'parts-2', name: 'PVC Pipe', description: 'Standard PVC water pipe', price: 12.00, unit: 'meters' },
                { id: 'parts-3', name: 'Hardware Kit', description: 'Assorted screws and fasteners', price: 25.00, unit: 'set' }
            ],
            labor: [
                { id: 'labor-1', name: 'Skilled Technician', description: 'Certified technician work hour', price: 45.00, unit: 'hours' },
                { id: 'labor-2', name: 'Helper Labor', description: 'General helper work hour', price: 25.00, unit: 'hours' },
                { id: 'labor-3', name: 'Specialist Labor', description: 'Specialized technician work hour', price: 65.00, unit: 'hours' }
            ],
            equipment: [
                { id: 'equipment-1', name: 'Power Drill Rental', description: 'Professional power drill rental', price: 35.00, unit: 'hours' },
                { id: 'equipment-2', name: 'Scaffolding Rental', description: 'Mobile scaffolding system rental', price: 85.00, unit: 'days' },
                { id: 'equipment-3', name: 'Generator Rental', description: 'Portable generator rental', price: 120.00, unit: 'days' }
            ],
            common: [
                { id: 'common-1', name: 'Service Call Fee', description: 'Basic service call charge', price: 75.00, unit: 'service' },
                { id: 'common-2', name: 'Material Transport', description: 'Material delivery and transport', price: 50.00, unit: 'trip' },
                { id: 'common-3', name: 'Site Survey
