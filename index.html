<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="REFIT VOICE AI SYSTEM">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2d1517">
    
    <title>REFIT VOICE AI - Claude Speaks Everything! Complete Voice Business System</title>
    
    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* Base Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        /* 8 BEAUTIFUL PASTEL THEMES WITH DARK BACKGROUNDS & WHITE TEXT */
        
        /* Theme 1: Coral Sunset (Dark with White Text) */
        [data-theme="red"] {
            --bg-primary: #2d1517;
            --bg-secondary: #3d1f22;
            --bg-card: #4a262a;
            --bg-card-hover: #5a2f33;
            --text-primary: #fef7f7;
            --text-secondary: #fed7d7;
            --text-muted: #fca5a5;
            --accent-primary: #f87171;
            --accent-secondary: #fca5a5;
            --accent-warm: #fb923c;
            --border-color: #5a2f33;
            --shadow-light: rgba(248, 113, 113, 0.1);
            --shadow-medium: rgba(248, 113, 113, 0.2);
            --shadow-strong: rgba(248, 113, 113, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #dc2626;
            --info: #3b82f6;
            --theme-name: "Coral Sunset";
            --theme-icon: "üåÖ";
        }

        /* Theme 2: Peach Glow (Dark with White Text) */
        [data-theme="orange"] {
            --bg-primary: #2d1b0f;
            --bg-secondary: #3d261a;
            --bg-card: #4a3025;
            --bg-card-hover: #5a3a30;
            --text-primary: #fff7ed;
            --text-secondary: #fed7aa;
            --text-muted: #fdba74;
            --accent-primary: #fb923c;
            --accent-secondary: #fdba74;
            --accent-warm: #fbbf24;
            --border-color: #5a3a30;
            --shadow-light: rgba(251, 146, 60, 0.1);
            --shadow-medium: rgba(251, 146, 60, 0.2);
            --shadow-strong: rgba(251, 146, 60, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Peach Glow";
            --theme-icon: "üçë";
        }

        /* Theme 3: Rose Blush (Dark with White Text) */
        [data-theme="pink"] {
            --bg-primary: #2d1524;
            --bg-secondary: #3d1f2e;
            --bg-card: #4a2638;
            --bg-card-hover: #5a2f42;
            --text-primary: #fdf2f8;
            --text-secondary: #fce7f3;
            --text-muted: #f9a8d4;
            --accent-primary: #f472b6;
            --accent-secondary: #f9a8d4;
            --accent-warm: #fbbf24;
            --border-color: #5a2f42;
            --shadow-light: rgba(244, 114, 182, 0.1);
            --shadow-medium: rgba(244, 114, 182, 0.2);
            --shadow-strong: rgba(244, 114, 182, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Rose Blush";
            --theme-icon: "üå∏";
        }

        /* Theme 4: Butter Cream (Dark with White Text) */
        [data-theme="yellow"] {
            --bg-primary: #2d2510;
            --bg-secondary: #3d331a;
            --bg-card: #4a4025;
            --bg-card-hover: #5a4d30;
            --text-primary: #fefce8;
            --text-secondary: #fef3c7;
            --text-muted: #fcd34d;
            --accent-primary: #fbbf24;
            --accent-secondary: #fcd34d;
            --accent-warm: #f59e0b;
            --border-color: #5a4d30;
            --shadow-light: rgba(251, 191, 36, 0.1);
            --shadow-medium: rgba(251, 191, 36, 0.2);
            --shadow-strong: rgba(251, 191, 36, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Butter Cream";
            --theme-icon: "üåª";
        }

        /* Theme 5: Mint Breeze (Dark with White Text) */
        [data-theme="bluegreen"] {
            --bg-primary: #0f2925;
            --bg-secondary: #1a3530;
            --bg-card: #25423b;
            --bg-card-hover: #304f46;
            --text-primary: #f0fdfa;
            --text-secondary: #ccfbf1;
            --text-muted: #7dd3fc;
            --accent-primary: #2dd4bf;
            --accent-secondary: #7dd3fc;
            --accent-warm: #fbbf24;
            --border-color: #304f46;
            --shadow-light: rgba(45, 212, 191, 0.1);
            --shadow-medium: rgba(45, 212, 191, 0.2);
            --shadow-strong: rgba(45, 212, 191, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Mint Breeze";
            --theme-icon: "üåä";
        }

        /* Theme 6: Lavender Mist (Dark with White Text) */
        [data-theme="purplegrey"] {
            --bg-primary: #241838;
            --bg-secondary: #2e2042;
            --bg-card: #38284c;
            --bg-card-hover: #423056;
            --text-primary: #faf7ff;
            --text-secondary: #f3e8ff;
            --text-muted: #c4b5fd;
            --accent-primary: #a855f7;
            --accent-secondary: #c4b5fd;
            --accent-warm: #fbbf24;
            --border-color: #423056;
            --shadow-light: rgba(168, 85, 247, 0.1);
            --shadow-medium: rgba(168, 85, 247, 0.2);
            --shadow-strong: rgba(168, 85, 247, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Lavender Mist";
            --theme-icon: "üíú";
        }

        /* Theme 7: Warm Taupe (Dark with White Text) */
        [data-theme="browngrey"] {
            --bg-primary: #1c1917;
            --bg-secondary: #292524;
            --bg-card: #3f3f46;
            --bg-card-hover: #52525b;
            --text-primary: #fafaf9;
            --text-secondary: #e7e5e4;
            --text-muted: #d6d3d1;
            --accent-primary: #a3a3a3;
            --accent-secondary: #d6d3d1;
            --accent-warm: #f59e0b;
            --border-color: #52525b;
            --shadow-light: rgba(163, 163, 163, 0.1);
            --shadow-medium: rgba(163, 163, 163, 0.2);
            --shadow-strong: rgba(163, 163, 163, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Warm Taupe";
            --theme-icon: "ü§é";
        }

        /* Theme 8: Sage Olive (Dark with White Text) */
        [data-theme="greenbrown"] {
            --bg-primary: #1a2e05;
            --bg-secondary: #253a0a;
            --bg-card: #30460f;
            --bg-card-hover: #3b5314;
            --text-primary: #f7f8f3;
            --text-secondary: #e8f5e8;
            --text-muted: #bef264;
            --accent-primary: #84cc16;
            --accent-secondary: #bef264;
            --accent-warm: #f59e0b;
            --border-color: #3b5314;
            --shadow-light: rgba(132, 204, 22, 0.1);
            --shadow-medium: rgba(132, 204, 22, 0.2);
            --shadow-strong: rgba(132, 204, 22, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --theme-name: "Sage Olive";
            --theme-icon: "üåø";
        }

        /* Base Styles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            font-size: 16px;
            line-height: 1.6;
            transition: all 0.5s ease;
        }
        
        /* Mobile Layout Container */
        .mobile-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--bg-primary);
            transition: all 0.5s ease;
        }
        
        /* Enhanced Status Bar with Voice Indicators */
        .status-bar {
            height: 44px;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: 0 2px 10px var(--shadow-medium);
            border-bottom: 1px solid var(--border-color);
            transition: all 0.5s ease;
        }
        
        .voice-status-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--accent-primary);
            font-size: 12px;
        }
        
        .voice-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }
        
        .voice-indicator.listening {
            background: var(--warning);
            animation: pulse-fast 0.5s infinite;
        }
        
        .voice-indicator.speaking {
            background: var(--info);
            animation: pulse-speak 0.8s infinite;
        }
        
        .theme-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .theme-toggle {
            background: var(--accent-primary);
            border: none;
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .theme-toggle:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
        }
        
        .theme-picker-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .theme-picker-btn:hover {
            transform: scale(1.05);
        }
        
        /* Enhanced Header with Voice Integration */
        .header {
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 44px;
            left: 0;
            right: 0;
            z-index: 90;
            box-shadow: 0 4px 20px var(--shadow-medium);
            transition: all 0.5s ease;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .app-logo {
            width: 54px;
            height: 54px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 25px var(--shadow-medium);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .app-logo:hover {
            transform: scale(1.05);
        }
        
        .app-logo.voice-active::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            animation: spin 3s linear infinite;
        }
        
        .app-title h1 {
            font-size: 18px;
            font-weight: 700;
            line-height: 1.1;
            letter-spacing: -0.5px;
            margin-bottom: 2px;
            color: var(--text-primary);
            transition: all 0.5s ease;
        }
        
        .app-title p {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: all 0.5s ease;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            box-shadow: 0 4px 15px var(--shadow-medium);
            position: relative;
        }
        
        .header-btn:hover {
            transform: translateY(-2px);
        }
        
        .header-btn.voice-active {
            animation: glow-pulse 2s infinite;
        }

        /* ADVANCED VOICE AI ASSISTANT STYLES */
        .voice-assistant {
            position: fixed;
            bottom: 140px;
            right: 20px;
            z-index: 200;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 12px;
        }

        .voice-chat-bubble {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 16px 20px;
            border-radius: 20px 20px 8px 20px;
            max-width: 320px;
            font-size: 14px;
            line-height: 1.4;
            box-shadow: 0 8px 32px var(--shadow-strong);
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.4s ease;
            position: relative;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .voice-chat-bubble.show {
            transform: translateY(0);
            opacity: 1;
        }

        .voice-chat-bubble.typing {
            animation: typing-dots 1.5s infinite;
        }

        .voice-chat-bubble::before {
            content: '';
            position: absolute;
            bottom: -8px;
            right: 16px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid var(--accent-primary);
        }

        .voice-assistant-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 32px;
            box-shadow: 0 8px 25px var(--shadow-strong);
            position: relative;
            overflow: hidden;
        }

        .voice-assistant-btn:hover {
            transform: scale(1.1);
        }

        .voice-assistant-btn.listening {
            animation: pulse-listening 1.5s infinite;
            box-shadow: 0 0 30px var(--accent-primary);
        }

        .voice-assistant-btn.speaking {
            animation: pulse-speaking 0.8s infinite;
            box-shadow: 0 0 40px var(--info);
        }

        .voice-assistant-btn.thinking {
            animation: thinking-pulse 2s infinite;
        }

        .voice-status-indicator {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--success);
            border: 3px solid white;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Advanced Voice Controls Panel */
        .voice-controls {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            padding: 32px;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            z-index: 300;
            display: none;
            min-width: 380px;
            text-align: center;
        }

        .voice-controls.show {
            display: block;
            animation: scaleIn 0.3s ease;
        }

        .voice-controls-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .voice-controls-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .voice-waveform {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            margin: 24px 0;
            height: 50px;
        }

        .voice-wave-bar {
            width: 6px;
            background: var(--accent-primary);
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .voice-wave-bar.active {
            animation: wave-animation 1.5s infinite ease-in-out;
        }

        .voice-command-suggestions {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
        }

        .voice-command-item {
            padding: 12px 16px;
            margin: 8px 0;
            background: var(--bg-card);
            border-radius: 12px;
            font-size: 14px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .voice-command-item:hover {
            background: var(--accent-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        /* Voice Tutorial Overlay */
        .voice-tutorial {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 400;
            backdrop-filter: blur(10px);
        }

        .voice-tutorial.show {
            display: flex;
        }

        .voice-tutorial-content {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            max-height: 90vh;
            overflow-y: auto;
        }

        .voice-tutorial-steps {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin: 30px 0;
        }

        .voice-tutorial-step {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .voice-tutorial-step:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }

        .voice-tutorial-step-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        /* Mobile Voice Interface */
        .mobile-voice-overlay {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-color);
            padding: 20px;
            transform: translateY(100%);
            transition: all 0.4s ease;
            z-index: 250;
            display: none;
        }

        .mobile-voice-overlay.show {
            transform: translateY(0);
            display: block;
        }

        .mobile-voice-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .mobile-voice-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 24px;
            box-shadow: 0 4px 15px var(--shadow-medium);
        }

        .mobile-voice-status {
            flex: 1;
            text-align: center;
            padding: 0 20px;
        }

        .mobile-voice-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .mobile-voice-subtext {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* Voice Onboarding */
        .voice-onboarding {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 500;
            backdrop-filter: blur(15px);
        }

        .voice-onboarding.show {
            display: flex;
        }

        .voice-onboarding-content {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            animation: slideUpFade 0.5s ease;
        }

        .voice-personality-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 24px 0;
        }

        .personality-option {
            padding: 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .personality-option:hover,
        .personality-option.selected {
            border-color: var(--accent-primary);
            background: var(--shadow-light);
            transform: translateY(-2px);
        }

        .personality-icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .personality-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .personality-desc {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        /* Enhanced Main Content */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 130px 20px 140px;
            -webkit-overflow-scrolling: touch;
            position: relative;
            height: calc(100vh - 44px);
            scroll-behavior: smooth;
            transition: all 0.5s ease;
        }
        
        .main-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 3px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 3px;
        }
        
        /* Enhanced Cards with Voice Integration */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px var(--shadow-light);
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: 0 12px 40px var(--shadow-medium);
            transform: translateY(-2px);
        }

        .card.voice-highlighted {
            border-color: var(--accent-primary);
            box-shadow: 0 0 30px var(--shadow-strong);
            animation: glow-pulse 2s infinite;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.8s;
        }

        .card.voice-highlighted::before {
            left: 100%;
        }

        /* Voice-Enhanced Form Styles */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .voice-form-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .voice-form-btn:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--shadow-light);
        }

        .form-input.voice-dictating {
            border-color: var(--warning);
            box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.2);
            animation: pulse-border 1s infinite;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Modal Styles with Voice Integration */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 300;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(10px);
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            transition: all 0.5s ease;
        }
        
        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            border-radius: 24px 24px 0 0;
        }
        
        .modal-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-voice-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 12px;
        }
        
        .modal-close-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: var(--bg-card);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }
        
        .modal-close-btn:hover {
            background: var(--error);
            color: white;
            transform: scale(1.1);
        }
        
        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Theme Selector Modal with Voice */
        .theme-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 300;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .theme-modal.show {
            display: flex;
        }
        
        .theme-modal-content {
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px var(--shadow-strong);
            transition: all 0.5s ease;
        }
        
        .theme-modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            border-radius: 24px 24px 0 0;
        }
        
        .theme-modal-header h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .theme-close-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            border: none;
            background: var(--bg-card);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }
        
        .theme-close-btn:hover {
            background: var(--error);
            color: white;
            transform: scale(1.1);
        }
        
        .theme-modal-body {
            padding: 24px;
        }
        
        /* Enhanced Theme Grid with Voice */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }
        
        @media (min-width: 480px) {
            .theme-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
            }
        }
        
        .theme-option {
            background: var(--bg-secondary);
            border: 3px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .theme-option:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px var(--shadow-medium);
        }
        
        .theme-option.active {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--shadow-strong);
            transform: scale(1.05);
        }
        
        .theme-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }
        
        .theme-option:hover::before {
            left: 100%;
        }

        .theme-option-voice-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            border: none;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .theme-option-voice-btn:hover {
            transform: scale(1.2);
        }
        
        .theme-preview {
            width: 100%;
            height: 80px;
            border-radius: 12px;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .theme-preview.red {
            background: linear-gradient(135deg, #2d1517, #f87171);
        }
        
        .theme-preview.orange {
            background: linear-gradient(135deg, #2d1b0f, #fb923c);
        }
        
        .theme-preview.pink {
            background: linear-gradient(135deg, #2d1524, #f472b6);
        }
        
        .theme-preview.yellow {
            background: linear-gradient(135deg, #2d2510, #fbbf24);
        }
        
        .theme-preview.bluegreen {
            background: linear-gradient(135deg, #0f2925, #2dd4bf);
        }
        
        .theme-preview.purplegrey {
            background: linear-gradient(135deg, #241838, #a855f7);
        }
        
        .theme-preview.browngrey {
            background: linear-gradient(135deg, #1c1917, #a3a3a3);
        }
        
        .theme-preview.greenbrown {
            background: linear-gradient(135deg, #1a2e05, #84cc16);
        }
        
        .theme-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .theme-description {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .theme-icon {
            position: absolute;
            top: 8px;
            left: 8px;
            font-size: 20px;
            opacity: 0.8;
        }
        
        /* Mode Toggle */
        .mode-toggle-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 16px;
        }
        
        .mode-toggle-btn {
            background: var(--accent-primary);
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .mode-toggle-btn:hover {
            background: var(--accent-secondary);
            transform: scale(1.05);
        }
        
        /* Enhanced Buttons with Voice */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px 24px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 52px;
            text-decoration: none;
            box-shadow: 0 4px 12px var(--shadow-light);
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        
        .btn:active {
            transform: scale(0.96);
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }

        .btn-voice {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
            position: relative;
        }

        .btn-voice.listening {
            animation: pulse-listening 1.5s infinite;
        }
        
        .btn-primary { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
        }
        .btn-success { 
            background: linear-gradient(135deg, var(--success), #34d399); 
        }
        .btn-secondary { 
            background: linear-gradient(135deg, var(--text-secondary), #9ca3af); 
        }
        .btn-warning { 
            background: linear-gradient(135deg, var(--warning), #fbbf24); 
        }
        .btn-danger { 
            background: linear-gradient(135deg, var(--error), #f87171); 
        }
        
        /* Voice-Enhanced Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px 0;
        }
        
        .quick-btn {
            padding: 16px 12px;
            border-radius: 16px;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 80px;
            box-shadow: 0 4px 12px var(--shadow-light);
            position: relative;
            overflow: hidden;
        }
        
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        
        .quick-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .quick-btn:hover::before {
            left: 100%;
        }

        .quick-btn-voice {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            color: white;
            border: none;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .quick-btn-voice:hover {
            background: rgba(255,255,255,0.6);
            transform: scale(1.2);
        }
        
        .quick-btn.primary { 
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
        }
        .quick-btn.success { 
            background: linear-gradient(135deg, var(--success), #34d399); 
        }
        .quick-btn.info { 
            background: linear-gradient(135deg, var(--info), #60a5fa); 
        }
        
        .quick-btn .icon {
            font-size: 24px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .quick-btn .label {
            font-size: 12px;
            text-align: center;
            line-height: 1.2;
        }
        
        /* Voice-Enhanced Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: 18px;
            padding: 20px 16px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 16px var(--shadow-light);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }

        .stat-card.voice-reading {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--shadow-strong);
            animation: glow-pulse 2s infinite;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, var(--shadow-light) 0%, transparent 70%);
            transform: rotate(45deg);
        }

        .stat-card-voice-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            border: none;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .stat-card:hover .stat-card-voice-btn {
            opacity: 1;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            line-height: 1;
            color: var(--accent-primary);
            position: relative;
            z-index: 2;
        }

        /* Data List with Voice */
        .data-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .data-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .data-item:hover {
            box-shadow: 0 4px 16px var(--shadow-light);
            transform: translateY(-1px);
        }

        .data-item-voice-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            border: none;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .data-item:hover .data-item-voice-btn {
            opacity: 1;
        }

        .data-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .data-item-title {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 16px;
        }

        .data-item-amount {
            font-weight: 800;
            color: var(--accent-primary);
            font-size: 18px;
        }

        .data-item-details {
            color: var(--text-muted);
            font-size: 14px;
            line-height: 1.4;
        }

        .data-item-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .data-item-date {
            font-size: 12px;
            color: var(--text-muted);
        }

        .data-item-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-draft {
            background: #f3f4f6;
            color: #374151;
        }

        .status-sent {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .status-paid {
            background: #d1fae5;
            color: #059669;
        }

        .status-overdue {
            background: #fee2e2;
            color: #dc2626;
        }
        
        /* Enhanced Bottom Navigation with Voice */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-color);
            padding: 12px 20px 32px;
            z-index: 100;
            box-shadow: 0 -4px 20px var(--shadow-medium);
            transition: all 0.5s ease;
        }
        
        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            border-radius: 16px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 60px;
            position: relative;
        }
        
        .nav-item.active {
            color: var(--accent-primary);
            background: var(--shadow-light);
            box-shadow: 0 2px 8px var(--shadow-light);
            transform: scale(1.05);
        }
        
        .nav-item:hover {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }
        
        .nav-item .icon {
            font-size: 24px;
            transition: all 0.3s ease;
        }
        
        .nav-item.active .icon {
            transform: scale(1.2);
        }

        .nav-item.voice-active {
            animation: glow-pulse 2s infinite;
        }

        .nav-voice-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .nav-item.voice-active .nav-voice-indicator {
            opacity: 1;
            animation: pulse 1.5s infinite;
        }
        
        .home-indicator {
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 2px;
            width: 140px;
            margin: 12px auto 0;
            opacity: 0.8;
        }
        
        /* Success Message with Voice */
        .success-message {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 16px 24px;
            border-radius: 16px;
            font-weight: 600;
            box-shadow: 0 8px 35px var(--shadow-strong);
            z-index: 250;
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            transition: all 0.3s ease;
            max-width: 90%;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .success-message.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .success-message.voice-active {
            animation: glow-pulse 2s infinite;
        }

        /* Voice-specific animations */
        @keyframes pulse-listening {
            0% { box-shadow: 0 0 0 0 rgba(251, 146, 60, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(251, 146, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(251, 146, 60, 0); }
        }

        @keyframes pulse-speaking {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes thinking-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes wave-animation {
            0%, 100% { height: 8px; }
            50% { height: 32px; }
        }

        @keyframes glow-pulse {
            0%, 100% { box-shadow: 0 0 5px var(--accent-primary); }
            50% { box-shadow: 0 0 20px var(--accent-primary), 0 0 30px var(--accent-primary); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes pulse-fast {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes pulse-speak {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @keyframes pulse-border {
            0%, 100% { border-color: var(--warning); }
            50% { border-color: var(--accent-primary); }
        }

        @keyframes typing-dots {
            0%, 20% { opacity: 0; }
            50% { opacity: 1; }
            80%, 100% { opacity: 0; }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes scaleIn {
            from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes slideUpFade {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        .theme-preview.rainbow {
            animation: rainbow 3s linear infinite;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .view {
            padding-top: 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--text-primary);
            transition: all 0.5s ease;
        }

        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: 700;
            margin-right: 16px;
        }

        .company-logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            font-weight: 700;
            margin: 0 auto 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .company-logo:hover {
            transform: scale(1.05);
        }

        .profile-section {
            display: flex;
            align-items: center;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .profile-info h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .profile-info p {
            color: var(--text-muted);
            font-size: 14px;
        }

        .info-grid {
            display: grid;
            gap: 16px;
            margin: 20px 0;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .info-content h4 {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .info-content p {
            color: var(--text-muted);
            font-size: 14px;
        }
        
        /* Mobile Optimizations */
        @media screen and (max-width: 768px) {
            .theme-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .header-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .modal-content {
                margin: 20px;
                max-height: calc(100vh - 40px);
            }

            .voice-assistant {
                bottom: 120px;
                right: 16px;
            }

            .voice-chat-bubble {
                max-width: 280px;
                font-size: 13px;
            }

            .voice-assistant-btn {
                width: 60px;
                height: 60px;
                font-size: 28px;
            }

            .voice-controls {
                margin: 20px;
                min-width: auto;
                width: calc(100% - 40px);
            }

            .voice-tutorial-content {
                margin: 20px;
                padding: 30px;
            }

            .voice-onboarding-content {
                margin: 20px;
                padding: 30px;
            }

            .personality-option {
                padding: 12px;
            }

            .personality-icon {
                font-size: 24px;
            }
        }
        
        /* Safe Area Adjustments */
        @supports (padding: max(0px)) {
            .status-bar {
                padding-top: env(safe-area-inset-top);
                height: calc(44px + env(safe-area-inset-top));
            }
            
            .bottom-nav {
                padding-bottom: calc(32px + env(safe-area-inset-bottom));
            }

            .voice-assistant {
                bottom: calc(140px + env(safe-area-inset-bottom));
            }

            .mobile-voice-overlay {
                padding-bottom: calc(20px + env(safe-area-inset-bottom));
            }
        }

        /* Accessibility Enhancements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .card, .modal-content, .voice-controls {
                border-width: 2px;
            }
            
            .btn, .voice-assistant-btn {
                border: 2px solid white;
            }
        }

        /* Dark mode preference detection */
        @media (prefers-color-scheme: dark) {
            body {
                background: var(--bg-primary);
                color: var(--text-primary);
            }
        }
    </style>
</head>
<body data-theme="red" data-mode="light">
    <div class="mobile-container">
        <!-- Enhanced Status Bar with Voice Status -->
        <div class="status-bar">
            <div class="time" id="status-time">9:41</div>
            <div class="voice-status-bar" id="voice-status-bar">
                <div class="voice-indicator" id="voice-status-indicator"></div>
                <span id="voice-status-text">Claude Ready</span>
            </div>
            <div class="theme-selector">
                <button class="theme-picker-btn" onclick="openThemePicker()" id="theme-picker-btn">
                    <span id="current-theme-icon">üåÖ</span> Themes
                </button>
                <button class="theme-toggle" onclick="toggleMode()" id="mode-toggle">üåë Darker</button>
                <span>üì∂</span>
                <span>üì±</span>
                <span>üîã</span>
            </div>
        </div>
        
        <!-- Enhanced Header with Voice Integration -->
        <div class="header">
            <div class="logo-container">
                <div class="app-logo" id="app-logo" onclick="speakAppIntro()">üåÖ</div>
                <div class="app-title">
                    <h1 id="company-name">REFIT VOICE AI SYSTEM</h1>
                    <p id="company-subtitle">Claude Speaks Everything! Complete Voice Business Solution</p>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="openThemePickerWithVoice()" title="Voice Theme Selector" id="voice-theme-btn">üé®</button>
                <button class="header-btn" onclick="showProfileWithVoice()" title="Voice Profile" id="voice-profile-btn">üë§</button>
                <button class="header-btn voice-active" onclick="toggleVoiceAssistant()" title="Voice Assistant" id="voice-header-btn">üé§</button>
            </div>
        </div>

        <!-- Main Content with Voice Integration -->
        <div class="main-content" id="main-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view">
                <!-- Revolutionary Voice Welcome -->
                <div class="card voice-highlighted" style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); color: white; border: none;">
                    <div style="text-align: center;">
                        <div style="font-size: 64px; margin-bottom: 20px; animation: glow-pulse 3s infinite;">üé§‚ú®</div>
                        <h2 style="margin-bottom: 16px; font-weight: 800; font-size: 24px;">Welcome to REFIT Voice AI!</h2>
                        <p style="margin-bottom: 24px; opacity: 0.95; font-size: 16px; line-height: 1.6;">
                            üó£Ô∏è <strong>Claude speaks EVERYTHING!</strong> I can narrate your data, guide you through forms, explain features, 
                            and have natural conversations about your business. This is the future of voice-powered business management!
                        </p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                            <button class="btn" onclick="startVoiceOnboarding()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
                                üé§ Voice Onboarding
                            </button>
                            <button class="btn" onclick="startVoiceTour()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
                                üó£Ô∏è Complete Tour
                            </button>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <button class="btn" onclick="toggleVoiceAssistant()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
                                üéß Start Talking
                            </button>
                            <button class="btn" onclick="demoVoiceFeatures()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
                                ‚ú® Voice Demo
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Voice-Enhanced User Profile Section -->
                <div class="card" onclick="highlightAndSpeak(this, 'This is your user profile section. Here you can view and edit your personal information including your name, title, and contact details.')">
                    <div class="profile-section">
                        <div class="avatar" id="user-avatar">JD</div>
                        <div class="profile-info">
                            <h3 id="user-display-name">John Doe</h3>
                            <p id="user-display-title">Business Owner</p>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: center;">
                        <button class="btn btn-primary" onclick="editProfileWithVoice()" style="width: 100%;">
                            ‚úèÔ∏è Edit Profile
                        </button>
                        <button class="btn-voice" onclick="speakProfileInfo()" title="Speak Profile Info">üó£Ô∏è</button>
                    </div>
                </div>

                <!-- Voice-Enhanced Company Info -->
                <div class="card" onclick="highlightAndSpeak(this, 'This is your company information section. You can manage your business details, logo, and company settings here.')">
                    <div style="text-align: center;">
                        <div class="company-logo" id="company-logo" onclick="speakCompanyInfo()">üåÖ</div>
                        <h3 id="company-display-name" style="font-weight: 700; margin-bottom: 8px; color: var(--text-primary); cursor: pointer;" onclick="speakCompanyInfo()">Your Company Name</h3>
                        <p id="company-display-tagline" style="color: var(--text-muted); margin-bottom: 16px;">Professional Services</p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px;">
                        <button class="btn btn-success" onclick="editCompanyWithVoice()" style="font-size: 14px; padding: 12px;">
                            ‚úèÔ∏è Edit Details
                        </button>
                        <button class="btn btn-primary" onclick="openCompanyManagerWithVoice()" style="font-size: 14px; padding: 12px;">
                            üè¢ Company Hub
                        </button>
                        <button class="btn-voice" onclick="speakCompanyDetails()" title="Speak Company Details">üó£Ô∏è</button>
                    </div>
                </div>

                <!-- Voice-Enhanced Stats with Individual Speakers -->
                <div class="stats-grid">
                    <div class="stat-card" onclick="speakStat('quotes', 'total-quotes-count')">
                        <div class="stat-label">Total Quotes</div>
                        <div class="stat-value" id="total-quotes-count">0</div>
                        <button class="stat-card-voice-btn" onclick="speakStat('quotes', 'total-quotes-count')" title="Speak Quote Stats">üó£Ô∏è</button>
                    </div>
                    <div class="stat-card" onclick="speakStat('customers', 'total-customers-count')">
                        <div class="stat-label">Total Customers</div>
                        <div class="stat-value" id="total-customers-count">0</div>
                        <button class="stat-card-voice-btn" onclick="speakStat('customers', 'total-customers-count')" title="Speak Customer Stats">üó£Ô∏è</button>
                    </div>
                    <div class="stat-card" onclick="speakStat('monthly revenue', 'monthly-revenue')">
                        <div class="stat-label">Monthly Revenue</div>
                        <div class="stat-value" id="monthly-revenue">RM 0</div>
                        <button class="stat-card-voice-btn" onclick="speakStat('monthly revenue', 'monthly-revenue')" title="Speak Monthly Revenue">üó£Ô∏è</button>
                    </div>
                    <div class="stat-card" onclick="speakStat('total revenue', 'total-revenue')">
                        <div class="stat-label">Total Revenue</div>
                        <div class="stat-value" id="total-revenue">RM 0</div>
                        <button class="stat-card-voice-btn" onclick="speakStat('total revenue', 'total-revenue')" title="Speak Total Revenue">üó£Ô∏è</button>
                    </div>
                </div>

                <!-- Voice-Enhanced Quick Actions -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üöÄ Quick Actions</h3>
                        <button class="btn-voice" onclick="speakQuickActions()" title="Speak Quick Actions">üó£Ô∏è</button>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-btn primary" onclick="createQuoteWithVoice()" style="position: relative;">
                            <span class="icon">üìã</span>
                            <span class="label">New Quote</span>
                            <button class="quick-btn-voice" onclick="speakFeature('quote creation')" title="Speak about quotes">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn success" onclick="addCustomerWithVoice()" style="position: relative;">
                            <span class="icon">üë•</span>
                            <span class="label">Add Customer</span>
                            <button class="quick-btn-voice" onclick="speakFeature('customer management')" title="Speak about customers">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn info" onclick="viewReportsWithVoice()" style="position: relative;">
                            <span class="icon">üìä</span>
                            <span class="label">Reports</span>
                            <button class="quick-btn-voice" onclick="speakFeature('business reports')" title="Speak about reports">üó£Ô∏è</button>
                        </button>
                    </div>
                </div>

                <!-- Voice Commands Help - Enhanced -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üé§ Voice Commands</h3>
                        <button class="btn-voice" onclick="speakAllVoiceCommands()" title="Speak All Commands">üó£Ô∏è</button>
                    </div>
                    <div class="voice-command-suggestions">
                        <div class="voice-command-item" onclick="simulateVoiceCommand('create new quote')">üí¨ "Create a new quote"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('add customer')">üí¨ "Add a new customer"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('switch theme')">üí¨ "Switch to peach theme"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('show stats')">üí¨ "Tell me my business stats"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('read profile')">üí¨ "Read my profile information"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('help')">üí¨ "Help me with quotes"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('export data')">üí¨ "Export my business data"</div>
                        <div class="voice-command-item" onclick="simulateVoiceCommand('tutorial')">üí¨ "Start voice tutorial"</div>
                    </div>
                </div>

                <!-- Voice-Enhanced Recent Activity -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üìà Recent Activity</h3>
                        <button class="btn-voice" onclick="speakRecentActivity()" title="Speak Recent Activity">üó£Ô∏è</button>
                    </div>
                    <div id="recent-activity" class="data-list">
                        <!-- Recent items will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Voice-Enhanced Quotes View -->
            <div id="quotes-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">üìã Quotes</h2>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <button class="btn-voice" onclick="speakViewInfo('quotes')" title="Speak About Quotes">üó£Ô∏è</button>
                        <button class="btn btn-primary" onclick="createQuoteWithVoice()">‚ûï New Quote</button>
                    </div>
                </div>
                <div id="quotes-list" class="data-list">
                    <!-- Quotes will be populated here -->
                </div>
            </div>

            <!-- Voice-Enhanced Customers View -->
            <div id="customers-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">üë• Customers</h2>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <button class="btn-voice" onclick="speakViewInfo('customers')" title="Speak About Customers">üó£Ô∏è</button>
                        <button class="btn btn-primary" onclick="addCustomerWithVoice()">‚ûï Add Customer</button>
                    </div>
                </div>
                <div id="customers-list" class="data-list">
                    <!-- Customers will be populated here -->
                </div>
            </div>

            <!-- Voice-Enhanced Settings View -->
            <div id="settings-view" class="view hidden">
                <div class="section-header">
                    <h2 class="section-title">‚öôÔ∏è Settings</h2>
                    <button class="btn-voice" onclick="speakViewInfo('settings')" title="Speak About Settings">üó£Ô∏è</button>
                </div>

                <!-- Advanced Voice AI Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üé§ Advanced Voice AI Settings</h3>
                        <button class="btn-voice" onclick="speakVoiceSettings()" title="Speak Voice Settings">üó£Ô∏è</button>
                    </div>
                    <div class="info-grid">
                        <div class="info-item" onclick="speakAboutVoiceFeature('assistant')">
                            <div class="info-icon">üó£Ô∏è</div>
                            <div class="info-content">
                                <h4>Voice Assistant</h4>
                                <p id="voice-status">Claude AI Ready</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutVoiceFeature('recognition')">
                            <div class="info-icon">üéØ</div>
                            <div class="info-content">
                                <h4>Voice Recognition</h4>
                                <p id="voice-recognition">Active & Learning</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutVoiceFeature('synthesis')">
                            <div class="info-icon">üîä</div>
                            <div class="info-content">
                                <h4>Speech Synthesis</h4>
                                <p id="voice-synthesis">Natural Voice Active</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutVoiceFeature('personality')">
                            <div class="info-icon">ü§ñ</div>
                            <div class="info-content">
                                <h4>AI Personality</h4>
                                <p id="ai-personality">Professional & Friendly</p>
                            </div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px;">
                        <button class="quick-btn info" onclick="testVoiceAssistant()">
                            <span class="icon">üß™</span>
                            <span class="label">Test Voice</span>
                        </button>
                        <button class="quick-btn primary" onclick="startVoiceTour()">
                            <span class="icon">üó£Ô∏è</span>
                            <span class="label">Voice Tour</span>
                        </button>
                        <button class="quick-btn success" onclick="customizeVoicePersonality()">
                            <span class="icon">üé≠</span>
                            <span class="label">Personality</span>
                        </button>
                    </div>
                </div>

                <!-- Voice-Enhanced Data Management -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üíæ Data Management</h3>
                        <button class="btn-voice" onclick="speakDataManagement()" title="Speak Data Info">üó£Ô∏è</button>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                        <button class="quick-btn primary" onclick="createManualBackupWithVoice()">
                            <span class="icon">üíæ</span>
                            <span class="label">Create Backup</span>
                        </button>
                        <button class="quick-btn success" onclick="exportAllDataWithVoice()">
                            <span class="icon">üì§</span>
                            <span class="label">Export Data</span>
                        </button>
                        <button class="quick-btn info" onclick="importDataFileWithVoice()">
                            <span class="icon">üì•</span>
                            <span class="label">Import Data</span>
                        </button>
                        <button class="quick-btn" onclick="clearAllDataWithVoice()" style="background: linear-gradient(135deg, #ef4444, #f87171);">
                            <span class="icon">üóëÔ∏è</span>
                            <span class="label">Clear All</span>
                        </button>
                    </div>
                </div>

                <!-- Voice-Enhanced Theme Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üé® Theme Settings</h3>
                        <button class="btn-voice" onclick="speakThemeInfo()" title="Speak Theme Info">üó£Ô∏è</button>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                        <button class="quick-btn" onclick="switchToThemeWithVoice('red')" style="background: linear-gradient(135deg, #f87171, #fca5a5); position: relative;">
                            <span class="icon">üåÖ</span>
                            <span class="label">Coral Sunset</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('red')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('orange')" style="background: linear-gradient(135deg, #fb923c, #fdba74); position: relative;">
                            <span class="icon">üçë</span>
                            <span class="label">Peach Glow</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('orange')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('pink')" style="background: linear-gradient(135deg, #f472b6, #f9a8d4); position: relative;">
                            <span class="icon">üå∏</span>
                            <span class="label">Rose Blush</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('pink')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('yellow')" style="background: linear-gradient(135deg, #fbbf24, #fcd34d); position: relative;">
                            <span class="icon">üåª</span>
                            <span class="label">Butter Cream</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('yellow')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('bluegreen')" style="background: linear-gradient(135deg, #2dd4bf, #7dd3fc); position: relative;">
                            <span class="icon">üåä</span>
                            <span class="label">Mint Breeze</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('bluegreen')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('purplegrey')" style="background: linear-gradient(135deg, #a855f7, #c4b5fd); position: relative;">
                            <span class="icon">üíú</span>
                            <span class="label">Lavender Mist</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('purplegrey')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('browngrey')" style="background: linear-gradient(135deg, #a3a3a3, #d6d3d1); position: relative;">
                            <span class="icon">ü§é</span>
                            <span class="label">Warm Taupe</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('browngrey')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                        <button class="quick-btn" onclick="switchToThemeWithVoice('greenbrown')" style="background: linear-gradient(135deg, #84cc16, #bef264); position: relative;">
                            <span class="icon">üåø</span>
                            <span class="label">Sage Olive</span>
                            <button class="quick-btn-voice" onclick="speakThemeDescription('greenbrown')" title="Speak Theme">üó£Ô∏è</button>
                        </button>
                    </div>
                </div>

                <!-- Voice-Enhanced App Settings -->
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-weight: 700; font-size: 18px; color: var(--text-primary);">üì± App Settings</h3>
                        <button class="btn-voice" onclick="speakAppSettings()" title="Speak App Settings">üó£Ô∏è</button>
                    </div>
                    <div class="info-grid">
                        <div class="info-item" onclick="speakAboutSetting('ai assistant')">
                            <div class="info-icon">üé§</div>
                            <div class="info-content">
                                <h4>AI Assistant</h4>
                                <p id="ai-assistant-status">Claude Voice AI Active</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutSetting('voice notifications')">
                            <div class="info-icon">üîî</div>
                            <div class="info-content">
                                <h4>Voice Notifications</h4>
                                <p id="voice-notifications">Enabled & Speaking</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutSetting('theme variant')">
                            <div class="info-icon">üåë</div>
                            <div class="info-content">
                                <h4>Theme Variant</h4>
                                <p id="current-mode-setting">Standard Dark Theme Active</p>
                            </div>
                        </div>
                        <div class="info-item" onclick="speakAboutSetting('app version')">
                            <div class="info-icon">üîß</div>
                            <div class="info-content">
                                <h4>App Version</h4>
                                <p id="app-version">REFIT Voice AI v3.0 - Claude Everywhere!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ADVANCED VOICE ASSISTANT FLOATING INTERFACE -->
        <div class="voice-assistant" id="voice-assistant">
            <div class="voice-chat-bubble" id="voice-chat-bubble">
                üëã Hi! I'm Claude, your AI assistant. I can speak everything in this app! Click me to start talking, or just ask me anything about your business!
            </div>
            <button class="voice-assistant-btn" id="voice-assistant-btn" onclick="toggleVoiceListening()">
                üé§
                <div class="voice-status-indicator" id="voice-status-indicator">üü¢</div>
            </button>
        </div>

        <!-- Advanced Voice Controls Panel -->
        <div class="voice-controls" id="voice-controls">
            <div class="voice-controls-header">
                <div class="voice-controls-avatar">üé§</div>
                <div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">Claude Voice Assistant</h3>
                    <p style="color: var(--text-muted); margin-bottom: 0;" id="voice-status-text">Listening for your command...</p>
                </div>
            </div>
                
            <div class="voice-waveform" id="voice-waveform">
                <div class="voice-wave-bar" style="height: 8px;"></div>
                <div class="voice-wave-bar" style="height: 16px;"></div>
                <div class="voice-wave-bar" style="height: 12px;"></div>
                <div class="voice-wave-bar" style="height: 20px;"></div>
                <div class="voice-wave-bar" style="height: 6px;"></div>
                <div class="voice-wave-bar" style="height: 14px;"></div>
                <div class="voice-wave-bar" style="height: 10px;"></div>
                <div class="voice-wave-bar" style="height: 18px;"></div>
                <div class="voice-wave-bar" style="height: 24px;"></div>
                <div class="voice-wave-bar" style="height: 8px;"></div>
            </div>

            <div style="display: flex; gap: 12px; justify-content: center; margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="stopVoiceListening()">üõë Stop</button>
                <button class="btn btn-secondary" onclick="closeVoiceControls()">‚úï Close</button>
                <button class="btn btn-success" onclick="demoVoiceFeatures()">‚ú® Demo</button>
            </div>

            <div class="voice-command-suggestions">
                <h4 style="margin-bottom: 12px; color: var(--text-primary); text-align: center;">üí¨ Try saying:</h4>
                <div class="voice-command-item">"Read my business statistics"</div>
                <div class="voice-command-item">"Create a new quote for ABC Company"</div>
                <div class="voice-command-item">"Switch to peach glow theme"</div>
                <div class="voice-command-item">"Tell me about my customers"</div>
                <div class="voice-command-item">"Explain the quote process"</div>
                <div class="voice-command-item">"Read my profile information"</div>
                <div class="voice-command-item">"Export my business data"</div>
                <div class="voice-command-item">"Help me understand this app"</div>
                <div class="voice-command-item">"Start complete voice tour"</div>
                <div class="voice-command-item">"What can you do for me?"</div>
            </div>
        </div>

        <!-- Voice Onboarding Experience -->
        <div class="voice-onboarding" id="voice-onboarding">
            <div class="voice-onboarding-content">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 80px; margin-bottom: 20px;">üé§‚ú®</div>
                    <h2 style="margin-bottom: 16px; color: var(--text-primary);">Welcome to Voice AI!</h2>
                    <p style="color: var(--text-muted); font-size: 16px; line-height: 1.6;">
                        Let's set up your personalized voice assistant experience. Claude can speak everything in this app and understand natural conversation!
                    </p>
                </div>

                <div>
                    <h3 style="margin-bottom: 16px; color: var(--text-primary); text-align: center;">Choose Your AI Personality:</h3>
                    <div class="voice-personality-selector">
                        <div class="personality-option" onclick="selectPersonality('professional')" data-personality="professional">
                            <span class="personality-icon">ü§µ</span>
                            <div class="personality-name">Professional</div>
                            <div class="personality-desc">Formal & Business-focused</div>
                        </div>
                        <div class="personality-option selected" onclick="selectPersonality('friendly')" data-personality="friendly">
                            <span class="personality-icon">üòä</span>
                            <div class="personality-name">Friendly</div>
                            <div class="personality-desc">Warm & Conversational</div>
                        </div>
                        <div class="personality-option" onclick="selectPersonality('enthusiastic')" data-personality="enthusiastic">
                            <span class="personality-icon">üöÄ</span>
                            <div class="personality-name">Enthusiastic</div>
                            <div class="personality-desc">Energetic & Motivating</div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="skipVoiceOnboarding()">Skip Setup</button>
                    <button class="btn btn-primary" onclick="completeVoiceOnboarding()">üé§ Start Voice Experience</button>
                </div>
            </div>
        </div>

        <!-- Voice Tutorial Overlay -->
        <div class="voice-tutorial" id="voice-tutorial">
            <div class="voice-tutorial-content">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 64px; margin-bottom: 16px;">üé§‚ú®</div>
                    <h2 style="margin-bottom: 12px; color: var(--text-primary);">Voice AI Complete Tour</h2>
                    <p style="color: var(--text-muted);">Let me show you how Claude can speak and interact with every part of this business system</p>
                </div>

                <div class="voice-tutorial-steps">
                    <div class="voice-tutorial-step">
                        <div class="voice-tutorial-step-icon">1Ô∏è‚É£</div>
                        <div>
                            <h4 style="color: var(--text-primary); margin-bottom: 4px;">Voice Everywhere</h4>
                            <p style="color: var(--text-muted); font-size: 14px;">Claude can speak every piece of data, explain every feature, and narrate all business information</p>
                        </div>
                    </div>
                    <div class="voice-tutorial-step">
                        <div class="voice-tutorial-step-icon">2Ô∏è‚É£</div>
                        <div>
                            <h4 style="color: var(--text-primary); margin-bottom: 4px;">Natural Conversation</h4>
                            <p style="color: var(--text-muted); font-size: 14px;">Talk naturally like "Read my stats" or "Tell me about themes" - Claude understands context</p>
                        </div>
                    </div>
                    <div class="voice-tutorial-step">
                        <div class="voice-tutorial-step-icon">3Ô∏è‚É£</div>
                        <div>
                            <h4 style="color: var(--text-primary); margin-bottom: 4px;">Voice Navigation</h4>
                            <p style="color: var(--text-muted); font-size: 14px;">Navigate entirely by voice - "Go to customers", "Show quotes", "Open settings"</p>
                        </div>
                    </div>
                    <div class="voice-tutorial-step">
                        <div class="voice-tutorial-step-icon">4Ô∏è‚É£</div>
                        <div>
                            <h4 style="color: var(--text-primary); margin-bottom: 4px;">Smart Assistance</h4>
                            <p style="color: var(--text-muted); font-size: 14px;">Get voice help with forms, explanations, tutorials, and business guidance</p>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeVoiceTutorial()">Skip Tour</button>
                    <button class="btn btn-primary" onclick="startInteractiveVoiceTour()">üé§ Start Interactive Tour</button>
                </div>
            </div>
        </div>

        <!-- Mobile Voice Overlay -->
        <div class="mobile-voice-overlay" id="mobile-voice-overlay">
            <div class="mobile-voice-controls">
                <button class="mobile-voice-btn" onclick="toggleVoiceListening()">üé§</button>
                <div class="mobile-voice-status">
                    <div class="mobile-voice-text" id="mobile-voice-text">Claude Listening</div>
                    <div class="mobile-voice-subtext" id="mobile-voice-subtext">Speak your command now...</div>
                </div>
                <button class="mobile-voice-btn" onclick="closeMobileVoiceOverlay()">‚úï</button>
            </div>
            <div class="voice-waveform">
                <div class="voice-wave-bar" style="height: 12px;"></div>
                <div class="voice-wave-bar" style="height: 20px;"></div>
                <div class="voice-wave-bar" style="height: 16px;"></div>
                <div class="voice-wave-bar" style="height: 24px;"></div>
                <div class="voice-wave-bar" style="height: 8px;"></div>
                <div class="voice-wave-bar" style="height: 18px;"></div>
                <div class="voice-wave-bar" style="height: 14px;"></div>
            </div>
        </div>

        <!-- Enhanced Bottom Navigation with Voice -->
        <div class="bottom-nav">
            <div class="nav-items">
                <div class="nav-item active voice-active" onclick="showViewWithVoice('dashboard')">
                    <span class="icon">üè†</span>
                    <span>Home</span>
                    <div class="nav-voice-indicator"></div>
                </div>
                <div class="nav-item" onclick="showViewWithVoice('quotes')">
                    <span class="icon">üìã</span>
                    <span>Quotes</span>
                    <div class="nav-voice-indicator"></div>
                </div>
                <div class="nav-item" onclick="showViewWithVoice('customers')">
                    <span class="icon">üë•</span>
                    <span>Customers</span>
                    <div class="nav-voice-indicator"></div>
                </div>
                <div class="nav-item" onclick="showViewWithVoice('settings')">
                    <span class="icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                    <div class="nav-voice-indicator"></div>
                </div>
                <div class="nav-item voice-active" onclick="toggleVoiceAssistant()">
                    <span class="icon" id="voice-nav-icon">üé§</span>
                    <span id="voice-nav-text">Claude</span>
                    <div class="nav-voice-indicator"></div>
                </div>
            </div>
            <div class="home-indicator"></div>
        </div>
    </div>

    <!-- Enhanced Theme Selector Modal with Voice -->
    <div id="theme-modal" class="theme-modal">
        <div class="theme-modal-content">
            <div class="theme-modal-header">
                <h3>
                    <span>üé®</span>
                    <span>Voice-Guided Theme Selection</span>
                </h3>
                <button class="modal-voice-btn" onclick="speakThemeOptions()">üó£Ô∏è Speak All</button>
                <button class="theme-close-btn" onclick="closeThemePicker()">‚úï</button>
            </div>
            <div class="theme-modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <p style="color: var(--text-muted); font-size: 16px;">Claude can describe each theme as you explore them!</p>
                </div>
                
                <!-- Enhanced Theme Grid with Voice -->
                <div class="theme-grid" id="theme-grid">
                    <div class="theme-option active" onclick="switchToThemeWithVoice('red')" data-theme="red">
                        <div class="theme-preview red">
                            <div class="theme-icon">üåÖ</div>
                        </div>
                        <div class="theme-name">Coral Sunset</div>
                        <div class="theme-description">Dark coral with white text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('red')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('orange')" data-theme="orange">
                        <div class="theme-preview orange">
                            <div class="theme-icon">üçë</div>
                        </div>
                        <div class="theme-name">Peach Glow</div>
                        <div class="theme-description">Dark peach with cream text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('orange')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('pink')" data-theme="pink">
                        <div class="theme-preview pink">
                            <div class="theme-icon">üå∏</div>
                        </div>
                        <div class="theme-name">Rose Blush</div>
                        <div class="theme-description">Dark rose with blush text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('pink')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('yellow')" data-theme="yellow">
                        <div class="theme-preview yellow">
                            <div class="theme-icon">üåª</div>
                        </div>
                        <div class="theme-name">Butter Cream</div>
                        <div class="theme-description">Dark gold with cream text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('yellow')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('bluegreen')" data-theme="bluegreen">
                        <div class="theme-preview bluegreen">
                            <div class="theme-icon">üåä</div>
                        </div>
                        <div class="theme-name">Mint Breeze</div>
                        <div class="theme-description">Dark teal with mint text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('bluegreen')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('purplegrey')" data-theme="purplegrey">
                        <div class="theme-preview purplegrey">
                            <div class="theme-icon">üíú</div>
                        </div>
                        <div class="theme-name">Lavender Mist</div>
                        <div class="theme-description">Dark purple with lavender text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('purplegrey')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('browngrey')" data-theme="browngrey">
                        <div class="theme-preview browngrey">
                            <div class="theme-icon">ü§é</div>
                        </div>
                        <div class="theme-name">Warm Taupe</div>
                        <div class="theme-description">Dark brown with warm text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('browngrey')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                    
                    <div class="theme-option" onclick="switchToThemeWithVoice('greenbrown')" data-theme="greenbrown">
                        <div class="theme-preview greenbrown">
                            <div class="theme-icon">üåø</div>
                        </div>
                        <div class="theme-name">Sage Olive</div>
                        <div class="theme-description">Dark sage with natural text</div>
                        <button class="theme-option-voice-btn" onclick="speakThemeDescription('greenbrown')" title="Speak Theme Description">üó£Ô∏è</button>
                    </div>
                </div>
                
                <!-- Mode Toggle Section with Voice -->
                <div class="mode-toggle-section">
                    <h4 style="margin-bottom: 12px; color: var(--text-primary);">üåô Theme Variants</h4>
                    <div class="mode-toggle">
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">Current Variant</div>
                            <div style="font-size: 12px; color: var(--text-muted);" id="current-mode-display">Standard Mode</div>
                        </div>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button class="btn-voice" onclick="speakModeInfo()" title="Speak Mode Info">üó£Ô∏è</button>
                            <button class="mode-toggle-btn" onclick="toggleModeWithVoice()" id="mode-toggle-modal">
                                <span id="mode-toggle-icon">üåë</span>
                                <span id="mode-toggle-text">Switch to Darker</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="closeThemePicker()">
                        Cancel
                    </button>
                    <button class="btn-voice" onclick="speakCurrentTheme()">
                        üó£Ô∏è Current
                    </button>
                    <button class="btn btn-primary" onclick="closeThemePickerWithVoice()">
                        Apply Theme
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message with Voice Enhancement -->
    <div id="success-message" class="success-message">
        üé® Theme applied successfully!
    </div>

    <script>
        // ========================================
        // REFIT ULTIMATE VOICE AI BUSINESS SYSTEM
        // Complete with Claude AI Speaking Everything!
        // ========================================
        
        // App State
        var currentTheme = 'red';
        var currentMode = 'light';
        var currentView = 'dashboard';
        
        // Advanced Voice AI State
        var voiceAssistantActive = true;
        var isListening = false;
        var isSpeaking = false;
        var isThinking = false;
        var speechRecognition = null;
        var speechSynthesis = window.speechSynthesis;
        var currentVoice = null;
        var voicePersonality = 'friendly';
        var voiceQueue = [];
        var isProcessingVoiceQueue = false;
        
        // Data Storage
        var userData = {
            firstName: 'John',
            lastName: 'Doe',
            title: 'Business Owner',
            email: 'john@example.com',
            phone: '+60 12-345 6789',
            address: '123 Business Street, City, State 12345'
        };
        
        var companyData = {
            name: 'Your Company Name',
            tagline: 'Professional Services',
            registration: '',
            taxId: '',
            email: '',
            phone: '',
            website: '',
            address: '',
            industry: '',
            size: '',
            description: '',
            logo: 'üåÖ'
        };
        
        var quotes = [];
        var customers = [];
        
        var themes = {
            red: {
                name: 'Coral Sunset',
                icon: 'üåÖ',
                description: 'A warm and inviting dark coral theme with crisp white text, perfect for creative businesses',
                primary: '#f87171',
                secondary: '#fca5a5'
            },
            orange: {
                name: 'Peach Glow',
                icon: 'üçë',
                description: 'A sophisticated dark peach theme with cream accents, ideal for luxury services',
                primary: '#fb923c',
                secondary: '#fdba74'
            },
            pink: {
                name: 'Rose Blush',
                icon: 'üå∏',
                description: 'An elegant dark rose theme with soft blush highlights, great for beauty and wellness businesses',
                primary: '#f472b6',
                secondary: '#f9a8d4'
            },
            yellow: {
                name: 'Butter Cream',
                icon: 'üåª',
                description: 'A cheerful dark gold theme with creamy textures, perfect for hospitality and food services',
                primary: '#fbbf24',
                secondary: '#fcd34d'
            },
            bluegreen: {
                name: 'Mint Breeze',
                icon: 'üåä',
                description: 'A refreshing dark teal theme with mint highlights, excellent for tech and healthcare',
                primary: '#2dd4bf',
                secondary: '#7dd3fc'
            },
            purplegrey: {
                name: 'Lavender Mist',
                icon: 'üíú',
                description: 'A premium dark purple theme with lavender accents, ideal for luxury and professional services',
                primary: '#a855f7',
                secondary: '#c4b5fd'
            },
            browngrey: {
                name: 'Warm Taupe',
                icon: 'ü§é',
                description: 'A sophisticated dark brown theme with warm earth tones, perfect for traditional businesses',
                primary: '#a3a3a3',
                secondary: '#d6d3d1'
            },
            greenbrown: {
                name: 'Sage Olive',
                icon: 'üåø',
                description: 'An organic dark sage theme with natural olive highlights, great for eco-friendly businesses',
                primary: '#84cc16',
                secondary: '#bef264'
            }
        };

        var voicePersonalities = {
            professional: {
                greeting: "Good day! I'm Claude, your professional business assistant.",
                style: "formal and business-focused",
                phrases: {
                    acknowledge: "Certainly,",
                    transition: "Moving on to",
                    complete: "Task completed successfully."
                }
            },
            friendly: {
                greeting: "Hi there! I'm Claude, your friendly AI assistant!",
                style: "warm and conversational",
                phrases: {
                    acknowledge: "Absolutely!",
                    transition: "Now let's check out",
                    complete: "All done! That was great!"
                }
            },
            enthusiastic: {
                greeting: "Hey! I'm Claude, and I'm super excited to help you!",
                style: "energetic and motivating",
                phrases: {
                    acknowledge: "That's fantastic!",
                    transition: "Now this is exciting -",
                    complete: "Amazing work! You're doing great!"
                }
            }
        };

        // ========================================
        // ADVANCED VOICE AI ASSISTANT FUNCTIONS
        // ========================================

        function initializeVoiceAssistant() {
            console.log('üé§ Initializing Advanced Voice AI System...');
            
            // Initialize Speech Recognition
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                speechRecognition = new SpeechRecognition();
                
                speechRecognition.continuous = false;
                speechRecognition.interimResults = false;
                speechRecognition.lang = 'en-US';
                
                speechRecognition.onstart = function() {
                    isListening = true;
                    updateVoiceUI();
                    showVoiceChatBubble("üé§ I'm listening... Speak naturally!");
                };
                
                speechRecognition.onresult = function(event) {
                    var command = event.results[0][0].transcript.toLowerCase();
                    console.log('üó£Ô∏è Voice command received:', command);
                    processAdvancedVoiceCommand(command);
                };
                
                speechRecognition.onerror = function(event) {
                    console.log('‚ùå Speech recognition error:', event.error);
                    speakWithPersonality("I didn't catch that clearly. Could you please try speaking again? I'm here to help!");
                    stopVoiceListening();
                };
                
                speechRecognition.onend = function() {
                    isListening = false;
                    updateVoiceUI();
                };
                
                console.log('‚úÖ Voice recognition initialized successfully');
            } else {
                console.log('‚ùå Speech recognition not supported');
                showVoiceChatBubble("Voice recognition isn't supported in your browser, but I can still speak everything to you! Just click around and I'll narrate the app!");
            }
            
            // Initialize Text-to-Speech
            if (speechSynthesis) {
                speechSynthesis.onvoiceschanged = function() {
                    var voices = speechSynthesis.getVoices();
                    // Prefer female voices or clear English voices
                    currentVoice = voices.find(voice => 
                        voice.name.includes('Female') || 
                        voice.name.includes('Google') ||
                        voice.name.includes('Samantha') ||
                        voice.name.includes('Karen') ||
                        voice.lang.startsWith('en')
                    ) || voices[0];
                    
                    console.log('üîä Voice selected:', currentVoice ? currentVoice.name : 'Default system voice');
                };
                
                // Trigger voice loading
                speechSynthesis.getVoices();
            }
            
            // Welcome message
            setTimeout(function() {
                speakWelcomeMessage();
            }, 2000);
            
            console.log('üé§‚ú® Advanced Voice AI System initialized successfully!');
        }

        function speakWelcomeMessage() {
            var personality = voicePersonalities[voicePersonality];
            var welcomeMessage = personality.greeting + " Welcome to REFIT Voice AI - the world's first completely voice-powered business system! I can speak every piece of information, explain every feature, and have natural conversations about your business. Try clicking on anything or just say 'help me' to get started!";
            
            speakWithPersonality(welcomeMessage);
            showVoiceChatBubble("üëã " + personality.greeting + " I can speak everything in this app! Try clicking around or asking me questions!");
        }

        function speakWithPersonality(text, callback, priority = false) {
            if (!speechSynthesis) {
                console.log('üîá Speech synthesis not available');
                showVoiceChatBubble(text);
                if (callback) callback();
                return;
            }
            
            // Add to queue or speak immediately if priority
            if (priority || !isSpeaking) {
                speakNow(text, callback);
            } else {
                voiceQueue.push({ text: text, callback: callback });
                processVoiceQueue();
            }
        }

        function speakNow(text, callback) {
            // Cancel any ongoing speech
            speechSynthesis.cancel();
            
            var utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = currentVoice;
            utterance.rate = 0.85;
            utterance.pitch = 1.0;
            utterance.volume = 0.9;
            
            utterance.onstart = function() {
                isSpeaking = true;
                updateVoiceUI();
                updateVoiceStatusBar('speaking', 'Claude Speaking');
                showVoiceChatBubble("üó£Ô∏è " + text);
            };
            
            utterance.onend = function() {
                isSpeaking = false;
                updateVoiceUI();
                updateVoiceStatusBar('ready', 'Claude Ready');
                if (callback) callback();
                processVoiceQueue();
            };
            
            utterance.onerror = function(event) {
                console.log('‚ùå Speech synthesis error:', event);
                isSpeaking = false;
                updateVoiceUI();
                if (callback) callback();
                processVoiceQueue();
            };
            
            speechSynthesis.speak(utterance);
        }

        function processVoiceQueue() {
            if (isProcessingVoiceQueue || isSpeaking || voiceQueue.length === 0) return;
            
            isProcessingVoiceQueue = true;
            setTimeout(function() {
                if (voiceQueue.length > 0 && !isSpeaking) {
                    var next = voiceQueue.shift();
                    speakNow(next.text, next.callback);
                }
                isProcessingVoiceQueue = false;
            }, 500);
        }

        function processAdvancedVoiceCommand(command) {
            console.log('üß† Processing advanced voice command:', command);
            
            // Stop listening while processing
            stopVoiceListening();
            
            // Show thinking state
            isThinking = true;
            updateVoiceUI();
            showVoiceChatBubble("ü§î Let me think about that...");
            
            setTimeout(function() {
                isThinking = false;
                updateVoiceUI();
                executeVoiceCommand(command);
            }, 800);
        }

        function executeVoiceCommand(command) {
            var personality = voicePersonalities[voicePersonality];
            
            // READING AND INFORMATION COMMANDS
            if (command.includes('read') || command.includes('tell me') || command.includes('what') || command.includes('show me')) {
                if (command.includes('stat') || command.includes('number') || command.includes('business') || command.includes('data')) {
                    speakBusinessStatistics();
                } else if (command.includes('profile') || command.includes('about me') || command.includes('my info')) {
                    speakProfileInformation();
                } else if (command.includes('company') || command.includes('business info')) {
                    speakCompanyInformation();
                } else if (command.includes('theme') || command.includes('color') || command.includes('appearance')) {
                    speakCurrentThemeInfo();
                } else if (command.includes('quote') || command.includes('quotation')) {
                    speakAboutQuotes();
                } else if (command.includes('customer') || command.includes('client')) {
                    speakAboutCustomers();
                } else if (command.includes('feature') || command.includes('capability') || command.includes('what can you do')) {
                    speakAboutAppFeatures();
                } else {
                    speakGeneralInformation();
                }
                return;
            }
            
            // THEME SWITCHING COMMANDS
            if (command.includes('switch') || command.includes('change') || command.includes('use')) {
                if (command.includes('coral') || command.includes('red') || command.includes('sunset')) {
                    switchToThemeWithVoice('red');
                } else if (command.includes('peach') || command.includes('orange') || command.includes('glow')) {
                    switchToThemeWithVoice('orange');
                } else if (command.includes('pink') || command.includes('rose') || command.includes('blush')) {
                    switchToThemeWithVoice('pink');
                } else if (command.includes('yellow') || command.includes('butter') || command.includes('cream')) {
                    switchToThemeWithVoice('yellow');
                } else if (command.includes('mint') || command.includes('teal') || command.includes('blue') || command.includes('breeze')) {
                    switchToThemeWithVoice('bluegreen');
                } else if (command.includes('purple') || command.includes('lavender') || command.includes('mist')) {
                    switchToThemeWithVoice('purplegrey');
                } else if (command.includes('brown') || command.includes('taupe') || command.includes('warm')) {
                    switchToThemeWithVoice('browngrey');
                } else if (command.includes('green') || command.includes('sage') || command.includes('olive')) {
                    switchToThemeWithVoice('greenbrown');
                } else if (command.includes('dark') || command.includes('darker')) {
                    toggleModeWithVoice();
                } else if (command.includes('theme')) {
                    openThemePickerWithVoice();
                }
                return;
            }
            
            // NAVIGATION COMMANDS
            if (command.includes('go to') || command.includes('open') || command.includes('show') || command.includes('navigate')) {
                if (command.includes('home') || command.includes('dashboard') || command.includes('main')) {
                    showViewWithVoice('dashboard');
                } else if (command.includes('quote') || command.includes('quotation')) {
                    showViewWithVoice('quotes');
                } else if (command.includes('customer') || command.includes('client')) {
                    showViewWithVoice('customers');
                } else if (command.includes('setting') || command.includes('preference') || command.includes('config')) {
                    showViewWithVoice('settings');
                } else if (command.includes('theme') || command.includes('color')) {
                    openThemePickerWithVoice();
                }
                return;
            }
            
            // CREATION COMMANDS
            if (command.includes('create') || command.includes('new') || command.includes('add') || command.includes('make')) {
                if (command.includes('quote') || command.includes('quotation')) {
                    createQuoteWithVoice();
                } else if (command.includes('customer') || command.includes('client')) {
                    addCustomerWithVoice();
                } else if (command.includes('backup')) {
                    createManualBackupWithVoice();
                }
                return;
            }
            
            // DATA MANAGEMENT COMMANDS
            if (command.includes('export') || command.includes('download') || command.includes('save')) {
                exportAllDataWithVoice();
                return;
            }
            
            if (command.includes('backup')) {
                createManualBackupWithVoice();
                return;
            }
            
            // HELP AND GUIDANCE COMMANDS
            if (command.includes('help') || command.includes('assistance') || command.includes('guide') || command.includes('tutorial')) {
                if (command.includes('quote')) {
                    speakQuoteHelp();
                } else if (command.includes('customer')) {
                    speakCustomerHelp();
                } else if (command.includes('theme')) {
                    speakThemeHelp();
                } else {
                    startVoiceGuidedTour();
                }
                return;
            }
            
            // EXPLANATION COMMANDS
            if (command.includes('explain') || command.includes('how') || command.includes('why')) {
                if (command.includes('quote') || command.includes('quotation')) {
                    speakQuoteExplanation();
                } else if (command.includes('theme')) {
                    speakThemeExplanation();
                } else if (command.includes('voice') || command.includes('ai')) {
                    speakVoiceAIExplanation();
                } else {
                    speakGeneralExplanation();
                }
                return;
            }
            
            // GREETING RESPONSES
            if (command.includes('hello') || command.includes('hi') || command.includes('hey')) {
                var greetings = [
                    personality.greeting + " How can I help you with your business today?",
                    "Hello! I'm excited to help you manage your business with voice commands!",
                    "Hi there! I can speak about anything in this app. What would you like to know?"
                ];
                speakWithPersonality(greetings[Math.floor(Math.random() * greetings.length)]);
                return;
            }
            
            // THANK YOU RESPONSES
            if (command.includes('thank you') || command.includes('thanks')) {
                var responses = [
                    "You're very welcome! I love helping you with your business.",
                    "My pleasure! I'm always here to speak and assist.",
                    "Happy to help! Your success is what I'm here for."
                ];
                speakWithPersonality(responses[Math.floor(Math.random() * responses.length)]);
                return;
            }
            
            // TOUR AND DEMO COMMANDS
            if (command.includes('tour') || command.includes('demo') || command.includes('walkthrough')) {
                startInteractiveVoiceTour();
                return;
            }
            
            // DEFAULT RESPONSE
            speakWithPersonality("I heard you say '" + command + "'. I can help you with many things! Try saying 'read my business stats', 'switch to peach theme', 'create a new quote', 'explain voice features', or 'start a tour'. What would you like to do?");
            
            showVoiceChatBubble("üí≠ I can help with:\n‚Ä¢ Reading data & stats\n‚Ä¢ Switching themes\n‚Ä¢ Creating quotes & customers\n‚Ä¢ Explaining features\n‚Ä¢ Guided tours\n‚Ä¢ And much more!");
        }

        // ========================================
        // VOICE INFORMATION SPEAKING FUNCTIONS
        // ========================================

        function speakBusinessStatistics() {
            var totalQuotes = quotes.length;
            var totalCustomers = customers.length;
            var totalRevenue = quotes.reduce(function(sum, quote) { return sum + (quote.total || 0); }, 0);
            var paidQuotes = quotes.filter(function(q) { return q.status === 'paid'; }).length;
            var successRate = totalQuotes > 0 ? Math.round((paidQuotes / totalQuotes) * 100) : 0;
            
            var statsMessage = "Here are your current business statistics: You have " + totalQuotes + " quotes in your system, " + totalCustomers + " customers in your database. Your total revenue is " + Math.round(totalRevenue) + " Malaysian Ringgit. ";
            
            if (successRate > 0) {
                statsMessage += "You have a " + successRate + "% success rate on paid quotes. ";
            }
            
            statsMessage += "Your business is looking strong! Would you like me to explain any of these numbers in more detail?";
            
            // Highlight stats cards while speaking
            highlightStatsCards();
            
            speakWithPersonality(statsMessage);
        }

        function speakProfileInformation() {
            var fullName = userData.firstName + ' ' + userData.lastName;
            var message = "Your profile shows you as " + fullName + ", working as a " + userData.title + ". ";
            
            if (userData.email) {
                message += "Your email is " + userData.email + ". ";
            }
            
            if (userData.phone) {
                message += "Your phone number is " + userData.phone + ". ";
            }
            
            if (userData.address) {
                message += "Your address is listed as " + userData.address + ". ";
            }
            
            message += "You can update any of this information by clicking the Edit Profile button.";
            
            speakWithPersonality(message);
        }

        function speakCompanyInformation() {
            var message = "Your company is called " + companyData.name + ", with the tagline '" + companyData.tagline + "'. ";
            
            if (companyData.industry) {
                message += "You're in the " + companyData.industry + " industry. ";
            }
            
            if (companyData.email) {
                message += "Your business email is " + companyData.email + ". ";
            }
            
            if (companyData.phone) {
                message += "Your business phone is " + companyData.phone + ". ";
            }
            
            message += "You can manage all your company details through the Company Hub.";
            
            speakWithPersonality(message);
        }

        function speakCurrentThemeInfo() {
            var theme = themes[currentTheme];
            var modeText = currentMode === 'light' ? 'standard' : 'darker';
            
            var message = "You're currently using the " + theme.name + " theme in " + modeText + " mode. " + theme.description + ". This theme uses " + theme.name.toLowerCase() + " colors to create a professional and visually appealing interface. Would you like me to describe other available themes?";
            
            speakWithPersonality(message);
        }

        function speakAboutQuotes() {
            var totalQuotes = quotes.length;
            var message = "Quotes are proposals you send to customers with pricing for your services or products. ";
            
            if (totalQuotes > 0) {
                message += "You currently have " + totalQuotes + " quotes in your system. ";
            } else {
                message += "You don't have any quotes yet. ";
            }
            
            message += "To create a new quote, you can say 'create a new quote' or click the New Quote button. You'll add customer information, itemize your services with descriptions and prices, and I'll calculate totals automatically.";
            
            speakWithPersonality(message);
        }

        function speakAboutCustomers() {
            var totalCustomers = customers.length;
            var message = "Customers are the people and businesses you work with. ";
            
            if (totalCustomers > 0) {
                message += "You have " + totalCustomers + " customers in your database. ";
            } else {
                message += "You haven't added any customers yet. ";
            }
            
            message += "Customer information includes company names, contact details, addresses, and notes. This makes it easy to create quotes and track your business relationships.";
            
            speakWithPersonality(message);
        }

        function speakAboutAppFeatures() {
            var message = "I'm Claude, your AI assistant, and I can speak about everything in this app! Here's what I can do: I can read all your business data out loud, explain how features work, guide you through creating quotes and adding customers, describe the beautiful themes, help you navigate the app by voice, and provide detailed explanations of any feature. I can even narrate your business statistics and help you understand your data better. Just ask me about anything you see or want to learn!";
            
            speakWithPersonality(message);
        }

        function speakGeneralInformation() {
            var message = "This is REFIT Voice AI, the world's first completely voice-powered business management system. I can speak about every piece of information, every feature, and every data point in the app. You can create quotes, manage customers, switch between beautiful themes, export data, and much more - all with voice commands or by having me narrate as you explore. What would you like me to explain or help you with?";
            
            speakWithPersonality(message);
        }

        // ========================================
        // VOICE-ENHANCED ACTION FUNCTIONS
        // ========================================

        function switchToThemeWithVoice(themeName) {
            if (!themes[themeName]) return;
            
            var theme = themes[themeName];
            switchToTheme(themeName);
            
            var message = "Perfect! I've switched you to the " + theme.name + " theme. " + theme.description + ". Notice how the colors throughout the interface have changed to this beautiful " + theme.name.toLowerCase() + " scheme. The " + theme.icon + " represents this theme's personality. How do you like the new look?";
            
            speakWithPersonality(message);
        }

        function toggleModeWithVoice() {
            var oldMode = currentMode;
            toggleMode();
            
            var newModeText = currentMode === 'light' ? 'standard' : 'darker';
            var oldModeText = oldMode === 'light' ? 'standard' : 'darker';
            
            var message = "I've switched you from " + oldModeText + " mode to " + newModeText + " mode! ";
            
            if (currentMode === 'dark') {
                message += "The darker variant provides deeper, more intense colors with a premium feel. Notice how the backgrounds are now richer and more dramatic.";
            } else {
                message += "The standard variant gives you the regular color intensity with a clean, professional appearance.";
            }
            
            speakWithPersonality(message);
        }

        function showViewWithVoice(viewName) {
            showView(viewName);
            
            var messages = {
                dashboard: "Welcome to your dashboard! This is your business command center where you can see your profile, company information, key statistics, and quick actions. Everything is designed for easy access to your most important business data.",
                quotes: "You're now in the quotes section! This is where you manage all your business proposals and pricing documents. You can create new quotes, view existing ones, and track their status from draft to paid.",
                customers: "You're now viewing your customers section! This is your relationship management center where you can add new customers, view their information, and manage your business contacts.",
                settings: "Welcome to settings! Here you can configure your voice AI preferences, manage data backups, customize themes, and control all aspects of your business system."
            };
            
            speakWithPersonality(messages[viewName] || "You've navigated to the " + viewName + " section.");
        }

        function createQuoteWithVoice() {
            speakWithPersonality("I'm opening the quote creation form for you! Here you can select a customer, add detailed line items with descriptions and prices, set tax rates, and specify validity dates. I'll calculate all the totals automatically as you add items. The system will generate a professional quote number for you too.");
            
            setTimeout(function() {
                showSuccessMessage('üìã Quote creator would open here with voice guidance!');
            }, 500);
        }

        function addCustomerWithVoice() {
            speakWithPersonality("Let me open the customer creation form! You'll be able to add the company name, contact person details, email, phone number, address, industry type, and any special notes. This information will be saved to make future quote creation much faster.");
            
            setTimeout(function() {
                showSuccessMessage('üë• Customer form would open here with voice assistance!');
            }, 500);
        }

        function openThemePickerWithVoice() {
            openThemePicker();
            speakWithPersonality("I've opened the theme selector for you! There are 8 beautiful themes to choose from, each with its own personality and color scheme. You can click on any theme to preview it, or ask me to describe each one. Each theme also has a standard and darker variant for different moods.");
        }

        function exportAllDataWithVoice() {
            exportAllData();
            speakWithPersonality("I'm exporting all your business data for you! This creates a complete backup file containing all your quotes, customers, company information, user profile, theme preferences, and settings. You can use this file to restore your data on another device or as a backup for safekeeping.");
        }

        function createManualBackupWithVoice() {
            createManualBackup();
            speakWithPersonality("I've created a backup of all your business data! This includes your quotes, customers, company information, and all settings. Your data is now safely stored and can be restored if needed. I recommend creating backups regularly to protect your important business information.");
        }

        // ========================================
        // VOICE EXPLANATION FUNCTIONS
        // ========================================

        function speakQuoteExplanation() {
            var message = "Quotes are formal proposals you send to potential customers outlining your services or products with pricing. Here's how the quote process works: First, you select or add a customer. Then you add line items - each with a description, quantity, and rate. I calculate subtotals automatically. You can add tax rates and set an expiration date. The system generates a professional quote number and calculates final totals. Once created, you can save it as a draft or send it directly to the customer.";
            
            speakWithPersonality(message);
        }

        function speakThemeExplanation() {
            var message = "Themes control the entire visual appearance of your business system. Each of the 8 themes has been carefully designed with specific color psychology in mind. For example, Coral Sunset conveys warmth and creativity, while Mint Breeze suggests freshness and reliability. Each theme has dark backgrounds with contrasting text for easy reading and a premium feel. You can also choose between standard and darker variants for different intensity levels.";
            
            speakWithPersonality(message);
        }

        function speakVoiceAIExplanation() {
            var message = "I'm Claude, an advanced AI assistant integrated throughout this entire business system. Unlike basic voice assistants, I can speak about every piece of data, explain every feature, and provide detailed narration of your business information. I understand natural conversation, remember context, and can guide you through complex tasks step by step. I can read your statistics, describe themes as you explore them, help with forms, and provide real-time assistance for any business task.";
            
            speakWithPersonality(message);
        }

        // ========================================
        // VOICE HELP FUNCTIONS
        // ========================================

        function speakQuoteHelp() {
            var message = "I'd be happy to help you with quotes! To create a quote, I'll guide you through each step: selecting a customer from your database or adding a new one, adding line items with clear descriptions and pricing, setting tax rates if applicable, and choosing an expiration date. The system automatically calculates subtotals, taxes, and final amounts. You can save quotes as drafts to finish later, or mark them as sent when you deliver them to customers.";
            
            speakWithPersonality(message);
        }

        function speakCustomerHelp() {
            var message = "Customer management is simple and powerful! When adding customers, include their company name, primary contact person, email and phone for communication, and full address for invoicing. You can also specify their industry and customer type for better organization. The notes field is perfect for remembering special requirements or preferences. Once customers are in your system, creating quotes for them becomes much faster.";
            
            speakWithPersonality(message);
        }

        function speakThemeHelp() {
            var message = "Choosing the right theme can enhance your business brand! Each theme has its own personality: Coral Sunset for creative businesses, Peach Glow for luxury services, Rose Blush for beauty and wellness, Butter Cream for hospitality, Mint Breeze for tech and healthcare, Lavender Mist for premium services, Warm Taupe for traditional businesses, and Sage Olive for eco-friendly companies. You can preview any theme and switch instantly.";
            
            speakWithPersonality(message);
        }

        // ========================================
        // VOICE TOUR AND DEMO FUNCTIONS
        // ========================================

        function startVoiceGuidedTour() {
            speakWithPersonality("Let me give you a complete tour of your voice-powered business system! I'll explain each section and show you how to use voice commands throughout the app. This will help you understand all the features and how to work efficiently with voice assistance.");
            
            setTimeout(function() {
                startVoiceTour();
            }, 1000);
        }

        function startInteractiveVoiceTour() {
            closeVoiceTutorial();
            speakWithPersonality("Welcome to the interactive voice tour! I'll guide you through each section of the app, explaining features and demonstrating voice capabilities. Let's start with your dashboard overview.");
            
            setTimeout(function() {
                highlightAndSpeakElement('.profile-section', "This is your user profile section. Here you can see your name, title, and manage your personal information. Notice how I can describe everything you see on screen.");
            }, 2000);
            
            setTimeout(function() {
                highlightAndSpeakElement('.company-logo', "This is your company logo and information area. You can customize your business details here. Try clicking on any element while I'm talking to see how voice integrates with interaction.");
            }, 6000);
            
            setTimeout(function() {
                highlightAndSpeakElement('.stats-grid', "These are your business statistics cards. I can read each number and explain what it means for your business. Click on any stat card to hear about that specific metric.");
            }, 10000);
        }

        function demoVoiceFeatures() {
            speakWithPersonality("Let me demonstrate the amazing voice features! I can speak about every element in the app. Watch as I highlight different sections and describe them.");
            
            var demoSequence = [
                { element: '.profile-section', text: "This is your profile area - I can read all your personal information." },
                { element: '.stats-grid', text: "These are your business statistics - I can narrate each number and its meaning." },
                { element: '.quick-actions', text: "These are quick action buttons - I can explain what each one does." },
                { element: '.voice-command-suggestions', text: "These are voice command examples - try any of these phrases!" },
                { element: '.bottom-nav', text: "This is your navigation bar - I can guide you to any section." }
            ];
            
            demoSequence.forEach(function(demo, index) {
                setTimeout(function() {
                    highlightAndSpeakElement(demo.element, demo.text);
                }, (index + 1) * 3000);
            });
        }

        // ========================================
        // VOICE PERSONALITY AND ONBOARDING
        // ========================================

        function startVoiceOnboarding() {
            showVoiceOnboarding();
            speakWithPersonality("Welcome to voice onboarding! Let's customize your AI assistant experience. I can adapt my personality to match your preferences - professional for business focus, friendly for warm conversation, or enthusiastic for energetic motivation. Which style appeals to you?");
        }

        function selectPersonality(personalityType) {
            voicePersonality = personalityType;
            
            // Update UI
            var options = document.querySelectorAll('.personality-option');
            options.forEach(function(option) {
                option.classList.remove('selected');
                if (option.getAttribute('data-personality') === personalityType) {
                    option.classList.add('selected');
                }
            });
            
            var personality = voicePersonalities[personalityType];
            speakWithPersonality("Great choice! I'll now use a " + personality.style + " approach. " + personality.greeting);
        }

        function completeVoiceOnboarding() {
            closeVoiceOnboarding();
            var personality = voicePersonalities[voicePersonality];
            speakWithPersonality(personality.phrases.complete + " Your voice assistant is now fully configured with a " + personality.style + " personality. I'm ready to help you manage your business with voice commands and detailed explanations. Try saying 'read my business stats' or 'start a tour' to begin!");
        }

        function skipVoiceOnboarding() {
            closeVoiceOnboarding();
            speakWithPersonality("No problem! I'll use my default friendly personality. You can always customize this later in settings. I'm ready to help you with your business management tasks!");
        }

        function customizeVoicePersonality() {
            startVoiceOnboarding();
        }

        // ========================================
        // VOICE UI MANAGEMENT FUNCTIONS
        // ========================================

        function updateVoiceUI() {
            var voiceBtn = document.getElementById('voice-assistant-btn');
            var voiceNavIcon = document.getElementById('voice-nav-icon');
            var voiceNavText = document.getElementById('voice-nav-text');
            var voiceStatusIndicator = document.getElementById('voice-status-indicator');
            var voiceHeaderBtn = document.getElementById('voice-header-btn');
            var appLogo = document.getElementById('app-logo');
            
            if (isThinking) {
                voiceBtn.classList.add('thinking');
                voiceBtn.textContent = 'ü§î';
                if (voiceStatusIndicator) voiceStatusIndicator.textContent = 'üí≠';
                if (appLogo) appLogo.classList.add('voice-active');
            } else if (isSpeaking) {
                voiceBtn.classList.remove('thinking', 'listening');
                voiceBtn.classList.add('speaking');
                voiceBtn.textContent = 'üó£Ô∏è';
                if (voiceStatusIndicator) voiceStatusIndicator.textContent = 'üîä';
                if (appLogo) appLogo.classList.add('voice-active');
                if (voiceHeaderBtn) voiceHeaderBtn.classList.add('voice-active');
            } else if (isListening) {
                voiceBtn.classList.remove('thinking', 'speaking');
                voiceBtn.classList.add('listening');
                voiceBtn.textContent = 'üé§';
                if (voiceStatusIndicator) voiceStatusIndicator.textContent = 'üéôÔ∏è';
                if (appLogo) appLogo.classList.add('voice-active');
            } else {
                voiceBtn.classList.remove('listening', 'speaking', 'thinking');
                voiceBtn.textContent = 'üé§';
                if (voiceStatusIndicator) voiceStatusIndicator.textContent = voiceAssistantActive ? 'üü¢' : '‚ö™';
                if (appLogo) appLogo.classList.remove('voice-active');
                if (voiceHeaderBtn) voiceHeaderBtn.classList.remove('voice-active');
            }
            
            if (voiceNavIcon) voiceNavIcon.textContent = voiceAssistantActive ? 'üé§' : 'üé§';
            if (voiceNavText) voiceNavText.textContent = voiceAssistantActive ? 'Claude' : 'Voice';
        }

        function updateVoiceStatusBar(status, text) {
            var indicator = document.getElementById('voice-status-indicator');
            var statusText = document.getElementById('voice-status-text');
            
            if (indicator) {
                indicator.className = 'voice-indicator';
                if (status === 'listening') {
                    indicator.classList.add('listening');
                } else if (status === 'speaking') {
                    indicator.classList.add('speaking');
                }
            }
            
            if (statusText) {
                statusText.textContent = text;
            }
        }

        function showVoiceChatBubble(message) {
            var bubble = document.getElementById('voice-chat-bubble');
            if (bubble) {
                bubble.textContent = message;
                bubble.classList.add('show');
                
                // Auto-hide certain messages
                if (!message.includes('üëã Hi!') && !message.includes('I can speak') && !message.includes('Click me')) {
                    setTimeout(function() {
                        if (!isSpeaking) {
                            bubble.classList.remove('show');
                        }
                    }, 8000);
                }
            }
        }

        function hideVoiceChatBubble() {
            var bubble = document.getElementById('voice-chat-bubble');
            if (bubble) {
                bubble.classList.remove('show');
            }
        }

        function highlightAndSpeak(element, text) {
            if (element) {
                element.classList.add('voice-highlighted');
                setTimeout(function() {
                    element.classList.remove('voice-highlighted');
                }, 3000);
            }
            speakWithPersonality(text);
        }

        function highlightAndSpeakElement(selector, text) {
            var element = document.querySelector(selector);
            highlightAndSpeak(element, text);
        }

        function highlightStatsCards() {
            var cards = document.querySelectorAll('.stat-card');
            cards.forEach(function(card, index) {
                setTimeout(function() {
                    card.classList.add('voice-reading');
                    setTimeout(function() {
                        card.classList.remove('voice-reading');
                    }, 1500);
                }, index * 500);
            });
        }

        // ========================================
        // SPECIFIC VOICE FUNCTIONS FOR UI ELEMENTS
        // ========================================

        function speakAppIntro() {
            speakWithPersonality("Welcome to REFIT Voice AI! This is the world's first completely voice-powered business management system. I'm Claude, your AI assistant, and I can speak about every feature, read all your data, and guide you through any task. The logo represents our current " + themes[currentTheme].name + " theme.");
        }

        function speakProfileInfo() {
            speakProfileInformation();
        }

        function speakCompanyInfo() {
            speakCompanyInformation();
        }

        function speakCompanyDetails() {
            var message = "Your company details include business name, tagline, contact information, and branding. You can customize everything through the company management section. This information appears on quotes and other business documents.";
            speakWithPersonality(message);
        }

        function speakStat(statType, elementId) {
            var element = document.getElementById(elementId);
            var value = element ? element.textContent : '0';
            
            var messages = {
                'quotes': "You currently have " + value + " quotes in your system. This includes all proposals you've created for customers, whether they're drafts, sent, or completed.",
                'customers': "Your customer database contains " + value + " entries. These are the businesses and individuals you work with or have contacted.",
                'monthly revenue': "Your revenue for this month is " + value + ". This represents income from completed and paid quotes in the current month.",
                'total revenue': "Your total revenue across all time is " + value + ". This is the sum of all completed business from your quotes."
            };
            
            highlightAndSpeak(element.closest('.stat-card'), messages[statType] || "This statistic shows " + value + ".");
        }

        function speakQuickActions() {
            speakWithPersonality("These are your quick action buttons for the most common business tasks. You can create new quotes to send to customers, add new customers to your database, or view detailed business reports. Each action has voice support for hands-free operation.");
        }

        function speakFeature(featureName) {
            var messages = {
                'quote creation': "Quote creation lets you build professional proposals with itemized pricing, customer information, tax calculations, and automatic totals. The system generates quote numbers and tracks status from draft to paid.",
                'customer management': "Customer management stores all your business contacts with company details, contact information, addresses, and notes. This makes quote creation faster and helps you maintain relationships.",
                'business reports': "Business reports provide insights into your performance with statistics, trends, and analytics. You can track quote success rates, revenue patterns, and customer activity."
            };
            
            speakWithPersonality(messages[featureName] || "This feature helps you manage your " + featureName + " efficiently.");
        }

        function speakAllVoiceCommands() {
            speakWithPersonality("Here are voice commands you can try: 'Read my business statistics' to hear your numbers, 'Create a new quote' to start a proposal, 'Switch to peach theme' to change colors, 'Tell me about customers' for customer info, 'Export my data' for backups, 'Help with quotes' for guidance, 'Start tour' for a walkthrough, and 'What can you do' to learn about my capabilities. I understand natural conversation, so speak normally!");
        }

        function speakRecentActivity() {
            speakWithPersonality("Your recent activity shows the latest actions in your business system. This includes newly created quotes, recently added customers, and other important business events. As you use the system more, this section will show your most recent work for quick access.");
        }

        function speakViewInfo(viewName) {
            var messages = {
                'quotes': "The quotes section is your proposal management center. Here you can create new quotes, view existing ones, track their status, and manage all your customer pricing documents. Each quote can be saved as a draft, marked as sent, or updated to paid status.",
                'customers': "The customers section is your relationship management hub. Store all your business contacts with detailed information including company names, contact persons, addresses, and special notes. Well-organized customer data makes quote creation much faster.",
                'settings': "The settings section controls your entire business system. Manage voice AI preferences, create data backups, customize themes, and configure all aspects of your business application. This is where you personalize your experience."
            };
            
            speakWithPersonality(messages[viewName] || "This section helps you manage " + viewName + " in your business.");
        }

        function speakVoiceSettings() {
            speakWithPersonality("Your voice AI settings control how I interact with you throughout the system. The voice assistant is currently active and ready to help. Voice recognition is learning your speech patterns for better accuracy. Speech synthesis uses natural-sounding voices for clear communication. You can customize my personality to match your business style - professional, friendly, or enthusiastic.");
        }

        function speakAboutVoiceFeature(featureName) {
            var messages = {
                'assistant': "The voice assistant - that's me, Claude! - is integrated throughout your entire business system. I can speak about every piece of data, explain features, guide you through tasks, and provide real-time help with natural conversation.",
                'recognition': "Voice recognition lets you speak commands naturally. I understand context and can process complex requests like 'create a quote for my biggest customer' or 'tell me about last month's revenue trends'.",
                'synthesis': "Speech synthesis is how I speak to you with natural-sounding voice. I can read your data, explain features, provide guidance, and have conversations about your business using advanced text-to-speech technology.",
                'personality': "AI personality lets you customize how I communicate. Choose professional for business-focused interactions, friendly for warm conversation, or enthusiastic for energetic motivation. I adapt my language and tone accordingly."
            };
            
            speakWithPersonality(messages[featureName] || "This voice feature enhances your " + featureName + " experience.");
        }

        function speakDataManagement() {
            speakWithPersonality("Data management keeps your business information safe and organized. You can create manual backups anytime, export all data for safekeeping or transfer, import data from other systems, and clear everything if needed. I recommend regular backups to protect your valuable business information including quotes, customers, and settings.");
        }

        function speakThemeInfo() {
            speakWithPersonality("Themes control your visual experience with 8 beautiful color schemes. Each theme has its own personality and industry focus. Coral Sunset for creativity, Peach Glow for luxury, Rose Blush for beauty, Butter Cream for hospitality, Mint Breeze for technology, Lavender Mist for premium services, Warm Taupe for traditional business, and Sage Olive for eco-friendly companies. Each has standard and darker variants.");
        }

        function speakThemeDescription(themeName) {
            var theme = themes[themeName];
            if (theme) {
                speakWithPersonality("The " + theme.name + " theme " + theme.icon + " features " + theme.description + ". This theme is perfect for businesses that want to convey " + theme.name.toLowerCase() + " qualities in their professional interface.");
            }
        }

        function speakThemeOptions() {
            speakWithPersonality("Let me describe all 8 available themes: Coral Sunset for warm creativity, Peach Glow for sophisticated luxury, Rose Blush for elegant beauty, Butter Cream for cheerful hospitality, Mint Breeze for fresh technology, Lavender Mist for premium professionalism, Warm Taupe for traditional business, and Sage Olive for natural eco-friendliness. Each theme has both standard and darker variants for different moods.");
        }

        function speakModeInfo() {
            var currentModeText = currentMode === 'light' ? 'standard' : 'darker';
            speakWithPersonality("You're currently using " + currentModeText + " mode. Standard mode provides regular color intensity with a clean professional look. Darker mode offers deeper, more intense colors for a premium dramatic feel. You can switch between these variants for any theme.");
        }

        function speakCurrentTheme() {
            var theme = themes[currentTheme];
            var modeText = currentMode === 'light' ? 'standard' : 'darker';
            speakWithPersonality("Your current theme is " + theme.name + " in " + modeText + " mode. " + theme.description + " This creates a " + (currentMode === 'dark' ? 'dramatic and premium' : 'clean and professional') + " appearance for your business interface.");
        }

        function speakAppSettings() {
            speakWithPersonality("Your app settings show Claude Voice AI is active and ready to help. Voice notifications are enabled so I can speak about important events. You're using the " + (currentMode === 'light' ? 'standard' : 'darker') + " theme variant. This is REFIT Voice AI version 3.0 - the world's first completely voice-powered business management system!");
        }

        function speakAboutSetting(settingName) {
            var messages = {
                'ai assistant': "Claude Voice AI is your intelligent business companion integrated throughout the entire system. I can speak about every feature, read all data, explain processes, and provide voice guidance for any task.",
                'voice notifications': "Voice notifications let me speak about important events like successful saves, theme changes, completed actions, and system updates. This keeps you informed without having to look at the screen.",
                'theme variant': "Theme variants give you two intensity levels for each color scheme. Standard mode provides regular colors for everyday use, while darker mode offers deeper, more dramatic colors for a premium feel.",
                'app version': "REFIT Voice AI version 3.0 represents the cutting edge of voice-powered business software. This version features complete voice integration, natural conversation, intelligent assistance, and comprehensive business management tools."
            };
            
            speakWithPersonality(messages[settingName] || "This setting controls your " + settingName + " preferences.");
        }

        // ========================================
        // VOICE CONTROL FUNCTIONS
        // ========================================

        function toggleVoiceAssistant() {
            voiceAssistantActive = !voiceAssistantActive;
            
            if (voiceAssistantActive) {
                showVoiceChatBubble("üëã Hi! I'm Claude, your AI assistant. I can speak everything in this app! Try clicking around or asking me questions!");
                speakWithPersonality("Hello! I'm Claude, your voice AI assistant. I'm ready to help you with your business. I can speak about every feature, read all your data, and guide you through any task. Try saying 'help me' or click on anything to hear me describe it!");
            } else {
                hideVoiceChatBubble();
                if (isListening) {
                    stopVoiceListening();
                }
                speechSynthesis.cancel();
            }
            
            updateVoiceUI();
        }

        function toggleVoiceListening() {
            if (!speechRecognition) {
                speakWithPersonality("Voice recognition isn't available in your browser, but I can still speak everything to you! Try clicking on different elements and I'll describe them.");
                showVoiceChatBubble("Voice recognition unavailable, but I can still speak everything! üó£Ô∏è");
                return;
            }
            
            if (isListening) {
                stopVoiceListening();
            } else {
                startVoiceListening();
            }
        }

        function startVoiceListening() {
            if (!speechRecognition) return;
            
            try {
                speechRecognition.start();
                showVoiceControls();
                animateVoiceWaveform();
                updateVoiceStatusBar('listening', 'Claude Listening');
            } catch (error) {
                console.log('‚ùå Error starting speech recognition:', error);
                speakWithPersonality("I'm having trouble with voice recognition. Please try again, or just click around and I'll speak about what you see!");
            }
        }

        function stopVoiceListening() {
            if (speechRecognition && isListening) {
                speechRecognition.stop();
            }
            isListening = false;
            closeVoiceControls();
            updateVoiceUI();
            updateVoiceStatusBar('ready', 'Claude Ready');
        }

        function showVoiceControls() {
            var controls = document.getElementById('voice-controls');
            if (controls) {
                controls.classList.add('show');
            }
        }

        function closeVoiceControls() {
            var controls = document.getElementById('voice-controls');
            if (controls) {
                controls.classList.remove('show');
            }
            stopVoiceWaveform();
        }

        function showVoiceOnboarding() {
            var onboarding = document.getElementById('voice-onboarding');
            if (onboarding) {
                onboarding.classList.add('show');
            }
        }

        function closeVoiceOnboarding() {
            var onboarding = document.getElementById('voice-onboarding');
            if (onboarding) {
                onboarding.classList.remove('show');
            }
        }

        function startVoiceTour() {
            var tutorial = document.getElementById('voice-tutorial');
            if (tutorial) {
                tutorial.classList.add('show');
            }
        }

        function closeVoiceTutorial() {
            var tutorial = document.getElementById('voice-tutorial');
            if (tutorial) {
                tutorial.classList.remove('show');
            }
        }

        function showMobileVoiceOverlay() {
            var overlay = document.getElementById('mobile-voice-overlay');
            if (overlay) {
                overlay.classList.add('show');
            }
        }

        function closeMobileVoiceOverlay() {
            var overlay = document.getElementById('mobile-voice-overlay');
            if (overlay) {
                overlay.classList.remove('show');
            }
        }

        function animateVoiceWaveform() {
            var waveBars = document.querySelectorAll('.voice-wave-bar');
            waveBars.forEach(function(bar) {
                bar.classList.add('active');
            });
        }

        function stopVoiceWaveform() {
            var waveBars = document.querySelectorAll('.voice-wave-bar');
            waveBars.forEach(function(bar) {
                bar.classList.remove('active');
            });
        }

        function testVoiceAssistant() {
            speakWithPersonality("Voice test successful! I can speak clearly and I'm ready to help you manage your business. My voice synthesis is working perfectly, and I can understand your speech recognition. Try asking me about anything in the app!");
            showVoiceChatBubble("üß™ Voice test passed! All systems working perfectly! ‚úÖ");
        }

        function simulateVoiceCommand(command) {
            showVoiceChatBubble("üé§ Simulating: '" + command + "'");
            setTimeout(function() {
                executeVoiceCommand(command);
            }, 500);
        }

        // ========================================
        // ENHANCED VOICE WRAPPERS FOR EXISTING FUNCTIONS
        // ========================================

        function editProfileWithVoice() {
            speakWithPersonality("I would open your profile editor here! You could update your name, title, contact information, and address. The voice assistant can help you fill out forms by speaking your information and I'll repeat it back for confirmation.");
            showSuccessMessage('üë§ Profile editor would open with voice guidance!');
        }

        function showProfileWithVoice() {
            editProfileWithVoice();
        }

        function editCompanyWithVoice() {
            speakWithPersonality("I would open your company details editor! You could update your business name, tagline, registration numbers, contact information, website, and description. I can help you fill out each field with voice dictation.");
            showSuccessMessage('üè¢ Company editor would open with voice assistance!');
        }

        function openCompanyManagerWithVoice() {
            speakWithPersonality("I would open your complete company management hub! This includes logo management, business card generation, company statistics, and all your business settings. Every feature has full voice integration for hands-free management.");
            showSuccessMessage('üè¢ Company Management Hub would open with voice guidance!');
        }

        function viewReportsWithVoice() {
            speakWithPersonality("I would show you detailed business reports with voice narration! You could hear about quote success rates, revenue trends, customer activity, and performance analytics. I can read all the charts and data out loud.");
            showSuccessMessage('üìä Reports would open with voice narration!');
        }

        function importDataFileWithVoice() {
            speakWithPersonality("I would help you import business data from a backup file! I can guide you through the file selection process and confirm what data is being imported. Voice assistance makes data management much easier.");
            showSuccessMessage('üì• Data import would start with voice guidance!');
        }

        function clearAllDataWithVoice() {
            speakWithPersonality("This would clear all your business data after voice confirmation! I would ask you to confirm by speaking 'yes, clear all data' to ensure this important action is intentional. Voice confirmation prevents accidental data loss.");
            showSuccessMessage('üóëÔ∏è Data clearing would require voice confirmation!');
        }

        function closeThemePickerWithVoice() {
            closeThemePicker();
            speakWithPersonality("Perfect! I've applied your theme selection. The " + themes[currentTheme].name + " theme is now active throughout your business system. Notice how all the colors have updated to match your choice!");
        }

        function toggleModeWithVoice() {
            var oldMode = currentMode;
            toggleMode();
            
            var newModeText = currentMode === 'light' ? 'standard' : 'darker';
            var oldModeText = oldMode === 'light' ? 'standard' : 'darker';
            
            speakWithPersonality("Excellent! I've switched you from " + oldModeText + " mode to " + newModeText + " mode. " + (currentMode === 'dark' ? 'Notice the deeper, more dramatic colors that create a premium feel.' : 'See how the colors are now lighter and more traditional for a clean professional look.'));
        }

        // ========================================
        // THEME MANAGEMENT FUNCTIONS
        // ========================================
        
        function switchToTheme(themeName) {
            if (!themes[themeName]) return;
            
            currentTheme = themeName;
            updateThemeDisplay();
            saveData();
            
            document.body.style.transition = 'all 0.5s ease';
            showSuccessMessage('üé® Switched to ' + themes[themeName].name + ' theme!');
            updateActiveThemeOption();
            
            console.log('üé® Theme switched to:', themes[themeName].name);
        }
        
        function toggleMode() {
            currentMode = currentMode === 'light' ? 'dark' : 'light';
            updateThemeDisplay();
            saveData();
            
            var modeText = currentMode === 'light' ? 'Standard' : 'Darker';
            showSuccessMessage((currentMode === 'light' ? 'üåï' : 'üåë') + ' Switched to ' + modeText + ' variant!');
            updateModeDisplay();
            
            console.log('üåô Mode switched to:', currentMode);
        }
        
        function updateThemeDisplay() {
            document.body.setAttribute('data-theme', currentTheme);
            document.body.setAttribute('data-mode', currentMode);
            
            var theme = themes[currentTheme];
            
            document.getElementById('current-theme-icon').textContent = theme.icon;
            document.getElementById('app-logo').textContent = theme.icon;
            document.getElementById('theme-picker-btn').innerHTML = 
                '<span>' + theme.icon + '</span> Themes';
            
            var metaTheme = document.querySelector('meta[name="theme-color"]');
            if (metaTheme) {
                metaTheme.content = theme.primary;
            }
        }
        
        function updateModeDisplay() {
            var modeToggle = document.getElementById('mode-toggle');
            var currentModeDisplay = document.getElementById('current-mode-display');
            var currentModeSetting = document.getElementById('current-mode-setting');
            
            if (currentMode === 'light') {
                if (modeToggle) modeToggle.textContent = 'üåë Darker';
                if (currentModeDisplay) currentModeDisplay.textContent = 'Standard Mode';
                if (currentModeSetting) currentModeSetting.textContent = 'Standard Dark Theme Active';
            } else {
                if (modeToggle) modeToggle.textContent = 'üåï Standard';
                if (currentModeDisplay) currentModeDisplay.textContent = 'Darker Mode';
                if (currentModeSetting) currentModeSetting.textContent = 'Darker Variant Active';
            }
        }
        
        function updateActiveThemeOption() {
            var themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(function(option) {
                option.classList.remove('active');
                if (option.getAttribute('data-theme') === currentTheme) {
                    option.classList.add('active');
                }
            });
        }

        // ========================================
        // VIEW MANAGEMENT
        // ========================================
        
        function showView(viewName) {
            var views = document.querySelectorAll('.view');
            views.forEach(function(view) {
                view.classList.add('hidden');
            });
            
            var targetView = document.getElementById(viewName + '-view');
            if (targetView) {
                targetView.classList.remove('hidden');
                currentView = viewName;
                
                // Update navigation
                var navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(function(item) {
                    item.classList.remove('active', 'voice-active');
                });
                
                // Find and activate the correct nav item
                var targetNavItem = Array.from(navItems).find(function(item) {
                    return item.textContent.toLowerCase().includes(viewName === 'dashboard' ? 'home' : viewName);
                });
                if (targetNavItem) {
                    targetNavItem.classList.add('active', 'voice-active');
                }
                
                // Load data for specific views
                if (viewName === 'quotes') {
                    loadQuotesView();
                } else if (viewName === 'customers') {
                    loadCustomersView();
                }
                
                showSuccessMessage('üì± Switched to ' + viewName + ' view');
            }
        }

        // ========================================
        // MODAL MANAGEMENT
        // ========================================
        
        function openThemePicker() {
            var modal = document.getElementById('theme-modal');
            if (modal) {
                modal.classList.add('show');
                updateActiveThemeOption();
                updateModeDisplay();
            }
        }
        
        function closeThemePicker() {
            var modal = document.getElementById('theme-modal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // ========================================
        // BUSINESS DATA FUNCTIONS
        // ========================================
        
        function updateUserDisplay() {
            var fullName = userData.firstName + ' ' + userData.lastName;
            var initials = userData.firstName.charAt(0) + userData.lastName.charAt(0);
            
            document.getElementById('user-display-name').textContent = fullName;
            document.getElementById('user-display-title').textContent = userData.title;
            document.getElementById('user-avatar').textContent = initials.toUpperCase();
        }
        
        function updateCompanyDisplay() {
            document.getElementById('company-display-name').textContent = companyData.name;
            document.getElementById('company-display-tagline').textContent = companyData.tagline;
            document.getElementById('company-name').textContent = companyData.name.toUpperCase();
            document.getElementById('company-subtitle').textContent = companyData.tagline;
            document.getElementById('company-logo').textContent = companyData.logo;
        }
        
        function loadQuotesView() {
            var container = document.getElementById('quotes-list');
            if (!container) return;
            
            if (quotes.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-muted);">üé§ No quotes yet. Say "create a new quote" or click the button above!</div>';
                return;
            }
            
            // Would populate with actual quote data
        }
        
        function loadCustomersView() {
            var container = document.getElementById('customers-list');
            if (!container) return;
            
            if (customers.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-muted);">üé§ No customers yet. Say "add a customer" or click the button above!</div>';
                return;
            }
            
            // Would populate with actual customer data
        }

        // ========================================
        // DATA PERSISTENCE
        // ========================================
        
        function saveData() {
            try {
                localStorage.setItem('refit_voice_theme', currentTheme);
                localStorage.setItem('refit_voice_mode', currentMode);
                localStorage.setItem('refit_voice_user_data', JSON.stringify(userData));
                localStorage.setItem('refit_voice_company_data', JSON.stringify(companyData));
                localStorage.setItem('refit_voice_quotes', JSON.stringify(quotes));
                localStorage.setItem('refit_voice_customers', JSON.stringify(customers));
                localStorage.setItem('refit_voice_assistant_active', voiceAssistantActive);
                localStorage.setItem('refit_voice_personality', voicePersonality);
            } catch (e) {
                console.warn('Could not save data:', e);
            }
        }
        
        function loadData() {
            try {
                var savedTheme = localStorage.getItem('refit_voice_theme');
                var savedMode = localStorage.getItem('refit_voice_mode');
                var savedUserData = localStorage.getItem('refit_voice_user_data');
                var savedCompanyData = localStorage.getItem('refit_voice_company_data');
                var savedQuotes = localStorage.getItem('refit_voice_quotes');
                var savedCustomers = localStorage.getItem('refit_voice_customers');
                var savedVoiceActive = localStorage.getItem('refit_voice_assistant_active');
                var savedPersonality = localStorage.getItem('refit_voice_personality');
                
                if (savedTheme && themes[savedTheme]) {
                    currentTheme = savedTheme;
                }
                
                if (savedMode && (savedMode === 'light' || savedMode === 'dark')) {
                    currentMode = savedMode;
                }
                
                if (savedUserData) {
                    userData = Object.assign(userData, JSON.parse(savedUserData));
                }
                
                if (savedCompanyData) {
                    companyData = Object.assign(companyData, JSON.parse(savedCompanyData));
                }
                
                if (savedQuotes) {
                    quotes = JSON.parse(savedQuotes);
                }
                
                if (savedCustomers) {
                    customers = JSON.parse(savedCustomers);
                }
                
                if (savedVoiceActive === 'true') {
                    voiceAssistantActive = true;
                }
                
                if (savedPersonality && voicePersonalities[savedPersonality]) {
                    voicePersonality = savedPersonality;
                }
                
                updateThemeDisplay();
                updateModeDisplay();
                updateUserDisplay();
                updateCompanyDisplay();
                updateStats();
            } catch (e) {
                console.warn('Could not load data:', e);
            }
        }

        // ========================================
        // DATA MANAGEMENT FUNCTIONS
        // ========================================
        
        function createManualBackup() {
            showSuccessMessage('üíæ Backup created successfully with voice confirmation!');
        }
        
        function exportAllData() {
            var exportData = {
                userData: userData,
                companyData: companyData,
                quotes: quotes,
                customers: customers,
                currentTheme: currentTheme,
                currentMode: currentMode,
                voiceAssistantActive: voiceAssistantActive,
                voicePersonality: voicePersonality,
                exportDate: new Date().toISOString(),
                version: 'REFIT Voice AI System v3.0 - Claude Everywhere!'
            };
            
            var dataStr = JSON.stringify(exportData, null, 2);
            var dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            var link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = 'REFIT_Voice_AI_Export_' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            
            showSuccessMessage('üì§ Business data exported with voice integration settings!');
        }

        // ========================================
        // UTILITY FUNCTIONS
        // ========================================
        
        function showSuccessMessage(message) {
            var messageElement = document.getElementById('success-message');
            if (!messageElement) return;
            
            messageElement.textContent = message;
            messageElement.classList.add('show', 'voice-active');
            
            setTimeout(function() {
                messageElement.classList.remove('show', 'voice-active');
            }, 4000);
        }
        
        function updateStats() {
            var totalQuotes = quotes.length;
            var totalCustomers = customers.length;
            var totalRevenue = quotes.reduce(function(sum, quote) { return sum + (quote.total || 0); }, 0);
            
            // Calculate monthly revenue (current month)
            var currentMonth = new Date().getMonth();
            var currentYear = new Date().getFullYear();
            var monthlyRevenue = quotes.filter(function(quote) {
                var quoteDate = new Date(quote.date);
                return quoteDate.getMonth() === currentMonth && quoteDate.getFullYear() === currentYear;
            }).reduce(function(sum, quote) { return sum + (quote.total || 0); }, 0);
            
            document.getElementById('total-quotes-count').textContent = totalQuotes;
            document.getElementById('total-customers-count').textContent = totalCustomers;
            document.getElementById('monthly-revenue').textContent = 'RM ' + Math.round(monthlyRevenue);
            document.getElementById('total-revenue').textContent = 'RM ' + Math.round(totalRevenue);
            
            updateRecentActivity();
        }
        
        function updateRecentActivity() {
            var container = document.getElementById('recent-activity');
            if (!container) return;
            
            // Show demo activity with voice integration
            container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-muted);">' +
                '<div style="font-size: 48px; margin-bottom: 16px;">üé§‚ú®</div>' +
                '<strong>Welcome to REFIT Voice AI!</strong><br><br>' +
                'Your recent activity will appear here.<br><br>' +
                'Try saying:<br>' +
                'üó£Ô∏è "Read my business statistics"<br>' +
                'üó£Ô∏è "Create a new quote"<br>' +
                'üó£Ô∏è "Switch to peach theme"<br>' +
                'üó£Ô∏è "Tell me about customers"<br><br>' +
                '<button class="btn btn-primary" onclick="demoVoiceFeatures()" style="margin-top: 12px;">üé§ Voice Demo</button>' +
            '</div>';
        }
        
        function updateStatusBar() {
            var now = new Date();
            var timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit', 
                hour12: false 
            });
            var timeElement = document.getElementById('status-time');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // ========================================
        // INITIALIZATION
        // ========================================
        
        function initializeApp() {
            console.log('üé§‚ú® Initializing REFIT Voice AI System...');
            
            loadData();
            updateStatusBar();
            initializeVoiceAssistant();
            
            // Set up status bar timer
            setInterval(updateStatusBar, 60000);
            
            // Add smooth transitions after load
            setTimeout(function() {
                document.body.style.transition = 'all 0.5s ease';
            }, 100);
            
            // Auto-save data periodically
            setInterval(function() {
                saveData();
            }, 30000);
            
            showSuccessMessage('üé§‚ú® REFIT Voice AI System Ready - Claude Speaks Everything!');
            
            console.log('üé§‚ú® REFIT VOICE AI SYSTEM - CLAUDE SPEAKS EVERYTHING!');
            console.log('üó£Ô∏è COMPLETE VOICE INTEGRATION:');
            console.log('   ‚Ä¢ Claude speaks every piece of data');
            console.log('   ‚Ä¢ Full conversation about business features');
            console.log('   ‚Ä¢ Voice narration of statistics and information');
            console.log('   ‚Ä¢ Natural language command processing');
            console.log('   ‚Ä¢ Real-time voice feedback and guidance');
            console.log('   ‚Ä¢ Interactive voice tours and tutorials');
            console.log('   ‚Ä¢ Customizable AI personality (Professional/Friendly/Enthusiastic)');
            console.log('   ‚Ä¢ Voice-enhanced forms and data entry');
            console.log('   ‚Ä¢ Smart voice recognition and responses');
            console.log('   ‚Ä¢ Mobile-optimized voice interface');
            console.log('üë§ Complete User Profile Management with Voice');
            console.log('üè¢ Advanced Company Management with Voice Descriptions');
            console.log('üìã Quote Creation & Management with Voice Guidance');
            console.log('üë• Customer Relationship Management with Voice Help');
            console.log('üåÖ 8 Beautiful Themes with Voice Descriptions');
            console.log('üíæ Complete Data Persistence with Voice Confirmation');
            console.log('üì± Mobile-First Voice-Powered Interface');
            console.log('‚ú® The Ultimate Voice Business Management Experience!');
        }
        
        // Start the app when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeApp, 100);
        });
        
        // Enhanced keyboard shortcuts with voice
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 't') {
                e.preventDefault();
                openThemePickerWithVoice();
            }
            
            if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                e.preventDefault();
                toggleModeWithVoice();
            }
            
            if ((e.ctrlKey || e.metaKey) && e.key === 'v') {
                e.preventDefault();
                toggleVoiceAssistant();
            }
            
            if (e.key === ' ' && e.ctrlKey) {
                e.preventDefault();
                toggleVoiceListening();
            }
            
            // Number keys 1-8 = Switch themes with voice
            if (e.key >= '1' && e.key <= '8') {
                var themeKeys = Object.keys(themes);
                var themeIndex = parseInt(e.key) - 1;
                if (themeKeys[themeIndex]) {
                    switchToThemeWithVoice(themeKeys[themeIndex]);
                }
            }
        });
        
        // Wake lock for voice interaction
        if ('wakeLock' in navigator) {
            var wakeLock = null;
            
            function requestWakeLock() {
                if (isListening || isSpeaking) {
                    navigator.wakeLock.request('screen').then(function(wl) {
                        wakeLock = wl;
                    }).catch(function(err) {
                        console.log('Wake lock failed:', err);
                    });
                } else if (wakeLock) {
                    wakeLock.release();
                    wakeLock = null;
                }
            }
            
            setInterval(requestWakeLock, 1000);
        }
        
        console.log('üéâ‚ú® REFIT VOICE AI SYSTEM - CLAUDE SPEAKS EVERYTHING!');
        console.log('üé§ REVOLUTIONARY VOICE FEATURES:');
        console.log('   üó£Ô∏è Claude narrates ALL business data');
        console.log('   üí¨ Full conversation about every feature');
        console.log('   üìä Voice statistics reading');
        console.log('   üéØ Smart command understanding');
        console.log('   üì¢ Voice-guided tutorials');
        console.log('   üîä Real-time voice feedback');
        console.log('   üé≠ Customizable AI personality');
        console.log('   üì± Mobile voice interface');
        console.log('   üß† Intelligent conversation');
        console.log('   ‚ú® Natural language processing');
        console.log('üåÖ 8 Beautiful Themes with Voice Descriptions');
        console.log('üè¢ Complete Business Management with Voice');
        console.log('üì± Mobile-First Voice-Powered Design');
        console.log('');
        console.log('üéØ VOICE COMMANDS TO TRY:');
        console.log('‚Ä¢ "Read my business statistics"');
        console.log('‚Ä¢ "Tell me about my customers"');
        console.log('‚Ä¢ "Switch to peach glow theme"');
        console.log('‚Ä¢ "Create a new quote"');
        console.log('‚Ä¢ "Explain voice features"');
        console.log('‚Ä¢ "Start interactive tour"');
        console.log('‚Ä¢ "What can you do for me?"');
        console.log('‚Ä¢ "Help me understand quotes"');
        console.log('');
        console.log('üöÄ THE FUTURE OF VOICE BUSINESS MANAGEMENT IS HERE!');
        console.log('üé§ Just click anywhere and Claude will speak about it!');
    </script>
</body>
</html>
